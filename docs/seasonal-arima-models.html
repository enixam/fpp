<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10.6 Seasonal ARIMA models | Notes for “Forecasting: Principles and Practice, 3rd edition”</title>
  <meta name="description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="10.6 Seasonal ARIMA models | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="github-repo" content="enixam/fpp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10.6 Seasonal ARIMA models | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  
  <meta name="twitter:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="forecasting-with-arima-models.html"/>
<link rel="next" href="ets-and-arima.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for fpp3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a><ul>
<li class="chapter" data-level="2.1" data-path="tsibble-objects.html"><a href="tsibble-objects.html"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a><ul>
<li class="chapter" data-level="2.1.1" data-path="tsibble-objects.html"><a href="tsibble-objects.html#manipulation"><i class="fa fa-check"></i><b>2.1.1</b> manipulation</a></li>
<li class="chapter" data-level="2.1.2" data-path="tsibble-objects.html"><a href="tsibble-objects.html#importing"><i class="fa fa-check"></i><b>2.1.2</b> importing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-plots.html"><a href="time-plots.html"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="patterns-of-time-series-trend-seasonal-and-cyclic.html"><a href="patterns-of-time-series-trend-seasonal-and-cyclic.html"><i class="fa fa-check"></i><b>2.3</b> Patterns of time series: trend, seasonal and cyclic</a></li>
<li class="chapter" data-level="2.4" data-path="seasonal-plots.html"><a href="seasonal-plots.html"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a><ul>
<li class="chapter" data-level="2.4.1" data-path="seasonal-plots.html"><a href="seasonal-plots.html#multiple-seasonal-periods-period-in-gg_season"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods: <code>period</code> in <code>gg_season()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="seasonal-subseries-plots.html"><a href="seasonal-subseries-plots.html"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a><ul>
<li class="chapter" data-level="2.5.1" data-path="seasonal-subseries-plots.html"><a href="seasonal-subseries-plots.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-between-time-series.html"><a href="visualization-between-time-series.html"><i class="fa fa-check"></i><b>2.6</b> Visualization between time series</a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-between-time-series.html"><a href="visualization-between-time-series.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.1</b> scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="lag-plots.html"><a href="lag-plots.html"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a><ul>
<li class="chapter" data-level="2.7.1" data-path="lag-plots.html"><a href="lag-plots.html#autocorrelation"><i class="fa fa-check"></i><b>2.7.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.7.2" data-path="lag-plots.html"><a href="lag-plots.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.7.2</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="calendar-plots.html"><a href="calendar-plots.html"><i class="fa fa-check"></i><b>2.8</b> Calendar plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a><ul>
<li class="chapter" data-level="3.1" data-path="transformation-and-adjustments.html"><a href="transformation-and-adjustments.html"><i class="fa fa-check"></i><b>3.1</b> Transformation and adjustments</a><ul>
<li class="chapter" data-level="3.1.1" data-path="transformation-and-adjustments.html"><a href="transformation-and-adjustments.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="transformation-and-adjustments.html"><a href="transformation-and-adjustments.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="transformation-and-adjustments.html"><a href="transformation-and-adjustments.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="transformation-and-adjustments.html"><a href="transformation-and-adjustments.html#box-cox"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformation (Box-Cox)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="moving-averages.html"><a href="moving-averages.html"><i class="fa fa-check"></i><b>3.2</b> Moving averages</a><ul>
<li class="chapter" data-level="3.2.1" data-path="moving-averages.html"><a href="moving-averages.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.2.1</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.2.2" data-path="moving-averages.html"><a href="moving-averages.html#estimating-the-trend-cycle-component-with-seasonal-data"><i class="fa fa-check"></i><b>3.2.2</b> Estimating the trend-cycle component with seasonal data</a></li>
<li class="chapter" data-level="3.2.3" data-path="moving-averages.html"><a href="moving-averages.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.2.3</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="classical-decomposition.html"><a href="classical-decomposition.html"><i class="fa fa-check"></i><b>3.3</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.4" data-path="x11-decomposition.html"><a href="x11-decomposition.html"><i class="fa fa-check"></i><b>3.4</b> X11 decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="seats-decomposition.html"><a href="seats-decomposition.html"><i class="fa fa-check"></i><b>3.5</b> SEATS decomposition</a></li>
<li class="chapter" data-level="3.6" data-path="stl-decomposition.html"><a href="stl-decomposition.html"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a><ul>
<li class="chapter" data-level="4.1" data-path="simple-statistics.html"><a href="simple-statistics.html"><i class="fa fa-check"></i><b>4.1</b> Simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="acf-features.html"><a href="acf-features.html"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="stl-features.html"><a href="stl-features.html"><i class="fa fa-check"></i><b>4.3</b> STL features</a></li>
<li class="chapter" data-level="4.4" data-path="other-features.html"><a href="other-features.html"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="exporing-australian-tourism-data.html"><a href="exporing-australian-tourism-data.html"><i class="fa fa-check"></i><b>4.5</b> Exporing Australian tourism data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a><ul>
<li class="chapter" data-level="5.1" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a><ul>
<li class="chapter" data-level="5.1.1" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html#visualize"><i class="fa fa-check"></i><b>5.1.2</b> Visualize</a></li>
<li class="chapter" data-level="5.1.3" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="a-tidy-forecasting-workflow.html"><a href="a-tidy-forecasting-workflow.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a><ul>
<li class="chapter" data-level="5.2.1" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html#naive-method"><i class="fa fa-check"></i><b>5.2.2</b> Naive method</a></li>
<li class="chapter" data-level="5.2.3" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html#seasonal-naive-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naive method</a></li>
<li class="chapter" data-level="5.2.4" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html#australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.5</b> Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.6" data-path="some-simple-forecasting-methods.html"><a href="some-simple-forecasting-methods.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.6</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="fitted-values-and-residuals.html"><a href="fitted-values-and-residuals.html"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a><ul>
<li class="chapter" data-level="5.3.1" data-path="fitted-values-and-residuals.html"><a href="fitted-values-and-residuals.html#residuals"><i class="fa fa-check"></i><b>5.3.1</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="residual-diagnostics.html"><a href="residual-diagnostics.html"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a><ul>
<li class="chapter" data-level="5.4.1" data-path="residual-diagnostics.html"><a href="residual-diagnostics.html#white-noise"><i class="fa fa-check"></i><b>5.4.1</b> White noise</a></li>
<li class="chapter" data-level="5.4.2" data-path="residual-diagnostics.html"><a href="residual-diagnostics.html#example-forecasting-the-google-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting the Google daily closing stock price</a></li>
<li class="chapter" data-level="5.4.3" data-path="residual-diagnostics.html"><a href="residual-diagnostics.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="predict-interval.html"><a href="predict-interval.html"><i class="fa fa-check"></i><b>5.5</b> Prediction intervals</a><ul>
<li class="chapter" data-level="5.5.1" data-path="predict-interval.html"><a href="predict-interval.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.1</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.2" data-path="predict-interval.html"><a href="predict-interval.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="predict-interval.html"><a href="predict-interval.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.3</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="evaluating-model-accuracy.html"><a href="evaluating-model-accuracy.html"><i class="fa fa-check"></i><b>5.6</b> Evaluating model accuracy</a><ul>
<li class="chapter" data-level="5.6.1" data-path="evaluating-model-accuracy.html"><a href="evaluating-model-accuracy.html#forecast-errors"><i class="fa fa-check"></i><b>5.6.1</b> Forecast errors</a></li>
<li class="chapter" data-level="5.6.2" data-path="evaluating-model-accuracy.html"><a href="evaluating-model-accuracy.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.6.2</b> Scale dependent errors</a></li>
<li class="chapter" data-level="5.6.3" data-path="evaluating-model-accuracy.html"><a href="evaluating-model-accuracy.html#percentage-errors"><i class="fa fa-check"></i><b>5.6.3</b> Percentage errors</a></li>
<li class="chapter" data-level="5.6.4" data-path="evaluating-model-accuracy.html"><a href="evaluating-model-accuracy.html#scaled-errors"><i class="fa fa-check"></i><b>5.6.4</b> Scaled errors</a></li>
<li class="chapter" data-level="5.6.5" data-path="evaluating-model-accuracy.html"><a href="evaluating-model-accuracy.html#examples-beer-production"><i class="fa fa-check"></i><b>5.6.5</b> Examples: beer production</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="time-series-cross-validation.html"><a href="time-series-cross-validation.html"><i class="fa fa-check"></i><b>5.7</b> Time series cross-validation</a><ul>
<li class="chapter" data-level="5.7.1" data-path="time-series-cross-validation.html"><a href="time-series-cross-validation.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.7.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="forecasting-using-transformations.html"><a href="forecasting-using-transformations.html"><i class="fa fa-check"></i><b>5.8</b> Forecasting using transformations</a><ul>
<li class="chapter" data-level="5.8.1" data-path="forecasting-using-transformations.html"><a href="forecasting-using-transformations.html#prediction-intervals-with-transformations"><i class="fa fa-check"></i><b>5.8.1</b> Prediction intervals with transformations</a></li>
<li class="chapter" data-level="5.8.2" data-path="forecasting-using-transformations.html"><a href="forecasting-using-transformations.html#forecasting-with-constraints"><i class="fa fa-check"></i><b>5.8.2</b> Forecasting with constraints</a></li>
<li class="chapter" data-level="5.8.3" data-path="forecasting-using-transformations.html"><a href="forecasting-using-transformations.html#bias-adjustments"><i class="fa fa-check"></i><b>5.8.3</b> Bias adjustments</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="forecasting-with-decomposition.html"><a href="forecasting-with-decomposition.html"><i class="fa fa-check"></i><b>5.9</b> Forecasting with decomposition</a><ul>
<li class="chapter" data-level="5.9.1" data-path="forecasting-with-decomposition.html"><a href="forecasting-with-decomposition.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>5.9.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a><ul>
<li class="chapter" data-level="6.1" data-path="beware-of-limitations.html"><a href="beware-of-limitations.html"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="key-principles.html"><a href="key-principles.html"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="the-delphi-method.html"><a href="the-delphi-method.html"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a><ul>
<li class="chapter" data-level="6.3.1" data-path="the-delphi-method.html"><a href="the-delphi-method.html#experts-and-anonymity"><i class="fa fa-check"></i><b>6.3.1</b> Experts and anonymity</a></li>
<li class="chapter" data-level="6.3.2" data-path="the-delphi-method.html"><a href="the-delphi-method.html#setting-the-forecasting-task-in-a-delphi"><i class="fa fa-check"></i><b>6.3.2</b> Setting the forecasting task in a Delphi</a></li>
<li class="chapter" data-level="6.3.3" data-path="the-delphi-method.html"><a href="the-delphi-method.html#iteration"><i class="fa fa-check"></i><b>6.3.3</b> Iteration</a></li>
<li class="chapter" data-level="6.3.4" data-path="the-delphi-method.html"><a href="the-delphi-method.html#final-forecasts"><i class="fa fa-check"></i><b>6.3.4</b> Final forecasts</a></li>
<li class="chapter" data-level="6.3.5" data-path="the-delphi-method.html"><a href="the-delphi-method.html#limitations-and-variations"><i class="fa fa-check"></i><b>6.3.5</b> Limitations and variations</a></li>
<li class="chapter" data-level="6.3.6" data-path="the-delphi-method.html"><a href="the-delphi-method.html#the-facilitator"><i class="fa fa-check"></i><b>6.3.6</b> The facilitator</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="forecasting-by-analogy.html"><a href="forecasting-by-analogy.html"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="scenario-forecasting.html"><a href="scenario-forecasting.html"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="new-product-forecasting.html"><a href="new-product-forecasting.html"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a><ul>
<li class="chapter" data-level="6.6.1" data-path="new-product-forecasting.html"><a href="new-product-forecasting.html#sales-force-composite"><i class="fa fa-check"></i><b>6.6.1</b> Sales force composite</a></li>
<li class="chapter" data-level="6.6.2" data-path="new-product-forecasting.html"><a href="new-product-forecasting.html#executive-opinion"><i class="fa fa-check"></i><b>6.6.2</b> Executive opinion</a></li>
<li class="chapter" data-level="6.6.3" data-path="new-product-forecasting.html"><a href="new-product-forecasting.html#customer-intentions"><i class="fa fa-check"></i><b>6.6.3</b> Customer intentions</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a><ul>
<li class="chapter" data-level="6.7.1" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html#use-adjustments-sparingly"><i class="fa fa-check"></i><b>6.7.1</b> Use adjustments sparingly</a></li>
<li class="chapter" data-level="6.7.2" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html#apply-a-structured-approach"><i class="fa fa-check"></i><b>6.7.2</b> Apply a structured approach</a></li>
<li class="chapter" data-level="6.7.3" data-path="judgmental-adjustments.html"><a href="judgmental-adjustments.html#example-tourism-forecasting-committee-tfc"><i class="fa fa-check"></i><b>6.7.3</b> Example: Tourism Forecasting Committee (TFC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a><ul>
<li class="chapter" data-level="7.1" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>7.1</b> The linear model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="the-linear-model.html"><a href="the-linear-model.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="the-linear-model.html"><a href="the-linear-model.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="the-linear-model.html"><a href="the-linear-model.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a><ul>
<li class="chapter" data-level="7.2.1" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#fitted-values"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness of fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="least-squares-estimation.html"><a href="least-squares-estimation.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="evaluating-a-regression-model.html"><a href="evaluating-a-regression-model.html"><i class="fa fa-check"></i><b>7.3</b> Evaluating a regression model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="evaluating-a-regression-model.html"><a href="evaluating-a-regression-model.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.1</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.2" data-path="evaluating-a-regression-model.html"><a href="evaluating-a-regression-model.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.2</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.3" data-path="evaluating-a-regression-model.html"><a href="evaluating-a-regression-model.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.3</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.4" data-path="evaluating-a-regression-model.html"><a href="evaluating-a-regression-model.html#the-performance-package"><i class="fa fa-check"></i><b>7.3.4</b> The <code>performance</code> package</a></li>
<li class="chapter" data-level="7.3.5" data-path="evaluating-a-regression-model.html"><a href="evaluating-a-regression-model.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.5</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>7.4.3</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.4.4" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
<li class="chapter" data-level="7.4.7" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#easter"><i class="fa fa-check"></i><b>7.4.7</b> Easter</a></li>
<li class="chapter" data-level="7.4.8" data-path="some-useful-predictors.html"><a href="some-useful-predictors.html#fourier-sereis"><i class="fa fa-check"></i><b>7.4.8</b> Fourier sereis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="selecting-predictors.html"><a href="selecting-predictors.html"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a><ul>
<li class="chapter" data-level="7.5.1" data-path="selecting-predictors.html"><a href="selecting-predictors.html#adjusst-r-square"><i class="fa fa-check"></i><b>7.5.1</b> Adjusst R square</a></li>
<li class="chapter" data-level="7.5.2" data-path="selecting-predictors.html"><a href="selecting-predictors.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="selecting-predictors.html"><a href="selecting-predictors.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="selecting-predictors.html"><a href="selecting-predictors.html#bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="selecting-predictors.html"><a href="selecting-predictors.html#which-measure-should-we-suse"><i class="fa fa-check"></i><b>7.5.5</b> Which measure should we suse</a></li>
<li class="chapter" data-level="7.5.6" data-path="selecting-predictors.html"><a href="selecting-predictors.html#example-us-consumption"><i class="fa fa-check"></i><b>7.5.6</b> Example: US consumption</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="forecasting-with-regression.html"><a href="forecasting-with-regression.html"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="forecasting-with-regression.html"><a href="forecasting-with-regression.html#ex-ante-versus-ex-post-forecasts"><i class="fa fa-check"></i><b>7.6.1</b> Ex-ante versus ex-post forecasts</a></li>
<li class="chapter" data-level="7.6.2" data-path="forecasting-with-regression.html"><a href="forecasting-with-regression.html#example-australian-quarterly-beer-production-1"><i class="fa fa-check"></i><b>7.6.2</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.6.3" data-path="forecasting-with-regression.html"><a href="forecasting-with-regression.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.3</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.4" data-path="forecasting-with-regression.html"><a href="forecasting-with-regression.html#prediction-intervals"><i class="fa fa-check"></i><b>7.6.4</b> Prediction intervals</a></li>
<li class="chapter" data-level="7.6.5" data-path="forecasting-with-regression.html"><a href="forecasting-with-regression.html#building-a-predictive-regression-model"><i class="fa fa-check"></i><b>7.6.5</b> Building a predictive regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="matrix-formulation.html"><a href="matrix-formulation.html"><i class="fa fa-check"></i><b>7.7</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.8" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html"><i class="fa fa-check"></i><b>7.8</b> Nonlinear regression</a><ul>
<li class="chapter" data-level="7.8.1" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.8.1</b> Forecasting with a nonlinear trend</a></li>
<li class="chapter" data-level="7.8.2" data-path="nonlinear-regression.html"><a href="nonlinear-regression.html#example-boston-marathon-winning-times"><i class="fa fa-check"></i><b>7.8.2</b> Example: Boston marathon winning times</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="correlation-causation-and-forecasting.html"><a href="correlation-causation-and-forecasting.html"><i class="fa fa-check"></i><b>7.9</b> Correlation, causation and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a><ul>
<li class="chapter" data-level="8.1" data-path="simple-exponential-smoothing.html"><a href="simple-exponential-smoothing.html"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a><ul>
<li class="chapter" data-level="8.1.1" data-path="simple-exponential-smoothing.html"><a href="simple-exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="simple-exponential-smoothing.html"><a href="simple-exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="simple-exponential-smoothing.html"><a href="simple-exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="simple-exponential-smoothing.html"><a href="simple-exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>8.1.4</b> Estimation</a></li>
<li class="chapter" data-level="8.1.5" data-path="simple-exponential-smoothing.html"><a href="simple-exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html"><i class="fa fa-check"></i><b>8.2</b> Methods with trend and seasonality</a><ul>
<li class="chapter" data-level="8.2.1" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#example-australian-population"><i class="fa fa-check"></i><b>8.2.2</b> Example: Australian population</a></li>
<li class="chapter" data-level="8.2.3" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.3</b> Damped trend methods</a></li>
<li class="chapter" data-level="8.2.4" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#example-australian-population-continued"><i class="fa fa-check"></i><b>8.2.4</b> Example: Australian Population (continued)</a></li>
<li class="chapter" data-level="8.2.5" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#example-internet-usage"><i class="fa fa-check"></i><b>8.2.5</b> Example: Internet usage</a></li>
<li class="chapter" data-level="8.2.6" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.2.6</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.2.7" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.2.7</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.2.8" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.2.8</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.2.9" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.2.9</b> Holt-Winters’ damped method</a></li>
<li class="chapter" data-level="8.2.10" data-path="methods-with-trend-and-seasonality.html"><a href="methods-with-trend-and-seasonality.html#example-holt-winters-method-with-daily-data"><i class="fa fa-check"></i><b>8.2.10</b> Example: Holt-Winters method with daily data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-taxonomy-of-exponential-smoothing-methods.html"><a href="a-taxonomy-of-exponential-smoothing-methods.html"><i class="fa fa-check"></i><b>8.3</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.4" data-path="innovations-state-space-models-for-exponential-smoothing.html"><a href="innovations-state-space-models-for-exponential-smoothing.html"><i class="fa fa-check"></i><b>8.4</b> Innovations state space models for exponential smoothing</a><ul>
<li class="chapter" data-level="8.4.1" data-path="innovations-state-space-models-for-exponential-smoothing.html"><a href="innovations-state-space-models-for-exponential-smoothing.html#etsann-simple-exponential-smoothing-with-additive-errors"><i class="fa fa-check"></i><b>8.4.1</b> ETS(A,N,N): simple exponential smoothing with additive errors</a></li>
<li class="chapter" data-level="8.4.2" data-path="innovations-state-space-models-for-exponential-smoothing.html"><a href="innovations-state-space-models-for-exponential-smoothing.html#etsmnn-simple-exponential-smoothing-with-multiplicative-errors"><i class="fa fa-check"></i><b>8.4.2</b> ETS(M,N,N): simple exponential smoothing with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.3" data-path="innovations-state-space-models-for-exponential-smoothing.html"><a href="innovations-state-space-models-for-exponential-smoothing.html#etsaan-holts-linear-method-with-additive-errors"><i class="fa fa-check"></i><b>8.4.3</b> ETS(A,A,N): Holt’s linear method with additive errors</a></li>
<li class="chapter" data-level="8.4.4" data-path="innovations-state-space-models-for-exponential-smoothing.html"><a href="innovations-state-space-models-for-exponential-smoothing.html#ets-man"><i class="fa fa-check"></i><b>8.4.4</b> ETS(M,A,N): Holt’s linear method with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.5" data-path="innovations-state-space-models-for-exponential-smoothing.html"><a href="innovations-state-space-models-for-exponential-smoothing.html#other-ets-models"><i class="fa fa-check"></i><b>8.4.5</b> Other ETS models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="estimation-and-model-selection.html"><a href="estimation-and-model-selection.html"><i class="fa fa-check"></i><b>8.5</b> Estimation and model selection</a><ul>
<li class="chapter" data-level="8.5.1" data-path="estimation-and-model-selection.html"><a href="estimation-and-model-selection.html#estimating-ets-models"><i class="fa fa-check"></i><b>8.5.1</b> Estimating ETS models</a></li>
<li class="chapter" data-level="8.5.2" data-path="estimation-and-model-selection.html"><a href="estimation-and-model-selection.html#model-selection-criteria"><i class="fa fa-check"></i><b>8.5.2</b> Model selection criteria</a></li>
<li class="chapter" data-level="8.5.3" data-path="estimation-and-model-selection.html"><a href="estimation-and-model-selection.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.5.3</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="forecasting-with-ets-models.html"><a href="forecasting-with-ets-models.html"><i class="fa fa-check"></i><b>8.6</b> Forecasting with ETS models</a><ul>
<li class="chapter" data-level="8.6.1" data-path="forecasting-with-ets-models.html"><a href="forecasting-with-ets-models.html#example-australia-gas-production"><i class="fa fa-check"></i><b>8.6.1</b> Example: Australia gas production</a></li>
<li class="chapter" data-level="8.6.2" data-path="forecasting-with-ets-models.html"><a href="forecasting-with-ets-models.html#prediction-intervals-1"><i class="fa fa-check"></i><b>8.6.2</b> Prediction intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html"><i class="fa fa-check"></i><b>9</b> Univariate stationary processes</a><ul>
<li class="chapter" data-level="9.1" data-path="stationarity.html"><a href="stationarity.html"><i class="fa fa-check"></i><b>9.1</b> Stationarity</a><ul>
<li class="chapter" data-level="9.1.1" data-path="stationarity.html"><a href="stationarity.html#ch9-white-noise"><i class="fa fa-check"></i><b>9.1.1</b> White noise</a></li>
<li class="chapter" data-level="9.1.2" data-path="stationarity.html"><a href="stationarity.html#tests-for-autocorrelation-and-normality"><i class="fa fa-check"></i><b>9.1.2</b> Tests for autocorrelation and normality</a></li>
<li class="chapter" data-level="9.1.3" data-path="stationarity.html"><a href="stationarity.html#the-wold-decomposition"><i class="fa fa-check"></i><b>9.1.3</b> The Wold Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="backshift-notation.html"><a href="backshift-notation.html"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="autoregressive-models.html"><a href="autoregressive-models.html"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a><ul>
<li class="chapter" data-level="9.3.1" data-path="autoregressive-models.html"><a href="autoregressive-models.html#stimulating-an-arp-process"><i class="fa fa-check"></i><b>9.3.1</b> Stimulating an AR(p) process</a></li>
<li class="chapter" data-level="9.3.2" data-path="autoregressive-models.html"><a href="autoregressive-models.html#decision-of-order-p"><i class="fa fa-check"></i><b>9.3.2</b> Decision of order p</a></li>
<li class="chapter" data-level="9.3.3" data-path="autoregressive-models.html"><a href="autoregressive-models.html#random-walk"><i class="fa fa-check"></i><b>9.3.3</b> Random walk</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="moving-average-models.html"><a href="moving-average-models.html#simulating-an-maq-process"><i class="fa fa-check"></i><b>9.4.1</b> Simulating an MA(q) process</a></li>
<li class="chapter" data-level="9.4.2" data-path="moving-average-models.html"><a href="moving-average-models.html#decision-of-order-q"><i class="fa fa-check"></i><b>9.4.2</b> Decision of order q</a></li>
<li class="chapter" data-level="9.4.3" data-path="moving-average-models.html"><a href="moving-average-models.html#koyck-transformation-and-invertibility"><i class="fa fa-check"></i><b>9.4.3</b> Koyck transformation and Invertibility</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="arma-models.html"><a href="arma-models.html"><i class="fa fa-check"></i><b>9.5</b> ARMA models</a><ul>
<li class="chapter" data-level="9.5.1" data-path="arma-models.html"><a href="arma-models.html#three-representations-of-an-arma-model"><i class="fa fa-check"></i><b>9.5.1</b> Three representations of an ARMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>10</b> ARIMA models</a><ul>
<li class="chapter" data-level="10.1" data-path="differencing.html"><a href="differencing.html"><i class="fa fa-check"></i><b>10.1</b> Differencing</a><ul>
<li class="chapter" data-level="10.1.1" data-path="differencing.html"><a href="differencing.html#second-order-differencing"><i class="fa fa-check"></i><b>10.1.1</b> Second-order differencing</a></li>
<li class="chapter" data-level="10.1.2" data-path="differencing.html"><a href="differencing.html#seasonal-differencing"><i class="fa fa-check"></i><b>10.1.2</b> Seasonal differencing</a></li>
<li class="chapter" data-level="10.1.3" data-path="differencing.html"><a href="differencing.html#unit-root-tests"><i class="fa fa-check"></i><b>10.1.3</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="non-seasonal-arima-models.html"><a href="non-seasonal-arima-models.html"><i class="fa fa-check"></i><b>10.2</b> Non-seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.2.1" data-path="non-seasonal-arima-models.html"><a href="non-seasonal-arima-models.html#understanding-arima-models"><i class="fa fa-check"></i><b>10.2.1</b> Understanding ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="estimation-and-order-selection.html"><a href="estimation-and-order-selection.html"><i class="fa fa-check"></i><b>10.3</b> Estimation and order selection</a><ul>
<li class="chapter" data-level="10.3.1" data-path="estimation-and-order-selection.html"><a href="estimation-and-order-selection.html#mle"><i class="fa fa-check"></i><b>10.3.1</b> MLE</a></li>
<li class="chapter" data-level="10.3.2" data-path="estimation-and-order-selection.html"><a href="estimation-and-order-selection.html#information-criteria"><i class="fa fa-check"></i><b>10.3.2</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="the-arima-function.html"><a href="the-arima-function.html"><i class="fa fa-check"></i><b>10.4</b> The <code>ARIMA()</code> function</a><ul>
<li class="chapter" data-level="10.4.1" data-path="the-arima-function.html"><a href="the-arima-function.html#algorithm"><i class="fa fa-check"></i><b>10.4.1</b> Algorithm</a></li>
<li class="chapter" data-level="10.4.2" data-path="the-arima-function.html"><a href="the-arima-function.html#modelling-procedure"><i class="fa fa-check"></i><b>10.4.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="10.4.3" data-path="the-arima-function.html"><a href="the-arima-function.html#example-seasonally-adjusted-electrical-equipment-orders"><i class="fa fa-check"></i><b>10.4.3</b> Example: Seasonally adjusted electrical equipment orders</a></li>
<li class="chapter" data-level="10.4.4" data-path="the-arima-function.html"><a href="the-arima-function.html#plotting-the-characteristic-roots"><i class="fa fa-check"></i><b>10.4.4</b> Plotting the characteristic roots</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="forecasting-with-arima-models.html"><a href="forecasting-with-arima-models.html"><i class="fa fa-check"></i><b>10.5</b> Forecasting with ARIMA models</a><ul>
<li class="chapter" data-level="10.5.1" data-path="forecasting-with-arima-models.html"><a href="forecasting-with-arima-models.html#point-forecasts"><i class="fa fa-check"></i><b>10.5.1</b> Point forecasts</a></li>
<li class="chapter" data-level="10.5.2" data-path="forecasting-with-arima-models.html"><a href="forecasting-with-arima-models.html#prediction-intervals-2"><i class="fa fa-check"></i><b>10.5.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="seasonal-arima-models.html"><a href="seasonal-arima-models.html"><i class="fa fa-check"></i><b>10.6</b> Seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.6.1" data-path="seasonal-arima-models.html"><a href="seasonal-arima-models.html#acf-and-pacf"><i class="fa fa-check"></i><b>10.6.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="10.6.2" data-path="seasonal-arima-models.html"><a href="seasonal-arima-models.html#example-european-quarterly-retail-trade"><i class="fa fa-check"></i><b>10.6.2</b> Example: European quarterly retail trade</a></li>
<li class="chapter" data-level="10.6.3" data-path="seasonal-arima-models.html"><a href="seasonal-arima-models.html#example-corticosteroid-drug-sales-in-australia"><i class="fa fa-check"></i><b>10.6.3</b> Example: Corticosteroid drug sales in Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="ets-and-arima.html"><a href="ets-and-arima.html"><i class="fa fa-check"></i><b>10.7</b> ETS and ARIMA</a><ul>
<li class="chapter" data-level="10.7.1" data-path="ets-and-arima.html"><a href="ets-and-arima.html#example-comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>10.7.1</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="10.7.2" data-path="ets-and-arima.html"><a href="ets-and-arima.html#example-comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>10.7.2</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>11</b> Dynamic regression models</a><ul>
<li class="chapter" data-level="11.1" data-path="estimation-1.html"><a href="estimation-1.html"><i class="fa fa-check"></i><b>11.1</b> Estimation</a></li>
<li class="chapter" data-level="11.2" data-path="regression-with-arima-errors.html"><a href="regression-with-arima-errors.html"><i class="fa fa-check"></i><b>11.2</b> Regression with ARIMA errors</a><ul>
<li class="chapter" data-level="11.2.1" data-path="regression-with-arima-errors.html"><a href="regression-with-arima-errors.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>11.2.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>11.3</b> Forecasting</a><ul>
<li class="chapter" data-level="11.3.1" data-path="forecasting.html"><a href="forecasting.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>11.3.1</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="deterministic-and-stochastic-trends.html"><a href="deterministic-and-stochastic-trends.html"><i class="fa fa-check"></i><b>11.4</b> Deterministic and stochastic trends</a><ul>
<li class="chapter" data-level="11.4.1" data-path="deterministic-and-stochastic-trends.html"><a href="deterministic-and-stochastic-trends.html#example-international-visitors-to-australia"><i class="fa fa-check"></i><b>11.4.1</b> Example: International visitors to Australia</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="dynamic-harmonic-regression.html"><a href="dynamic-harmonic-regression.html"><i class="fa fa-check"></i><b>11.5</b> Dynamic harmonic regression</a><ul>
<li class="chapter" data-level="11.5.1" data-path="dynamic-harmonic-regression.html"><a href="dynamic-harmonic-regression.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>11.5.1</b> Example: Australian eating out expenditure</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="lagged-predictors.html"><a href="lagged-predictors.html"><i class="fa fa-check"></i><b>11.6</b> Lagged predictors</a><ul>
<li class="chapter" data-level="11.6.1" data-path="lagged-predictors.html"><a href="lagged-predictors.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>11.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for “Forecasting: Principles and Practice, 3rd edition”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="seasonal-arima-models" class="section level2">
<h2><span class="header-section-number">10.6</span> Seasonal ARIMA models</h2>
<p>So far, we have restricted our attention to non-seasonal data and non-seasonal ARIMA models. However, ARIMA models are also capable of modelling a wide range of seasonal data.</p>
<p>A seasonal ARIMA model includes additional seasonal terms, written as follows</p>
<p><img src="images/seasonal_arima.png" width="90%" style="display: block; margin: auto;" />
where <span class="math inline">\(m\)</span> is number of observations per year.</p>
<p>The seasonal part of the model consists of terms that are similar to the non-seasonal components of the model, but involve backshifts of the seasonal period. For example, an <span class="math inline">\(\text{ARIMA}(1, 1, 1)(1, 1, 1)_4\)</span> model (without a constant) is for quarterly data (m = 4), and can be written as (Not that a seasonal difference is <strong>not</strong> a m order difference)</p>
<p><span class="math display">\[
(1 - \Phi_1B^4)(1 - \phi_1B)(1 - B^4)(1 - B)y_t = \varepsilon_t(1 - \theta_1B)(1 - \Theta_1B^4)
\]</span></p>
<p>It can be easily shown that a SARIMA model can be converted to an ARMA model. For autoregression terms</p>
<p><span class="math display">\[
ar = (1 - \phi_1B - \cdots - \phi_pB^p)(1 - B)^d \\
sar = (1 - \Phi_1 B^m - \cdots - B^{Pm})(1 - B^m)^D 
\]</span>
Then, the AR polynomial of the inverted ARMA model can be written as</p>
<p><span class="math display">\[
AR = ar \times sar
\]</span></p>
<p>For moving average terms, we have</p>
<p><span class="math display">\[
ma = (1 + \theta_1B + \cdots + \theta_qB^q) \\
sma = (1 + \Theta_1B^m + \cdots + \Theta_1B^{Pm})(1 - B^m)^D 
\]</span></p>
<p>Then, the MA polynomial of the inverted ARMA model can be written as</p>
<p><span class="math display">\[
MA = ma \times sma
\]</span></p>
<p>In this way, we can get the ARMA(u, v) model inverted from the SARIMA model. It can be written as</p>
<p><span class="math display">\[
(1 - \phi_1&#39;B - \cdots - \phi_u&#39;B^u)y_t = (1 - \theta_1&#39;B - \cdots - \theta_v&#39;B^v)\varepsilon_t
\]</span></p>
<p>From Section <a href="arma-models.html#three-representations-of-an-arma-model">9.5.1</a>, we also know that an ARMA model can be converted to AR or MA models under certain circumstances, so that SARIMA models can be further transformed in a similar way.</p>
<div id="acf-and-pacf" class="section level3">
<h3><span class="header-section-number">10.6.1</span> ACF and PACF</h3>
<p>The seasonal part of an AR or MA model will be seen in the seasonal lags of the PACF and ACF. For example, an <span class="math inline">\(\text{ARIMA}(0, 0, 0)(0, 0, 1)_{12}\)</span> model will show:</p>
<ul>
<li><p>a spike at lag 12 in the ACF but no other significant spikes;</p></li>
<li><p>exponential decay in the seasonal lags of the PACF (i.e., at lags 12, 24, 36, …).</p></li>
</ul>
<p>Similarly, an <span class="math inline">\(\text{ARIMA}(0, 0, 0)(1, 0, 0)_{12}\)</span> model will show:</p>
<ul>
<li><p>exponential decay in the seasonal lags of the ACF;</p></li>
<li><p>a single significant spike at lag 12 in the PACF.</p></li>
</ul>
</div>
<div id="example-european-quarterly-retail-trade" class="section level3">
<h3><span class="header-section-number">10.6.2</span> Example: European quarterly retail trade</h3>
<p><code>eu_retail</code>: quarterly European retail trade data from 1996 to 2011</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1">eu_retail &lt;-<span class="st"> </span><span class="kw">as_tsibble</span>(fpp2<span class="op">::</span>euretail)</a>
<a class="sourceLine" id="cb200-2" title="2">eu_retail <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(value)</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-25-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The data is non-stationary, with a degree of seasonality</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1">eu_retail <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(value, feat_stl)</a>
<a class="sourceLine" id="cb201-2" title="2"><span class="co">#&gt; # A tibble: 1 x 9</span></a>
<a class="sourceLine" id="cb201-3" title="3"><span class="co">#&gt;   trend_strength seasonal_streng~ seasonal_peak_y~ seasonal_trough~ spikiness</span></a>
<a class="sourceLine" id="cb201-4" title="4"><span class="co">#&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb201-5" title="5"><span class="co">#&gt; 1          0.998            0.703                0                1   3.77e-7</span></a>
<a class="sourceLine" id="cb201-6" title="6"><span class="co">#&gt; # ... with 4 more variables: linearity &lt;dbl&gt;, curvature &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb201-7" title="7"><span class="co">#&gt; #   stl_e_acf1 &lt;dbl&gt;, stl_e_acf10 &lt;dbl&gt;</span></a></code></pre></div>
<p>We will first take a seasonal difference. These still appear to be some sort of nonstationarity, so we take an additional first difference</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">eu_retail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb202-2" title="2"><span class="st">  </span><span class="kw">gg_tsdisplay</span>(<span class="kw">difference</span>(value, <span class="dv">4</span>), <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>)</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1">eu_retail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb203-2" title="2"><span class="st">  </span><span class="kw">gg_tsdisplay</span>(value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(),</a>
<a class="sourceLine" id="cb203-3" title="3">  <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>)</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-28-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Our aim now is to find an appropriate ARIMA model based on the ACF and PACF plots. The significant spike at lag 1 in the ACF suggests a non-seasonal MA(1) component, and the significant spike at lag 4 in the ACF suggests a seasonal MA(1) component. Consequently, we begin with an <span class="math inline">\(\text{ARIMA}(0, 1, 1)(0, 1, 1)_4\)</span> model, indicating a first and seasonal difference, and non-seasonal and seasonal MA(1) components. By analogous logic applied to the PACF, we could also have started with an <span class="math inline">\(\text{ARIMA}(1,1,0)(1,1,0)_4\)</span> model. (Not that only either <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> is zero can ACF and PACF plots be used to decide orders. <a href="arma-models.html#arma-models">9.5</a>)</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1">eu_retail_fit &lt;-<span class="st"> </span>eu_retail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">PDQ</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb204-3" title="3"></a>
<a class="sourceLine" id="cb204-4" title="4">eu_retail_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</a>
<a class="sourceLine" id="cb204-5" title="5"><span class="co">#&gt; Series: value </span></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="co">#&gt; Model: ARIMA(0,1,1)(0,1,1)[4] </span></a>
<a class="sourceLine" id="cb204-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb204-8" title="8"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb204-9" title="9"><span class="co">#&gt;         ma1    sma1</span></a>
<a class="sourceLine" id="cb204-10" title="10"><span class="co">#&gt;       0.290  -0.691</span></a>
<a class="sourceLine" id="cb204-11" title="11"><span class="co">#&gt; s.e.  0.112   0.119</span></a>
<a class="sourceLine" id="cb204-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb204-13" title="13"><span class="co">#&gt; sigma^2 estimated as 0.188:  log likelihood=-34.6</span></a>
<a class="sourceLine" id="cb204-14" title="14"><span class="co">#&gt; AIC=75.3   AICc=75.7   BIC=81.5</span></a></code></pre></div>
<p>Check residuals</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1">eu_retail_aug &lt;-<span class="st"> </span>eu_retail_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">augment</span>()</a>
<a class="sourceLine" id="cb205-2" title="2"></a>
<a class="sourceLine" id="cb205-3" title="3">eu_retail_aug <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-4" title="4"><span class="st">  </span><span class="kw">ACF</span>(.resid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-5" title="5"><span class="st">  </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb205-6" title="6"></a>
<a class="sourceLine" id="cb205-7" title="7">eu_retail_aug <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-8" title="8"><span class="st">  </span><span class="kw">PACF</span>(.resid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-9" title="9"><span class="st">  </span><span class="kw">autoplot</span>()</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-30-1.png" width="50%" /><img src="ch9_files/figure-html/unnamed-chunk-30-2.png" width="50%" /></p>
<p>Both the ACF and PACF show significant spikes at lag 2, and almost significant spikes at lag 3, indicating that some additional non-seasonal terms need to be included in the model. What if we just let <code>ARIMA()</code> pick a model for us?</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1">eu_retail_fit2 &lt;-<span class="st"> </span>eu_retail <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb206-2" title="2"><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(value))</a>
<a class="sourceLine" id="cb206-3" title="3"></a>
<a class="sourceLine" id="cb206-4" title="4">eu_retail_fit2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</a>
<a class="sourceLine" id="cb206-5" title="5"><span class="co">#&gt; Series: value </span></a>
<a class="sourceLine" id="cb206-6" title="6"><span class="co">#&gt; Model: ARIMA(0,1,3)(0,1,1)[4] </span></a>
<a class="sourceLine" id="cb206-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb206-8" title="8"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb206-9" title="9"><span class="co">#&gt;         ma1    ma2    ma3    sma1</span></a>
<a class="sourceLine" id="cb206-10" title="10"><span class="co">#&gt;       0.263  0.369  0.420  -0.664</span></a>
<a class="sourceLine" id="cb206-11" title="11"><span class="co">#&gt; s.e.  0.124  0.126  0.129   0.154</span></a>
<a class="sourceLine" id="cb206-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb206-13" title="13"><span class="co">#&gt; sigma^2 estimated as 0.156:  log likelihood=-28.6</span></a>
<a class="sourceLine" id="cb206-14" title="14"><span class="co">#&gt; AIC=67.3   AICc=68.4   BIC=77.7</span></a></code></pre></div>
<p>The automatic picked model is <span class="math inline">\(\text{ARIMA}(0, 1, 3)(0, 1, 1)_4\)</span>, and has lower <span class="math inline">\(\text{AIC}_c\)</span>, 68.39 compared to 75.72. This in some sense explains why previous residuals show some non-seaonal correlation pattern and how it is fixed.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">eu_retail_fit2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb207-2" title="2"><span class="st">  </span><span class="kw">gg_tsresiduals</span>()</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-32-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"></a>
<a class="sourceLine" id="cb208-2" title="2">eu_retail_fit2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb208-3" title="3"><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-4" title="4"><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">8</span>, <span class="dt">dof =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb208-5" title="5"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb208-6" title="6"><span class="co">#&gt;   .model       lb_stat lb_pvalue</span></a>
<a class="sourceLine" id="cb208-7" title="7"><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb208-8" title="8"><span class="co">#&gt; 1 ARIMA(value)   0.511     0.916</span></a></code></pre></div>
<p>Forecasts from the model for the next three years are shown below</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">eu_retail_fit2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-2" title="2"><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb209-3" title="3"><span class="st">  </span><span class="kw">autoplot</span>(eu_retail)</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The forecasts follow the recent trend in the data, because of the double differencing. The large and rapidly increasing prediction intervals show that the retail trade index could start increasing or decreasing at any time — while the point forecasts trend downwards, the prediction intervals allow for the data to trend upwards during the forecast period.</p>
</div>
<div id="example-corticosteroid-drug-sales-in-australia" class="section level3">
<h3><span class="header-section-number">10.6.3</span> Example: Corticosteroid drug sales in Australia</h3>
<p>We will try to forecast monthly corticosteroid drug sales in Australia. There is a small increase in the variance with the level, so we take logarithms to stabilise the variance.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" title="1">h02 &lt;-<span class="st"> </span>tsibbledata<span class="op">::</span>PBS <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb210-2" title="2"><span class="st">  </span><span class="kw">filter</span>(ATC2 <span class="op">==</span><span class="st"> &quot;H02&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb210-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">cost =</span> <span class="kw">sum</span>(Cost) <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>)  </a>
<a class="sourceLine" id="cb210-4" title="4"></a>
<a class="sourceLine" id="cb210-5" title="5">h02 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb210-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cost_log =</span> <span class="kw">log</span>(cost)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-7" title="7"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(cost, cost_log), <span class="dt">names_to =</span> <span class="st">&quot;measure&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-9" title="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(Month, value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb210-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>measure, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-34-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The data are strongly seasonal and obviously non-stationary, so seasonal differencing will be used. It is unclear that whether another difference should be used at this point, though we decide not to. The last few observations appear to be different (more variable) from the earlier data. This may be due to the fact that data are sometimes revised when earlier sales are reported late.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">h02 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb211-2" title="2"><span class="st">  </span><span class="kw">gg_tsdisplay</span>(<span class="kw">difference</span>(<span class="kw">log</span>(cost), <span class="dv">12</span>), </a>
<a class="sourceLine" id="cb211-3" title="3">               <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>, </a>
<a class="sourceLine" id="cb211-4" title="4">               <span class="dt">lag_max =</span> <span class="dv">24</span>) </a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-35-1.png" width="90%" style="display: block; margin: auto;" />
In the plots of the seasonally differenced data, there are spikes in the PACF at lags 12 and 24, but nothing at seasonal lags in the ACF. This may be suggestive of a seasonal AR(2) term. In the non-seasonal lags, there are three significant spikes in the PACF, suggesting a possible AR(3) term. The pattern in the ACF is not indicative of any simple model.</p>
<p>Consequently, this initial analysis suggests that a possible model for these data is an <span class="math inline">\(\text{ARIMA}(3, 0, 0)(2, 1, 0)_12\)</span>. The <span class="math inline">\(\text{AIC}_c\)</span> of such model and some variations are shown:</p>
<p><img src="images/seasonal_arima_2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Of these models, the best is the <span class="math inline">\(ARIMA(3, 0, 1)(0, 1, 2)_12\)</span> model</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" title="1">h02_fit &lt;-<span class="st"> </span>h02 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb212-2" title="2"><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(<span class="kw">log</span>(cost) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">PDQ</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))) <span class="co"># without constant</span></a>
<a class="sourceLine" id="cb212-3" title="3"></a>
<a class="sourceLine" id="cb212-4" title="4">h02_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</a>
<a class="sourceLine" id="cb212-5" title="5"><span class="co">#&gt; Series: cost </span></a>
<a class="sourceLine" id="cb212-6" title="6"><span class="co">#&gt; Model: ARIMA(3,0,1)(0,1,2)[12] </span></a>
<a class="sourceLine" id="cb212-7" title="7"><span class="co">#&gt; Transformation: log(.x) </span></a>
<a class="sourceLine" id="cb212-8" title="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb212-9" title="9"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb212-10" title="10"><span class="co">#&gt;          ar1     ar2     ar3    ma1     sma1     sma2</span></a>
<a class="sourceLine" id="cb212-11" title="11"><span class="co">#&gt;       -0.160  0.5481  0.5678  0.383  -0.5222  -0.1768</span></a>
<a class="sourceLine" id="cb212-12" title="12"><span class="co">#&gt; s.e.   0.164  0.0878  0.0942  0.190   0.0861   0.0872</span></a>
<a class="sourceLine" id="cb212-13" title="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb212-14" title="14"><span class="co">#&gt; sigma^2 estimated as 0.004278:  log likelihood=250</span></a>
<a class="sourceLine" id="cb212-15" title="15"><span class="co">#&gt; AIC=-486   AICc=-485   BIC=-463</span></a></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">h02_aug &lt;-<span class="st"> </span>h02_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">augment</span>()</a>
<a class="sourceLine" id="cb213-2" title="2"></a>
<a class="sourceLine" id="cb213-3" title="3">h02_aug <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-4" title="4"><span class="st">  </span><span class="kw">ACF</span>(.resid, <span class="dt">lag_max =</span> <span class="dv">36</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb213-5" title="5"><span class="st">  </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb213-6" title="6"></a>
<a class="sourceLine" id="cb213-7" title="7">h02_aug <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb213-8" title="8"><span class="st">  </span><span class="kw">PACF</span>(.resid, <span class="dt">lag_max =</span> <span class="dv">36</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb213-9" title="9"><span class="st">  </span><span class="kw">autoplot</span>()</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-38-1.png" width="50%" /><img src="ch9_files/figure-html/unnamed-chunk-38-2.png" width="50%" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" title="1">h02_aug <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb214-2" title="2"><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">24</span>, <span class="dt">dof =</span> <span class="dv">7</span>) <span class="co"># h = 2m for seasonal data </span></a>
<a class="sourceLine" id="cb214-3" title="3"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb214-4" title="4"><span class="co">#&gt;   .model                                             lb_stat lb_pvalue</span></a>
<a class="sourceLine" id="cb214-5" title="5"><span class="co">#&gt;   &lt;chr&gt;                                                &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb214-6" title="6"><span class="co">#&gt; 1 ARIMA(log(cost) ~ 0 + pdq(3, 0, 1) + PDQ(0, 1, 2))    23.7     0.129</span></a></code></pre></div>
<p>Produce forecasts</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1">h02_fit <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-2" title="2"><span class="st">  </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb215-3" title="3"><span class="st">  </span><span class="kw">autoplot</span>(h02)</a></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-40-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="forecasting-with-arima-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ets-and-arima.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/fpp/edit/master/ch9.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
