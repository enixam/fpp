<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 The forecaster’s toolbox | Notes for “Forecasting: Principles and Practice, 3rd edition”</title>
  <meta name="description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 The forecaster’s toolbox | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="github-repo" content="enixam/fpp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The forecaster’s toolbox | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  
  <meta name="twitter:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series-features.html"/>
<link rel="next" href="judgmental-forecasts.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for fpp3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a><ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-objects"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a><ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#manipulation"><i class="fa fa-check"></i><b>2.1.1</b> manipulation</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#importing"><i class="fa fa-check"></i><b>2.1.2</b> importing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plots"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#patterns-of-time-series-trend-seasonal-and-cyclic"><i class="fa fa-check"></i><b>2.3</b> Patterns of time series: trend, seasonal and cyclic</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a><ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods-period-in-gg_season"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods: <code>period</code> in <code>gg_season()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a><ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#visualization-between-time-series"><i class="fa fa-check"></i><b>2.6</b> Visualization between time series</a><ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.1</b> scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a><ul>
<li class="chapter" data-level="2.7.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.7.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.7.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.7.2</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#calendar-plots"><i class="fa fa-check"></i><b>2.8</b> Calendar plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a><ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformation-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformation and adjustments</a><ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#box-cox"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformation (Box-Cox)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.2</b> Moving averages</a><ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.2.1</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.2.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-component-with-seasonal-data"><i class="fa fa-check"></i><b>3.2.2</b> Estimating the trend-cycle component with seasonal data</a></li>
<li class="chapter" data-level="3.2.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.2.3</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.3</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#x11-decomposition"><i class="fa fa-check"></i><b>3.4</b> X11 decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seats-decomposition"><i class="fa fa-check"></i><b>3.5</b> SEATS decomposition</a></li>
<li class="chapter" data-level="3.6" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#stl-decomposition"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a><ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.3</b> STL features</a></li>
<li class="chapter" data-level="4.4" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="time-series-features.html"><a href="time-series-features.html#exporing-australian-tourism-data"><i class="fa fa-check"></i><b>4.5</b> Exporing Australian tourism data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a><ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a><ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualize"><i class="fa fa-check"></i><b>5.1.2</b> Visualize</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naive-method"><i class="fa fa-check"></i><b>5.2.2</b> Naive method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naive-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naive method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.5</b> Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.6</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.1</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a><ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#white-noise"><i class="fa fa-check"></i><b>5.4.1</b> White noise</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-the-google-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting the Google daily closing stock price</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#predict-interval"><i class="fa fa-check"></i><b>5.5</b> Prediction intervals</a><ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.1</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.3</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-model-accuracy"><i class="fa fa-check"></i><b>5.6</b> Evaluating model accuracy</a><ul>
<li class="chapter" data-level="5.6.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.6.1</b> Forecast errors</a></li>
<li class="chapter" data-level="5.6.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.6.2</b> Scale dependent errors</a></li>
<li class="chapter" data-level="5.6.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.6.3</b> Percentage errors</a></li>
<li class="chapter" data-level="5.6.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.6.4</b> Scaled errors</a></li>
<li class="chapter" data-level="5.6.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples-beer-production"><i class="fa fa-check"></i><b>5.6.5</b> Examples: beer production</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.7</b> Time series cross-validation</a><ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.7.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.8</b> Forecasting using transformations</a><ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-with-transformations"><i class="fa fa-check"></i><b>5.8.1</b> Prediction intervals with transformations</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-constraints"><i class="fa fa-check"></i><b>5.8.2</b> Forecasting with constraints</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#bias-adjustments"><i class="fa fa-check"></i><b>5.8.3</b> Bias adjustments</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.9</b> Forecasting with decomposition</a><ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>5.9.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a><ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a><ul>
<li class="chapter" data-level="6.3.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#experts-and-anonymity"><i class="fa fa-check"></i><b>6.3.1</b> Experts and anonymity</a></li>
<li class="chapter" data-level="6.3.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#setting-the-forecasting-task-in-a-delphi"><i class="fa fa-check"></i><b>6.3.2</b> Setting the forecasting task in a Delphi</a></li>
<li class="chapter" data-level="6.3.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#iteration"><i class="fa fa-check"></i><b>6.3.3</b> Iteration</a></li>
<li class="chapter" data-level="6.3.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#final-forecasts"><i class="fa fa-check"></i><b>6.3.4</b> Final forecasts</a></li>
<li class="chapter" data-level="6.3.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#limitations-and-variations"><i class="fa fa-check"></i><b>6.3.5</b> Limitations and variations</a></li>
<li class="chapter" data-level="6.3.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-facilitator"><i class="fa fa-check"></i><b>6.3.6</b> The facilitator</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a><ul>
<li class="chapter" data-level="6.6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#sales-force-composite"><i class="fa fa-check"></i><b>6.6.1</b> Sales force composite</a></li>
<li class="chapter" data-level="6.6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#executive-opinion"><i class="fa fa-check"></i><b>6.6.2</b> Executive opinion</a></li>
<li class="chapter" data-level="6.6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#customer-intentions"><i class="fa fa-check"></i><b>6.6.3</b> Customer intentions</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a><ul>
<li class="chapter" data-level="6.7.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#use-adjustments-sparingly"><i class="fa fa-check"></i><b>6.7.1</b> Use adjustments sparingly</a></li>
<li class="chapter" data-level="6.7.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#apply-a-structured-approach"><i class="fa fa-check"></i><b>6.7.2</b> Apply a structured approach</a></li>
<li class="chapter" data-level="6.7.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#example-tourism-forecasting-committee-tfc"><i class="fa fa-check"></i><b>6.7.3</b> Example: Tourism Forecasting Committee (TFC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a><ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a><ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness of fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-a-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating a regression model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.1</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.2</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.3</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-performance-package"><i class="fa fa-check"></i><b>7.3.4</b> The <code>performance</code> package</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.5</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>7.4.3</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
<li class="chapter" data-level="7.4.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#easter"><i class="fa fa-check"></i><b>7.4.7</b> Easter</a></li>
<li class="chapter" data-level="7.4.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fourier-sereis"><i class="fa fa-check"></i><b>7.4.8</b> Fourier sereis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a><ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusst-r-square"><i class="fa fa-check"></i><b>7.5.1</b> Adjusst R square</a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#which-measure-should-we-suse"><i class="fa fa-check"></i><b>7.5.5</b> Which measure should we suse</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-us-consumption"><i class="fa fa-check"></i><b>7.5.6</b> Example: US consumption</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#ex-ante-versus-ex-post-forecasts"><i class="fa fa-check"></i><b>7.6.1</b> Ex-ante versus ex-post forecasts</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-australian-quarterly-beer-production-1"><i class="fa fa-check"></i><b>7.6.2</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.6.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.3</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>7.6.4</b> Prediction intervals</a></li>
<li class="chapter" data-level="7.6.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#building-a-predictive-regression-model"><i class="fa fa-check"></i><b>7.6.5</b> Building a predictive regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#matrix-formulation"><i class="fa fa-check"></i><b>7.7</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.8</b> Nonlinear regression</a><ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.8.1</b> Forecasting with a nonlinear trend</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-boston-marathon-winning-times"><i class="fa fa-check"></i><b>7.8.2</b> Example: Boston marathon winning times</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.9</b> Correlation, causation and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a><ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a><ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>8.1.4</b> Estimation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend-and-seasonality"><i class="fa fa-check"></i><b>8.2</b> Methods with trend and seasonality</a><ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population"><i class="fa fa-check"></i><b>8.2.2</b> Example: Australian population</a></li>
<li class="chapter" data-level="8.2.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.3</b> Damped trend methods</a></li>
<li class="chapter" data-level="8.2.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population-continued"><i class="fa fa-check"></i><b>8.2.4</b> Example: Australian Population (continued)</a></li>
<li class="chapter" data-level="8.2.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-internet-usage"><i class="fa fa-check"></i><b>8.2.5</b> Example: Internet usage</a></li>
<li class="chapter" data-level="8.2.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.2.6</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.2.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.2.7</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.2.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.2.8</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.2.9" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.2.9</b> Holt-Winters’ damped method</a></li>
<li class="chapter" data-level="8.2.10" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-holt-winters-method-with-daily-data"><i class="fa fa-check"></i><b>8.2.10</b> Example: Holt-Winters method with daily data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.3</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.4</b> Innovations state space models for exponential smoothing</a><ul>
<li class="chapter" data-level="8.4.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-simple-exponential-smoothing-with-additive-errors"><i class="fa fa-check"></i><b>8.4.1</b> ETS(A,N,N): simple exponential smoothing with additive errors</a></li>
<li class="chapter" data-level="8.4.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmnn-simple-exponential-smoothing-with-multiplicative-errors"><i class="fa fa-check"></i><b>8.4.2</b> ETS(M,N,N): simple exponential smoothing with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan-holts-linear-method-with-additive-errors"><i class="fa fa-check"></i><b>8.4.3</b> ETS(A,A,N): Holt’s linear method with additive errors</a></li>
<li class="chapter" data-level="8.4.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#ets-man"><i class="fa fa-check"></i><b>8.4.4</b> ETS(M,A,N): Holt’s linear method with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#other-ets-models"><i class="fa fa-check"></i><b>8.4.5</b> Other ETS models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.5</b> Estimation and model selection</a><ul>
<li class="chapter" data-level="8.5.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimating-ets-models"><i class="fa fa-check"></i><b>8.5.1</b> Estimating ETS models</a></li>
<li class="chapter" data-level="8.5.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection-criteria"><i class="fa fa-check"></i><b>8.5.2</b> Model selection criteria</a></li>
<li class="chapter" data-level="8.5.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.5.3</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.6</b> Forecasting with ETS models</a><ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australia-gas-production"><i class="fa fa-check"></i><b>8.6.1</b> Example: Australia gas production</a></li>
<li class="chapter" data-level="8.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>8.6.2</b> Prediction intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html"><i class="fa fa-check"></i><b>9</b> Univariate stationary processes</a><ul>
<li class="chapter" data-level="9.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#stationarity"><i class="fa fa-check"></i><b>9.1</b> Stationarity</a><ul>
<li class="chapter" data-level="9.1.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#ch9-white-noise"><i class="fa fa-check"></i><b>9.1.1</b> White noise</a></li>
<li class="chapter" data-level="9.1.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#tests-for-autocorrelation-and-normality"><i class="fa fa-check"></i><b>9.1.2</b> Tests for autocorrelation and normality</a></li>
<li class="chapter" data-level="9.1.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#the-wold-decomposition"><i class="fa fa-check"></i><b>9.1.3</b> The Wold Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#autoregressive-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a><ul>
<li class="chapter" data-level="9.3.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#stimulating-an-arp-process"><i class="fa fa-check"></i><b>9.3.1</b> Stimulating an AR(p) process</a></li>
<li class="chapter" data-level="9.3.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#decision-of-order-p"><i class="fa fa-check"></i><b>9.3.2</b> Decision of order p</a></li>
<li class="chapter" data-level="9.3.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#random-walk"><i class="fa fa-check"></i><b>9.3.3</b> Random walk</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#simulating-an-maq-process"><i class="fa fa-check"></i><b>9.4.1</b> Simulating an MA(q) process</a></li>
<li class="chapter" data-level="9.4.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#decision-of-order-q"><i class="fa fa-check"></i><b>9.4.2</b> Decision of order q</a></li>
<li class="chapter" data-level="9.4.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#koyck-transformation-and-invertibility"><i class="fa fa-check"></i><b>9.4.3</b> Koyck transformation and Invertibility</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#arma-models"><i class="fa fa-check"></i><b>9.5</b> ARMA models</a><ul>
<li class="chapter" data-level="9.5.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#three-representations-of-an-arma-model"><i class="fa fa-check"></i><b>9.5.1</b> Three representations of an ARMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>10</b> ARIMA models</a><ul>
<li class="chapter" data-level="10.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>10.1</b> Differencing</a><ul>
<li class="chapter" data-level="10.1.1" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>10.1.1</b> Second-order differencing</a></li>
<li class="chapter" data-level="10.1.2" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>10.1.2</b> Seasonal differencing</a></li>
<li class="chapter" data-level="10.1.3" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>10.1.3</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>10.2</b> Non-seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.2.1" data-path="arima-models.html"><a href="arima-models.html#understanding-arima-models"><i class="fa fa-check"></i><b>10.2.1</b> Understanding ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>10.3</b> Estimation and order selection</a><ul>
<li class="chapter" data-level="10.3.1" data-path="arima-models.html"><a href="arima-models.html#mle"><i class="fa fa-check"></i><b>10.3.1</b> MLE</a></li>
<li class="chapter" data-level="10.3.2" data-path="arima-models.html"><a href="arima-models.html#information-criteria"><i class="fa fa-check"></i><b>10.3.2</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="arima-models.html"><a href="arima-models.html#the-arima-function"><i class="fa fa-check"></i><b>10.4</b> The <code>ARIMA()</code> function</a><ul>
<li class="chapter" data-level="10.4.1" data-path="arima-models.html"><a href="arima-models.html#algorithm"><i class="fa fa-check"></i><b>10.4.1</b> Algorithm</a></li>
<li class="chapter" data-level="10.4.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>10.4.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="10.4.3" data-path="arima-models.html"><a href="arima-models.html#example-seasonally-adjusted-electrical-equipment-orders"><i class="fa fa-check"></i><b>10.4.3</b> Example: Seasonally adjusted electrical equipment orders</a></li>
<li class="chapter" data-level="10.4.4" data-path="arima-models.html"><a href="arima-models.html#plotting-the-characteristic-roots"><i class="fa fa-check"></i><b>10.4.4</b> Plotting the characteristic roots</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="arima-models.html"><a href="arima-models.html#forecasting-with-arima-models"><i class="fa fa-check"></i><b>10.5</b> Forecasting with ARIMA models</a><ul>
<li class="chapter" data-level="10.5.1" data-path="arima-models.html"><a href="arima-models.html#point-forecasts"><i class="fa fa-check"></i><b>10.5.1</b> Point forecasts</a></li>
<li class="chapter" data-level="10.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>10.5.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>10.6</b> Seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.6.1" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf"><i class="fa fa-check"></i><b>10.6.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="10.6.2" data-path="arima-models.html"><a href="arima-models.html#example-european-quarterly-retail-trade"><i class="fa fa-check"></i><b>10.6.2</b> Example: European quarterly retail trade</a></li>
<li class="chapter" data-level="10.6.3" data-path="arima-models.html"><a href="arima-models.html#example-corticosteroid-drug-sales-in-australia"><i class="fa fa-check"></i><b>10.6.3</b> Example: Corticosteroid drug sales in Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="arima-models.html"><a href="arima-models.html#ets-and-arima"><i class="fa fa-check"></i><b>10.7</b> ETS and ARIMA</a><ul>
<li class="chapter" data-level="10.7.1" data-path="arima-models.html"><a href="arima-models.html#example-comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>10.7.1</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="10.7.2" data-path="arima-models.html"><a href="arima-models.html#example-comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>10.7.2</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>11</b> Dynamic regression models</a><ul>
<li class="chapter" data-level="11.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>11.1</b> Estimation</a></li>
<li class="chapter" data-level="11.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors"><i class="fa fa-check"></i><b>11.2</b> Regression with ARIMA errors</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>11.2.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting"><i class="fa fa-check"></i><b>11.3</b> Forecasting</a><ul>
<li class="chapter" data-level="11.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>11.3.1</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#deterministic-and-stochastic-trends"><i class="fa fa-check"></i><b>11.4</b> Deterministic and stochastic trends</a><ul>
<li class="chapter" data-level="11.4.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-international-visitors-to-australia"><i class="fa fa-check"></i><b>11.4.1</b> Example: International visitors to Australia</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>11.5</b> Dynamic harmonic regression</a><ul>
<li class="chapter" data-level="11.5.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>11.5.1</b> Example: Australian eating out expenditure</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>11.6</b> Lagged predictors</a><ul>
<li class="chapter" data-level="11.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>11.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for “Forecasting: Principles and Practice, 3rd edition”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-forecasters-toolbox" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> The forecaster’s toolbox</h1>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="the-forecasters-toolbox.html#cb67-1"></a><span class="kw">library</span>(tsibble)</span>
<span id="cb67-2"><a href="the-forecasters-toolbox.html#cb67-2"></a><span class="kw">library</span>(tsibbledata)</span>
<span id="cb67-3"><a href="the-forecasters-toolbox.html#cb67-3"></a><span class="kw">library</span>(fable)</span>
<span id="cb67-4"><a href="the-forecasters-toolbox.html#cb67-4"></a><span class="kw">library</span>(feasts)</span>
<span id="cb67-5"><a href="the-forecasters-toolbox.html#cb67-5"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb67-6"><a href="the-forecasters-toolbox.html#cb67-6"></a><span class="kw">library</span>(patchwork)</span></code></pre></div>
<div id="a-tidy-forecasting-workflow" class="section level2">
<h2><span class="header-section-number">5.1</span> A tidy forecasting workflow</h2>
<p><img src="images/workflow.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="data-preparation-tidy" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Data preparation (tidy)</h3>
<p>Simplified by <code>tidyverse</code> and <code>tsibble</code></p>
</div>
<div id="visualize" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Visualize</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="the-forecasters-toolbox.html#cb68-1"></a>global_economy <span class="op">%&gt;%</span></span>
<span id="cb68-2"><a href="the-forecasters-toolbox.html#cb68-2"></a><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb68-3"><a href="the-forecasters-toolbox.html#cb68-3"></a><span class="st">  </span><span class="kw">autoplot</span>(GDP) <span class="op">+</span></span>
<span id="cb68-4"><a href="the-forecasters-toolbox.html#cb68-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_number_si</span>()) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-5"><a href="the-forecasters-toolbox.html#cb68-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;GDP for Sweden&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;$US billions&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="define-a-model-specify" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Define a model (specify)</h3>
<p>A model defination</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="the-forecasters-toolbox.html#cb69-1"></a><span class="kw">TSLM</span>(GDP <span class="op">~</span><span class="st"> </span><span class="kw">trend</span>())</span>
<span id="cb69-2"><a href="the-forecasters-toolbox.html#cb69-2"></a><span class="co">#&gt; &lt;TSLM model definition&gt;</span></span></code></pre></div>
<p><code>TSLM()</code> specifies a time series linear model, discussed more in <a href="time-series-regression-models.html#time-series-regression-models">7</a>.</p>
<p>Similar to <code>tidymodels</code> where we specify a linear model for regression:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="the-forecasters-toolbox.html#cb70-1"></a><span class="kw">library</span>(parsnip)</span>
<span id="cb70-2"><a href="the-forecasters-toolbox.html#cb70-2"></a><span class="kw">linear_reg</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-3"><a href="the-forecasters-toolbox.html#cb70-3"></a><span class="st">  </span><span class="kw">set_engine</span>(<span class="st">&quot;lm&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb70-4"><a href="the-forecasters-toolbox.html#cb70-4"></a><span class="st">  </span><span class="kw">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb70-5"><a href="the-forecasters-toolbox.html#cb70-5"></a><span class="co">#&gt; Linear Regression Model Specification (regression)</span></span>
<span id="cb70-6"><a href="the-forecasters-toolbox.html#cb70-6"></a><span class="co">#&gt; </span></span>
<span id="cb70-7"><a href="the-forecasters-toolbox.html#cb70-7"></a><span class="co">#&gt; Computational engine: lm</span></span></code></pre></div>
</div>
<div id="train-the-model-estimate" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Train the model (estimate)</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="the-forecasters-toolbox.html#cb71-1"></a>ge_fit &lt;-<span class="st"> </span>global_economy <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb71-2"><a href="the-forecasters-toolbox.html#cb71-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="dt">trend_model =</span> <span class="kw">TSLM</span>(GDP <span class="op">~</span><span class="st"> </span><span class="kw">trend</span>()))</span>
<span id="cb71-3"><a href="the-forecasters-toolbox.html#cb71-3"></a></span>
<span id="cb71-4"><a href="the-forecasters-toolbox.html#cb71-4"></a>ge_fit</span>
<span id="cb71-5"><a href="the-forecasters-toolbox.html#cb71-5"></a><span class="co">#&gt; # A mable: 263 x 2</span></span>
<span id="cb71-6"><a href="the-forecasters-toolbox.html#cb71-6"></a><span class="co">#&gt; # Key:     Country [263]</span></span>
<span id="cb71-7"><a href="the-forecasters-toolbox.html#cb71-7"></a><span class="co">#&gt;   Country        trend_model</span></span>
<span id="cb71-8"><a href="the-forecasters-toolbox.html#cb71-8"></a><span class="co">#&gt;   &lt;fct&gt;              &lt;model&gt;</span></span>
<span id="cb71-9"><a href="the-forecasters-toolbox.html#cb71-9"></a><span class="co">#&gt; 1 Afghanistan         &lt;TSLM&gt;</span></span>
<span id="cb71-10"><a href="the-forecasters-toolbox.html#cb71-10"></a><span class="co">#&gt; 2 Albania             &lt;TSLM&gt;</span></span>
<span id="cb71-11"><a href="the-forecasters-toolbox.html#cb71-11"></a><span class="co">#&gt; 3 Algeria             &lt;TSLM&gt;</span></span>
<span id="cb71-12"><a href="the-forecasters-toolbox.html#cb71-12"></a><span class="co">#&gt; 4 American Samoa      &lt;TSLM&gt;</span></span>
<span id="cb71-13"><a href="the-forecasters-toolbox.html#cb71-13"></a><span class="co">#&gt; 5 Andorra             &lt;TSLM&gt;</span></span>
<span id="cb71-14"><a href="the-forecasters-toolbox.html#cb71-14"></a><span class="co">#&gt; 6 Angola              &lt;TSLM&gt;</span></span>
<span id="cb71-15"><a href="the-forecasters-toolbox.html#cb71-15"></a><span class="co">#&gt; # ... with 257 more rows</span></span></code></pre></div>
</div>
<div id="check-model-performance-evaluate" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Check model performance (evaluate)</h3>
<p>More discussed in <a href="the-forecasters-toolbox.html#evaluating-model-accuracy">5.6</a></p>
</div>
<div id="produce-forecasts-forecast" class="section level3">
<h3><span class="header-section-number">5.1.6</span> Produce forecasts (forecast)</h3>
<p><code>forecast()</code> similar to <code>predict()</code>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="the-forecasters-toolbox.html#cb72-1"></a>ge_forecast &lt;-<span class="st"> </span>ge_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-2"><a href="the-forecasters-toolbox.html#cb72-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;3 years&quot;</span>) <span class="co"># h means horizon</span></span>
<span id="cb72-3"><a href="the-forecasters-toolbox.html#cb72-3"></a></span>
<span id="cb72-4"><a href="the-forecasters-toolbox.html#cb72-4"></a>ge_forecast</span>
<span id="cb72-5"><a href="the-forecasters-toolbox.html#cb72-5"></a><span class="co">#&gt; # A fable: 789 x 5 [1Y]</span></span>
<span id="cb72-6"><a href="the-forecasters-toolbox.html#cb72-6"></a><span class="co">#&gt; # Key:     Country, .model [263]</span></span>
<span id="cb72-7"><a href="the-forecasters-toolbox.html#cb72-7"></a><span class="co">#&gt;   Country     .model       Year                                  GDP       .mean</span></span>
<span id="cb72-8"><a href="the-forecasters-toolbox.html#cb72-8"></a><span class="co">#&gt;   &lt;fct&gt;       &lt;chr&gt;       &lt;dbl&gt;                               &lt;dist&gt;       &lt;dbl&gt;</span></span>
<span id="cb72-9"><a href="the-forecasters-toolbox.html#cb72-9"></a><span class="co">#&gt; 1 Afghanistan trend_model  2018 N(16205101654, 12655976452653815808)     1.62e10</span></span>
<span id="cb72-10"><a href="the-forecasters-toolbox.html#cb72-10"></a><span class="co">#&gt; 2 Afghanistan trend_model  2019 N(16511878141, 12703887023155042304)     1.65e10</span></span>
<span id="cb72-11"><a href="the-forecasters-toolbox.html#cb72-11"></a><span class="co">#&gt; 3 Afghanistan trend_model  2020 N(16818654627, 12753314761722146816)     1.68e10</span></span>
<span id="cb72-12"><a href="the-forecasters-toolbox.html#cb72-12"></a><span class="co">#&gt; 4 Albania     trend_model  2018  N(13733734164, 3853726871001717248)     1.37e10</span></span>
<span id="cb72-13"><a href="the-forecasters-toolbox.html#cb72-13"></a><span class="co">#&gt; 5 Albania     trend_model  2019  N(14166852711, 3891477664840101376)     1.42e10</span></span>
<span id="cb72-14"><a href="the-forecasters-toolbox.html#cb72-14"></a><span class="co">#&gt; 6 Albania     trend_model  2020  N(14599971258, 3931325725002840064)     1.46e10</span></span>
<span id="cb72-15"><a href="the-forecasters-toolbox.html#cb72-15"></a><span class="co">#&gt; # ... with 783 more rows</span></span></code></pre></div>
<p>Here ourl trend model consists of only a trend variable <span class="math inline">\({1, 2, \dots, T}\)</span>, which can be known in advance when producing forecasts. In this case <code>forecast()</code> only needs <code>h</code> for a forecast horizon. There are also cases when we need to specify the <code>new_data</code> argument, which will be a <code>tsibble</code> containing future information used to forecast.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="the-forecasters-toolbox.html#cb73-1"></a>ge_forecast <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb73-2"><a href="the-forecasters-toolbox.html#cb73-2"></a><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;Sweden&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb73-3"><a href="the-forecasters-toolbox.html#cb73-3"></a><span class="st">  </span><span class="kw">autoplot</span>(global_economy) <span class="op">+</span><span class="st"> </span></span>
<span id="cb73-4"><a href="the-forecasters-toolbox.html#cb73-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span><span class="kw">label_number_si</span>()) <span class="op">+</span><span class="st"> </span></span>
<span id="cb73-5"><a href="the-forecasters-toolbox.html#cb73-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;GDP for Sweden&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="some-simple-forecasting-methods" class="section level2">
<h2><span class="header-section-number">5.2</span> Some simple forecasting methods</h2>
<p>Some forecasting methods are extremely simple and surprisingly effective. We will use four simple forecasting methods as benchmarks throughout this book.</p>
<p>To illustrate them, we will use quarterly Australian clay brick production between 1970 and 2004.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="the-forecasters-toolbox.html#cb74-1"></a>bricks &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter_index</span>(<span class="st">&quot;1970&quot;</span> <span class="op">~</span><span class="st"> &quot;2004&quot;</span>)</span>
<span id="cb74-2"><a href="the-forecasters-toolbox.html#cb74-2"></a>bricks</span>
<span id="cb74-3"><a href="the-forecasters-toolbox.html#cb74-3"></a><span class="co">#&gt; # A tsibble: 137 x 7 [1Q]</span></span>
<span id="cb74-4"><a href="the-forecasters-toolbox.html#cb74-4"></a><span class="co">#&gt;   Quarter  Beer Tobacco Bricks Cement Electricity   Gas</span></span>
<span id="cb74-5"><a href="the-forecasters-toolbox.html#cb74-5"></a><span class="co">#&gt;     &lt;qtr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb74-6"><a href="the-forecasters-toolbox.html#cb74-6"></a><span class="co">#&gt; 1 1970 Q1   387    6807    386   1049       12328    12</span></span>
<span id="cb74-7"><a href="the-forecasters-toolbox.html#cb74-7"></a><span class="co">#&gt; 2 1970 Q2   357    7612    428   1134       14493    18</span></span>
<span id="cb74-8"><a href="the-forecasters-toolbox.html#cb74-8"></a><span class="co">#&gt; 3 1970 Q3   374    7862    434   1229       15664    23</span></span>
<span id="cb74-9"><a href="the-forecasters-toolbox.html#cb74-9"></a><span class="co">#&gt; 4 1970 Q4   466    7126    417   1188       13781    20</span></span>
<span id="cb74-10"><a href="the-forecasters-toolbox.html#cb74-10"></a><span class="co">#&gt; 5 1971 Q1   410    7255    385   1058       13299    19</span></span>
<span id="cb74-11"><a href="the-forecasters-toolbox.html#cb74-11"></a><span class="co">#&gt; 6 1971 Q2   370    8076    433   1209       15230    23</span></span>
<span id="cb74-12"><a href="the-forecasters-toolbox.html#cb74-12"></a><span class="co">#&gt; # ... with 131 more rows</span></span></code></pre></div>
<div id="mean-method" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Mean method</h3>
<p>Here, the forecasts of <strong>all future values</strong> are equal to the <strong>average</strong> (or “mean”) of the historical data. If we let the historical data be denoted by <span class="math inline">\(y_1,…,y_T\)</span>, then we can write the forecasts as</p>
<p><span class="math display">\[
\hat{y}_{T+H | T} = \frac{1}{T}\sum_{1}^{T}{y_t}
\]</span></p>
<p><code>MEAN()</code> specifies an average model:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="the-forecasters-toolbox.html#cb75-1"></a>bricks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-2"><a href="the-forecasters-toolbox.html#cb75-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">MEAN</span>(Bricks)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-3"><a href="the-forecasters-toolbox.html#cb75-3"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-4"><a href="the-forecasters-toolbox.html#cb75-4"></a><span class="st">  </span><span class="kw">autoplot</span>(bricks)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="naive-method" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Naive method</h3>
<p>For naive forecasts, we simply set <strong>all forecasts</strong> to be the value of the <strong>last observation</strong>. That is,</p>
<p><span class="math display">\[
\hat{y}_{T+H | T} = y_T
\]</span></p>
<p>This method works remarkably well for many economic and financial time series.</p>
<p>Because a naive forecast is optimal when data follow a random walk (see Section <a href="univariate-stationary-processes.html#stationarity">9.1</a>), these are also called <strong>random walk</strong> forecasts.</p>
<p><code>NAIVE()</code> specifies a naive model:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="the-forecasters-toolbox.html#cb76-1"></a>bricks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-2"><a href="the-forecasters-toolbox.html#cb76-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">NAIVE</span>(Bricks)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-3"><a href="the-forecasters-toolbox.html#cb76-3"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-4"><a href="the-forecasters-toolbox.html#cb76-4"></a><span class="st">  </span><span class="kw">autoplot</span>(bricks)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="seasonal-naive-method" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Seasonal naive method</h3>
<p>Seasonal naïve method</p>
<p>A similar method is useful for highly seasonal data. In this case, we set each forecast to be equal to the last observed value from the same season of the year (e.g., the same month of the previous year). Formally, the forecast for time <span class="math inline">\(T+h\)</span> is written as</p>
<p><span class="math display">\[
\hat{y}_{T+H | T} = y_{T + H - m(k + 1)}
\]</span></p>
<p>where <span class="math inline">\(m\)</span> is for seaonsal period (e.g., 12 for monthly data, 4 for quarterly data), and <span class="math inline">\(k\)</span> is the interger part of <span class="math inline">\((h - 1) / m\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="the-forecasters-toolbox.html#cb77-1"></a>bricks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-2"><a href="the-forecasters-toolbox.html#cb77-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">SNAIVE</span>(Bricks <span class="op">~</span><span class="st"> </span><span class="kw">lag</span>(<span class="st">&quot;year&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-3"><a href="the-forecasters-toolbox.html#cb77-3"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-4"><a href="the-forecasters-toolbox.html#cb77-4"></a><span class="st">  </span><span class="kw">autoplot</span>(bricks, <span class="dt">level =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The <code>lag()</code> function is optional here as bricks is monthly data and so a seasonal naïve model will need a one-year lag. However, for some time series there is more than one seasonal period, and then the required lag must be specified.</p>
</div>
<div id="drift-method" class="section level3">
<h3><span class="header-section-number">5.2.4</span> Drift method</h3>
<p>A variation on the naive method is to allow the forecasts to increase or decrease over time, where the amount of change over time (called the <strong>drift</strong>, which is the slope of the line between the first and last obeservation) is set to be the average change seen in the historical data. Thus the forecast for time T+h is given by:</p>
<p><span class="math display">\[
y_{T+h} - y_{T} = \frac{y_{T} - y_1}{T - 1}[(T + h) - T) 
\]</span></p>
<p><span class="math display">\[
y_{T+h} = y_T + h(\frac{y_{T} - y_1}{T - 1})
\]</span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="the-forecasters-toolbox.html#cb78-1"></a>bricks <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-2"><a href="the-forecasters-toolbox.html#cb78-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">NAIVE</span>(Bricks <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())) <span class="op">%&gt;%</span></span>
<span id="cb78-3"><a href="the-forecasters-toolbox.html#cb78-3"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;10 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-4"><a href="the-forecasters-toolbox.html#cb78-4"></a><span class="st">  </span><span class="kw">autoplot</span>(bricks, <span class="dt">level =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="australian-quarterly-beer-production" class="section level3">
<h3><span class="header-section-number">5.2.5</span> Australian quarterly beer production</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="the-forecasters-toolbox.html#cb79-1"></a>beer_fit &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-2"><a href="the-forecasters-toolbox.html#cb79-2"></a><span class="st">  </span><span class="kw">filter_index</span>(<span class="st">&quot;1992 Q1&quot;</span> <span class="op">~</span><span class="st"> &quot;2006 Q4&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-3"><a href="the-forecasters-toolbox.html#cb79-3"></a><span class="st">  </span><span class="kw">model</span>(<span class="dt">Mean =</span> <span class="kw">MEAN</span>(Beer),</span>
<span id="cb79-4"><a href="the-forecasters-toolbox.html#cb79-4"></a>        <span class="dt">naive =</span> <span class="kw">NAIVE</span>(Beer),</span>
<span id="cb79-5"><a href="the-forecasters-toolbox.html#cb79-5"></a>        <span class="dt">seasonal_naive =</span> <span class="kw">SNAIVE</span>(Beer))</span>
<span id="cb79-6"><a href="the-forecasters-toolbox.html#cb79-6"></a></span>
<span id="cb79-7"><a href="the-forecasters-toolbox.html#cb79-7"></a>beer_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb79-8"><a href="the-forecasters-toolbox.html#cb79-8"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">14</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># 14 quarters</span></span>
<span id="cb79-9"><a href="the-forecasters-toolbox.html#cb79-9"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_production <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter_index</span>(<span class="st">&quot;1992 Q1&quot;</span> <span class="op">~</span><span class="st"> &quot;2006 Q4&quot;</span>), <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb79-10"><a href="the-forecasters-toolbox.html#cb79-10"></a><span class="st">  </span><span class="kw">autolayer</span>(aus_production <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter_index</span>(<span class="st">&quot;2007 Q1&quot;</span> <span class="op">~</span><span class="st"> </span>.), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>In this case, only the seasonal naïve forecasts are close to the observed values from 2007 onwards.</p>
</div>
<div id="example-googles-daily-closing-stock-price" class="section level3">
<h3><span class="header-section-number">5.2.6</span> Example: Google’s daily closing stock price</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="the-forecasters-toolbox.html#cb80-1"></a><span class="co"># Re-index based on trading days</span></span>
<span id="cb80-2"><a href="the-forecasters-toolbox.html#cb80-2"></a>google_stock &lt;-<span class="st"> </span>gafa_stock <span class="op">%&gt;%</span></span>
<span id="cb80-3"><a href="the-forecasters-toolbox.html#cb80-3"></a><span class="st">  </span><span class="kw">filter</span>(Symbol <span class="op">==</span><span class="st"> &quot;GOOG&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb80-4"><a href="the-forecasters-toolbox.html#cb80-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">day =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span></span>
<span id="cb80-5"><a href="the-forecasters-toolbox.html#cb80-5"></a><span class="st">  </span><span class="kw">update_tsibble</span>(<span class="dt">index =</span> day, <span class="dt">regular =</span> <span class="ot">TRUE</span>)</span>
<span id="cb80-6"><a href="the-forecasters-toolbox.html#cb80-6"></a><span class="co"># Filter the year of interest</span></span>
<span id="cb80-7"><a href="the-forecasters-toolbox.html#cb80-7"></a>google_<span class="dv">2015</span> &lt;-<span class="st"> </span>google_stock <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-8"><a href="the-forecasters-toolbox.html#cb80-8"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">year</span>(Date) <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>)</span>
<span id="cb80-9"><a href="the-forecasters-toolbox.html#cb80-9"></a><span class="co"># Fit the models</span></span>
<span id="cb80-10"><a href="the-forecasters-toolbox.html#cb80-10"></a>google_fit &lt;-<span class="st"> </span>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb80-11"><a href="the-forecasters-toolbox.html#cb80-11"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb80-12"><a href="the-forecasters-toolbox.html#cb80-12"></a>    <span class="dt">Mean =</span> <span class="kw">MEAN</span>(Close),</span>
<span id="cb80-13"><a href="the-forecasters-toolbox.html#cb80-13"></a>    <span class="dt">naive =</span> <span class="kw">NAIVE</span>(Close),</span>
<span id="cb80-14"><a href="the-forecasters-toolbox.html#cb80-14"></a>    <span class="dt">drift =</span> <span class="kw">NAIVE</span>(Close <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())</span>
<span id="cb80-15"><a href="the-forecasters-toolbox.html#cb80-15"></a>  )</span>
<span id="cb80-16"><a href="the-forecasters-toolbox.html#cb80-16"></a></span>
<span id="cb80-17"><a href="the-forecasters-toolbox.html#cb80-17"></a><span class="co"># Produce forecasts for the 19 trading days in January 2015</span></span>
<span id="cb80-18"><a href="the-forecasters-toolbox.html#cb80-18"></a>google_fc &lt;-<span class="st"> </span>google_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">19</span>)</span>
<span id="cb80-19"><a href="the-forecasters-toolbox.html#cb80-19"></a><span class="co"># A better way using a tsibble to determine the forecast horizons</span></span>
<span id="cb80-20"><a href="the-forecasters-toolbox.html#cb80-20"></a>google_jan_<span class="dv">2016</span> &lt;-<span class="st"> </span>google_stock <span class="op">%&gt;%</span></span>
<span id="cb80-21"><a href="the-forecasters-toolbox.html#cb80-21"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">yearmonth</span>(Date) <span class="op">==</span><span class="st"> </span><span class="kw">yearmonth</span>(<span class="st">&quot;2016 Jan&quot;</span>))</span>
<span id="cb80-22"><a href="the-forecasters-toolbox.html#cb80-22"></a>google_fc &lt;-<span class="st"> </span>google_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(google_jan_<span class="dv">2016</span>)</span>
<span id="cb80-23"><a href="the-forecasters-toolbox.html#cb80-23"></a></span>
<span id="cb80-24"><a href="the-forecasters-toolbox.html#cb80-24"></a><span class="co"># Plot the forecasts</span></span>
<span id="cb80-25"><a href="the-forecasters-toolbox.html#cb80-25"></a>google_fc <span class="op">%&gt;%</span></span>
<span id="cb80-26"><a href="the-forecasters-toolbox.html#cb80-26"></a><span class="st">  </span><span class="kw">autoplot</span>(google_<span class="dv">2015</span>, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb80-27"><a href="the-forecasters-toolbox.html#cb80-27"></a><span class="st">    </span><span class="kw">autolayer</span>(google_jan_<span class="dv">2016</span>, Close, <span class="dt">color=</span><span class="st">&#39;black&#39;</span>) <span class="op">+</span></span>
<span id="cb80-28"><a href="the-forecasters-toolbox.html#cb80-28"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Google stock (daily ending 31 Dec 2015)&quot;</span>) <span class="op">+</span></span>
<span id="cb80-29"><a href="the-forecasters-toolbox.html#cb80-29"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Day&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Closing Price (US$)&quot;</span>) <span class="op">+</span></span>
<span id="cb80-30"><a href="the-forecasters-toolbox.html#cb80-30"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Forecast&quot;</span>))</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" />
Sometimes one of these simple methods will be the best forecasting method available; but in many cases, <strong>these methods will serve as benchmarks rather than the method of choice</strong>. That is, any forecasting methods we develop will be compared to these simple methods to ensure that the new method is better than these simple alternatives. If not, the new method is not worth considering.</p>
</div>
</div>
<div id="fitted-values-and-residuals" class="section level2">
<h2><span class="header-section-number">5.3</span> Fitted values and residuals</h2>
<p>Each observation in a time series can be forecast using all previous observations. We call these <strong>fitted values</strong> and they are denoted by <span class="math inline">\(\hat{y}_{t|t−1}\)</span>, meaning the forecast of yt based on observations <span class="math inline">\(y_1,\dots,y_t−1\)</span> . We use these so often, we sometimes drop part of the subscript and just write <span class="math inline">\(\hat{y}_t\)</span> instead of <span class="math inline">\(\hat{y}_{t|t−1}\)</span>. Fitted values always involve one-step forecasts.</p>
<p>Actually, fitted values are often not true forecasts because any parameters involved in the forecasting method are estimated using all available observations in the time series, including future observations. For example, if we use the average method, the fitted values are given by</p>
<p><span class="math display">\[
\hat{y}_t= \hat{c} 
\]</span>
where <span class="math inline">\(\hat{c} = \frac{1}{T}\sum_{t = 1}^{T}y_t\)</span>, meaning that it is computed across <strong>all available observations</strong>, including those at times after <span class="math inline">\(t\)</span>.</p>
<p>Similarly, for the drift method, the drift parameter is estimated using all available observations. In this case, the fitted values are given by</p>
<p><span class="math display">\[
\hat{y}_t = y_{t-1} + \hat{c} 
\]</span>
where <span class="math inline">\(\hat{c} = \frac{y_T - y_1}{T-1}\)</span>, the “overall slope”.</p>
<p>In both cases, there is a parameter to be estimated from the data. The “hat <span class="math inline">\(\hat{}\)</span>” above the <span class="math inline">\(c\)</span> reminds us that this is an estimate. <strong>When the estimate of <span class="math inline">\(c\)</span> involves observations after time <span class="math inline">\(t\)</span>, the fitted values are not true forecasts.</strong> On the other hand, naïve or seasonal naïve forecasts do not involve any parameters, and so fitted values are true forecasts in such cases.</p>
<div id="residuals" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Residuals</h3>
<p><span class="math display">\[
e_t = y_t - \hat{y}_t
\]</span></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="the-forecasters-toolbox.html#cb81-1"></a><span class="kw">augment</span>(beer_fit)</span>
<span id="cb81-2"><a href="the-forecasters-toolbox.html#cb81-2"></a><span class="co">#&gt; # A tsibble: 180 x 6 [1Q]</span></span>
<span id="cb81-3"><a href="the-forecasters-toolbox.html#cb81-3"></a><span class="co">#&gt; # Key:       .model [3]</span></span>
<span id="cb81-4"><a href="the-forecasters-toolbox.html#cb81-4"></a><span class="co">#&gt;   .model Quarter  Beer .fitted .resid .innov</span></span>
<span id="cb81-5"><a href="the-forecasters-toolbox.html#cb81-5"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;qtr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb81-6"><a href="the-forecasters-toolbox.html#cb81-6"></a><span class="co">#&gt; 1 Mean   1992 Q1   443    436.   6.55   6.55</span></span>
<span id="cb81-7"><a href="the-forecasters-toolbox.html#cb81-7"></a><span class="co">#&gt; 2 Mean   1992 Q2   410    436. -26.4  -26.4 </span></span>
<span id="cb81-8"><a href="the-forecasters-toolbox.html#cb81-8"></a><span class="co">#&gt; 3 Mean   1992 Q3   420    436. -16.4  -16.4 </span></span>
<span id="cb81-9"><a href="the-forecasters-toolbox.html#cb81-9"></a><span class="co">#&gt; 4 Mean   1992 Q4   532    436.  95.6   95.6 </span></span>
<span id="cb81-10"><a href="the-forecasters-toolbox.html#cb81-10"></a><span class="co">#&gt; 5 Mean   1993 Q1   433    436.  -3.45  -3.45</span></span>
<span id="cb81-11"><a href="the-forecasters-toolbox.html#cb81-11"></a><span class="co">#&gt; 6 Mean   1993 Q2   421    436. -15.4  -15.4 </span></span>
<span id="cb81-12"><a href="the-forecasters-toolbox.html#cb81-12"></a><span class="co">#&gt; # ... with 174 more rows</span></span></code></pre></div>
</div>
</div>
<div id="residual-diagnostics" class="section level2">
<h2><span class="header-section-number">5.4</span> Residual diagnostics</h2>
<p>A good forecasting method will yield residuals with the following properties:</p>
<ol style="list-style-type: decimal">
<li>The residuals are <strong>uncorrelated.</strong> If there are correlations between residuals, then there is information left in the residuals which should be used in computing forecasts.<br />
</li>
<li>The residuals have <strong>zero mean</strong>(i.e., <span class="math inline">\(E(e_t) = 0\)</span>. If the residuals have a mean other than zero, then the forecasts are biased.</li>
</ol>
<p>Any forecasting method that does not satisfy these properties can be improved. However, that does not mean that forecasting methods that satisfy these properties cannot be improved. It is possible to have several different forecasting methods for the same data set, all of which satisfy these properties. Checking these properties is important in order to see whether a method is using all of the available information, but it is not a good way to select a forecasting method.</p>
<p>If either of these properties is not satisfied, then the forecasting method can be modified to give better forecasts. Adjusting for bias is easy: if the residuals have mean <span class="math inline">\(m\)</span>
, then simply add <span class="math inline">\(m\)</span> to all forecasts and the bias problem is solved. Fixing the correlation problem is harder, and we will not address it until Chapter 10.</p>
<p>In addition to these essential properties, it is useful (but not necessary) for the residuals to also have the following two properties.</p>
<blockquote>
<ol start="3" style="list-style-type: decimal">
<li>The residuals have <strong>constant variance</strong>.<br />
</li>
<li>The residuals are <strong>normally distributed</strong>.</li>
</ol>
</blockquote>
<p>These two properties make the calculation of prediction intervals easier (see Section 5.5 for an example). However, a forecasting method that does not satisfy these properties cannot necessarily be improved. Sometimes applying a Box-Cox transformation may assist with these properties, but otherwise there is usually little that you can do to ensure that your residuals have constant variance and a normal distribution. Instead, an alternative approach to obtaining prediction intervals is necessary. Again, we will not address how to do this until later in the book.</p>
<div id="white-noise" class="section level3">
<h3><span class="header-section-number">5.4.1</span> White noise</h3>
<p>A time series is (discrete) white noise if its values are (see mathematical definition in Section <a href="univariate-stationary-processes.html#ch9-white-noise">9.1.1</a>):</p>
<ol style="list-style-type: decimal">
<li>independent</li>
<li>identically distributed with a mean of zero</li>
</ol>
<p>Using time series terms, a white noise should have mean 0, no autocorrelation and no seasonality.</p>
<p>We often assume a more stringent form of white noise, that is <strong>Gaussian white noise</strong>, see Section <a href="univariate-stationary-processes.html#tests-for-autocorrelation-and-normality">9.1.2</a> for JB normality test:</p>
<p><span class="math display">\[
\varepsilon_t \stackrel{iid}{\sim} N(0, \sigma^2)
\]</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="the-forecasters-toolbox.html#cb82-1"></a><span class="co"># simulate Gaussian and other white noise</span></span>
<span id="cb82-2"><a href="the-forecasters-toolbox.html#cb82-2"></a><span class="kw">set.seed</span>(<span class="dv">2020</span>)</span>
<span id="cb82-3"><a href="the-forecasters-toolbox.html#cb82-3"></a>y &lt;-<span class="st"> </span><span class="kw">tsibble</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, <span class="dt">wn =</span> <span class="kw">rnorm</span>(<span class="dv">50</span>), <span class="dt">index =</span> sample)</span>
<span id="cb82-4"><a href="the-forecasters-toolbox.html#cb82-4"></a>z &lt;-<span class="st"> </span><span class="kw">tsibble</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>, </span>
<span id="cb82-5"><a href="the-forecasters-toolbox.html#cb82-5"></a>             <span class="dt">wn =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">50</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>) <span class="dv">-1</span> , </span>
<span id="cb82-6"><a href="the-forecasters-toolbox.html#cb82-6"></a>             <span class="dt">index =</span> sample)</span>
<span id="cb82-7"><a href="the-forecasters-toolbox.html#cb82-7"></a></span>
<span id="cb82-8"><a href="the-forecasters-toolbox.html#cb82-8"></a>y <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-9"><a href="the-forecasters-toolbox.html#cb82-9"></a><span class="st">  </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb82-10"><a href="the-forecasters-toolbox.html#cb82-10"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Gaussian white noise&quot;</span>)</span>
<span id="cb82-11"><a href="the-forecasters-toolbox.html#cb82-11"></a></span>
<span id="cb82-12"><a href="the-forecasters-toolbox.html#cb82-12"></a></span>
<span id="cb82-13"><a href="the-forecasters-toolbox.html#cb82-13"></a>z <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-14"><a href="the-forecasters-toolbox.html#cb82-14"></a><span class="st">  </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb82-15"><a href="the-forecasters-toolbox.html#cb82-15"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Other white noise&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-18-1.png" width="50%" /><img src="ch5_files/figure-html/unnamed-chunk-18-2.png" width="50%" /></p>
<p>The check for autocorrelation</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="the-forecasters-toolbox.html#cb83-1"></a><span class="kw">wrap_plots</span>(</span>
<span id="cb83-2"><a href="the-forecasters-toolbox.html#cb83-2"></a>  y <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gg_lag</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lag plot forGaussian white noise&quot;</span>),</span>
<span id="cb83-3"><a href="the-forecasters-toolbox.html#cb83-3"></a>  y <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;ACF plot for Gaussian white noise&quot;</span>),</span>
<span id="cb83-4"><a href="the-forecasters-toolbox.html#cb83-4"></a>  z <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gg_lag</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lag plot for Other white noise&quot;</span>),</span>
<span id="cb83-5"><a href="the-forecasters-toolbox.html#cb83-5"></a>  z <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;ACF plot Other white noise&quot;</span>)</span>
<span id="cb83-6"><a href="the-forecasters-toolbox.html#cb83-6"></a>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Since white noise are uncoorelated, we expect each autocorrelation coefficient of any order to be close to zero. Of course, they will not be exactly equal to zero as there is some random variation. For a white noise series, we expect <span class="math inline">\(95%\)</span> of the spikes in the <code>ACF</code> plot to lie within <span class="math inline">\(±2/\sqrt{T}\)</span> where <span class="math inline">\(T\)</span> is the length of the time series. It is common to plot these bounds on a graph of the <code>ACF</code> (the blue dashed lines above). If one or more large spikes are outside these bounds, or if substantially more than <span class="math inline">\(5\%\)</span> of spikes are outside these bounds, then the series is probably not white noise.</p>
<p>In this example, <span class="math inline">\(T = 50\)</span> and the bounds are at <span class="math inline">\(±2/\sqrt{50} = \pm 0.28\)</span>. All of the autocorrelation coefficients lie within these limits, confirming that the data are white noise.</p>
<p>Why white noise matters? Researchers generally assume that white noise is not predictable, and contains no information related to the response of interest. It follows that we would expect that residuals computed according to a specific model to be white noise. This means the valuable part of model extract information from the data to such an extent that we do not care what’s left.</p>
<p>If residuals <span class="math inline">\(\varepsilon_1, \varepsilon_2, \dots, \varepsilon_t\)</span> violates any of the rules of white noise, then there is still valuable information buried under the residuals, which we will improve our models to capture. We have not a ‘best’ model at hand until residuals become unpredictable, in other words, white noise.</p>
</div>
<div id="example-forecasting-the-google-daily-closing-stock-price" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Example: Forecasting the Google daily closing stock price</h3>
<p>We will continue with the Google daily closing stock price example from the previous chapter. For stock market prices and indexes, the best forecasting method is often the naïve method. That is, each forecast is simply equal to the last observed value, or <span class="math inline">\(\hat{y}_t = y_{t−1}\)</span>. Hence, the residuals are simply equal to the difference between consecutive observations:</p>
<p><span class="math display">\[
e_t = y_t - \hat{y}_t = y_t - y_{t-1} 
\]</span></p>
<p>The following graph shows the Google daily closing stock price for trading days during 2015. The large jump corresponds to 17 July 2015 when the price jumped 16% due to unexpectedly strong second quarter results.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="the-forecasters-toolbox.html#cb84-1"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(Close) <span class="op">+</span></span>
<span id="cb84-2"><a href="the-forecasters-toolbox.html#cb84-2"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day&quot;</span>,</span>
<span id="cb84-3"><a href="the-forecasters-toolbox.html#cb84-3"></a>       <span class="dt">y =</span> <span class="st">&quot;Closing Price (US$)&quot;</span>,</span>
<span id="cb84-4"><a href="the-forecasters-toolbox.html#cb84-4"></a>       <span class="dt">title =</span> <span class="st">&quot;Google Stock in 2015&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Remeber what an ideal set of residuals shoule be like: they should have mean 0 and constant variance, and behave uncorrelated. In most cases we also want residuals to be normally distributed:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="the-forecasters-toolbox.html#cb85-1"></a>aug &lt;-<span class="st"> </span>google_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb85-2"><a href="the-forecasters-toolbox.html#cb85-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">NAIVE</span>(Close)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb85-3"><a href="the-forecasters-toolbox.html#cb85-3"></a><span class="st">  </span><span class="kw">augment</span>()</span>
<span id="cb85-4"><a href="the-forecasters-toolbox.html#cb85-4"></a></span>
<span id="cb85-5"><a href="the-forecasters-toolbox.html#cb85-5"></a><span class="co"># mean, variance</span></span>
<span id="cb85-6"><a href="the-forecasters-toolbox.html#cb85-6"></a>aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb85-7"><a href="the-forecasters-toolbox.html#cb85-7"></a><span class="st">  </span><span class="kw">autoplot</span>(.resid) <span class="op">+</span><span class="st"> </span></span>
<span id="cb85-8"><a href="the-forecasters-toolbox.html#cb85-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Residuals from naïve method&quot;</span>,</span>
<span id="cb85-9"><a href="the-forecasters-toolbox.html#cb85-9"></a>       <span class="dt">x =</span> <span class="st">&quot;Day&quot;</span>,</span>
<span id="cb85-10"><a href="the-forecasters-toolbox.html#cb85-10"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="the-forecasters-toolbox.html#cb86-1"></a></span>
<span id="cb86-2"><a href="the-forecasters-toolbox.html#cb86-2"></a><span class="co"># distribution</span></span>
<span id="cb86-3"><a href="the-forecasters-toolbox.html#cb86-3"></a>aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb86-4"><a href="the-forecasters-toolbox.html#cb86-4"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb86-5"><a href="the-forecasters-toolbox.html#cb86-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(.resid))</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-21-2.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="the-forecasters-toolbox.html#cb87-1"></a></span>
<span id="cb87-2"><a href="the-forecasters-toolbox.html#cb87-2"></a><span class="co"># correlation</span></span>
<span id="cb87-3"><a href="the-forecasters-toolbox.html#cb87-3"></a>aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb87-4"><a href="the-forecasters-toolbox.html#cb87-4"></a><span class="st">  </span><span class="kw">ACF</span>(.resid) <span class="op">%&gt;%</span></span>
<span id="cb87-5"><a href="the-forecasters-toolbox.html#cb87-5"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-21-3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Shorthand function <code>gg_tsresiduals()</code>:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="the-forecasters-toolbox.html#cb88-1"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb88-2"><a href="the-forecasters-toolbox.html#cb88-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="dt">naive =</span> <span class="kw">NAIVE</span>(Close)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-3"><a href="the-forecasters-toolbox.html#cb88-3"></a><span class="st">  </span><span class="kw">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>A qq plot to detect distribution:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="the-forecasters-toolbox.html#cb89-1"></a>aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb89-2"><a href="the-forecasters-toolbox.html#cb89-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">sample =</span> .resid)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb89-3"><a href="the-forecasters-toolbox.html#cb89-3"></a><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb89-4"><a href="the-forecasters-toolbox.html#cb89-4"></a><span class="st">  </span><span class="kw">stat_qq_line</span>()</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Some useful functions for general diagonisis from the <a href="https://easystats.github.io/performance/">performance</a> are mentioned in Section <a href="time-series-regression-models.html#the-performance-package">7.3.4</a></p>
</div>
<div id="portmanteau-tests-for-autocorrelation" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Portmanteau tests for autocorrelation</h3>
<p>In order to evaluate estimated time series models, it is important to know
whether the residuals of the model really have the properties of a white noise, in particular, whether they are uncorrelated. Thus, the null hypothesis to be tested is</p>
<p><span class="math display">\[
H_0 : r_k = 0, k = 1, 2, ...
\]</span></p>
<p>In order to build formal statistical tests to overcome undue reliance on ACF plots, we test whether the first <span class="math inline">\(h\)</span> autocorrelations are significantly different from what would be expected from a white noise process. A test for a group of autocorrelations is called a <strong>portmanteau test</strong>, from a French word describing a suitcase containing a number of items.</p>
<p>One such test is the <strong>Box-Pierce</strong> test, based on the following statistic:</p>
<p><span class="math display">\[
Q = T \sum_{k = 1}^{h}{r^2_k}
\]</span></p>
<p>where <span class="math inline">\(h\)</span> is the maximum lag being considered and <span class="math inline">\(T\)</span> is the number of observations. If each <span class="math inline">\(r_k\)</span> is close to zero, then <span class="math inline">\(Q\)</span> will be small. If some <span class="math inline">\(r_k\)</span> values are large (positive or negative), then <span class="math inline">\(Q\)</span> will be large. It is suggested that use <span class="math inline">\(h = 10\)</span> for non-seasonal data and <span class="math inline">\(h = 2m\)</span> for seasonal data, where <span class="math inline">\(m\)</span> is the period of seasonality. However, the test is not good when <span class="math inline">\(h\)</span> is large, so if these values are larger than <span class="math inline">\(T/5\)</span>, then use <span class="math inline">\(h=T/5\)</span>.</p>
<p>A related (and more accurate) test is the <strong>Ljung-Box test</strong>, based on</p>
<p><span class="math display">\[
Q^* = T(T + 2)\sum_{k = 1}^{h}{(T-K)^{-1}}r_k^2
\]</span></p>
<p>If the autocorrelations did come from a white noise series, then both <span class="math inline">\(Q\)</span> and <span class="math inline">\(Q^*\)</span> follows a distribution of <span class="math inline">\(\chi^2_{h - K}\)</span> where <span class="math inline">\(K\)</span> is the number of parameters in the model. For model where there is no parameter to estimate (such as naive model), we simply set <span class="math inline">\(K = 0\)</span>. For a regular time series rather than residuals that come from a particular model, we also set <span class="math inline">\(K = 0\)</span>. Note that in <code>ljung_box()</code>, argument <code>dof</code> specifies <code>K</code>, rather than <code>h - K</code></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="the-forecasters-toolbox.html#cb90-1"></a><span class="co"># lag = h and dof = K</span></span>
<span id="cb90-2"><a href="the-forecasters-toolbox.html#cb90-2"></a>aug <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(.resid, box_pierce, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="dt">dof =</span> <span class="dv">0</span>)</span>
<span id="cb90-3"><a href="the-forecasters-toolbox.html#cb90-3"></a><span class="co">#&gt; # A tibble: 1 x 4</span></span>
<span id="cb90-4"><a href="the-forecasters-toolbox.html#cb90-4"></a><span class="co">#&gt;   Symbol .model       bp_stat bp_pvalue</span></span>
<span id="cb90-5"><a href="the-forecasters-toolbox.html#cb90-5"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb90-6"><a href="the-forecasters-toolbox.html#cb90-6"></a><span class="co">#&gt; 1 GOOG   NAIVE(Close)    7.74     0.654</span></span>
<span id="cb90-7"><a href="the-forecasters-toolbox.html#cb90-7"></a></span>
<span id="cb90-8"><a href="the-forecasters-toolbox.html#cb90-8"></a>aug <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="dt">dof =</span> <span class="dv">0</span>)</span>
<span id="cb90-9"><a href="the-forecasters-toolbox.html#cb90-9"></a><span class="co">#&gt; # A tibble: 1 x 4</span></span>
<span id="cb90-10"><a href="the-forecasters-toolbox.html#cb90-10"></a><span class="co">#&gt;   Symbol .model       lb_stat lb_pvalue</span></span>
<span id="cb90-11"><a href="the-forecasters-toolbox.html#cb90-11"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb90-12"><a href="the-forecasters-toolbox.html#cb90-12"></a><span class="co">#&gt; 1 GOOG   NAIVE(Close)    7.91     0.637</span></span></code></pre></div>
<p>For both <span class="math inline">\(Q\)</span> and <span class="math inline">\(Q^∗\)</span>, the results are not significant. Thus, we can conclude that the residuals are not distinguishable from a white noise series.</p>
<p>To see details of these tests, see Section <a href="univariate-stationary-processes.html#tests-for-autocorrelation-and-normality">9.1.2</a></p>
</div>
</div>
<div id="predict-interval" class="section level2">
<h2><span class="header-section-number">5.5</span> Prediction intervals</h2>
<p>A prediction interval gives an interval within which we expect <span class="math inline">\(y_t\)</span> to lie with a specified probability. For example, <strong>assuming that the residuals are normally distributed</strong>, a 95% prediction interval for the h-step forecast is :</p>
<p><span class="math display">\[
y_{T+h | h} \pm 1.96\hat{\sigma}_h
\]</span></p>
<p>where <span class="math inline">\(\hat{\sigma}_h\)</span> is an estimate of the standard deviation of the h-step forecast distribution.</p>
<p>More generally, a prediction interval can be written as :</p>
<p><span class="math display">\[
y_{T+h | h} \pm c\hat{\sigma}_h
\]</span></p>
<p>where <span class="math inline">\(c\)</span> depends on the coverage probability (i.e., <span class="math inline">\(Z_\alpha\)</span> when <span class="math inline">\(1 - \alpha\)</span> means the critical level and residuals are normally distributed).</p>
<div id="one-step-prediction-intervals" class="section level3">
<h3><span class="header-section-number">5.5.1</span> One-step prediction intervals</h3>
<p><strong>When forecasting one step ahead, the standard deviation of the forecast distribution is almost the same as the standard deviation of the residuals.</strong> (In fact, the two standard deviations are identical if there are no parameters to be estimated, as is the case with the naïve method. For forecasting methods involving parameters to be estimated, the standard deviation of the forecast distribution is slightly larger than the residual standard deviation, although this difference is often ignored.)</p>
<p>So for a naive model’s prediction interval at <span class="math inline">\(y_{T+1}\)</span></p>
<p><span class="math display">\[
\hat{y}_{T + 1} \pm Z_\alpha\hat{\sigma}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\hat{\sigma} = \sqrt{\frac{1}{n}\sum_{t = 1}^{T}{R_t^2}}
\]</span></p>
</div>
<div id="multi-step-prediction-intervals" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Multi-step prediction intervals</h3>
<p>A common feature of prediction intervals is that they increase in length as the forecast horizon increases. The further ahead we forecast, the more uncertainty is associated with the forecast, and thus the wider the prediction intervals. That is, σh usually increases with <span class="math inline">\(h\)</span> (although there are some non-linear forecasting methods that do not have this property).</p>
<p>To produce a prediction interval, it is necessary to have an estimate of <span class="math inline">\(\sigma_h\)</span>
. As already noted, for one-step forecasts (<span class="math inline">\(h = 1\)</span>), the residual standard deviation provides a good estimate of the forecast standard deviation <span class="math inline">\(\sigma_1\)</span>. For multi-step forecasts, a more complicated method of calculation is required. <strong>These calculations assume that the residuals are uncorrelated</strong>.</p>
<p>For the <strong>four benchmark methods</strong>, it is possible to mathematically derive the forecast standard deviation under the assumption of uncorrelated residuals. If <span class="math inline">\(\sigma_h\)</span> denotes the standard deviation of the h-step forecast distribution, and <span class="math inline">\(\hat{\sigma}\)</span> is the residual standard deviation, then we can use the following expressions.</p>
<p><img src="images/benchmark.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Note that when <span class="math inline">\(h = 1\)</span> and T is large, these all give the same approximate value <span class="math inline">\(\hat{\sigma}\)</span>.</p>
<p>Prediction intervals can easily be computed for you when using the fable package. For example, here is the output when using the naïve method for the Google stock price.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="the-forecasters-toolbox.html#cb91-1"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb91-2"><a href="the-forecasters-toolbox.html#cb91-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">NAIVE</span>(Close)) <span class="op">%&gt;%</span></span>
<span id="cb91-3"><a href="the-forecasters-toolbox.html#cb91-3"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb91-4"><a href="the-forecasters-toolbox.html#cb91-4"></a><span class="st">  </span><span class="kw">hilo</span>(<span class="dt">level =</span> <span class="dv">95</span>) </span>
<span id="cb91-5"><a href="the-forecasters-toolbox.html#cb91-5"></a><span class="co">#&gt; # A tsibble: 10 x 6 [1]</span></span>
<span id="cb91-6"><a href="the-forecasters-toolbox.html#cb91-6"></a><span class="co">#&gt; # Key:       Symbol, .model [1]</span></span>
<span id="cb91-7"><a href="the-forecasters-toolbox.html#cb91-7"></a><span class="co">#&gt;   Symbol .model         day       Close .mean                  `95%`</span></span>
<span id="cb91-8"><a href="the-forecasters-toolbox.html#cb91-8"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;      &lt;dist&gt; &lt;dbl&gt;                 &lt;hilo&gt;</span></span>
<span id="cb91-9"><a href="the-forecasters-toolbox.html#cb91-9"></a><span class="co">#&gt; 1 GOOG   NAIVE(Close)   505 N(759, 125)  759. [736.9488, 780.8112]95</span></span>
<span id="cb91-10"><a href="the-forecasters-toolbox.html#cb91-10"></a><span class="co">#&gt; 2 GOOG   NAIVE(Close)   506 N(759, 250)  759. [727.8646, 789.8954]95</span></span>
<span id="cb91-11"><a href="the-forecasters-toolbox.html#cb91-11"></a><span class="co">#&gt; 3 GOOG   NAIVE(Close)   507 N(759, 376)  759. [720.8941, 796.8659]95</span></span>
<span id="cb91-12"><a href="the-forecasters-toolbox.html#cb91-12"></a><span class="co">#&gt; 4 GOOG   NAIVE(Close)   508 N(759, 501)  759. [715.0176, 802.7424]95</span></span>
<span id="cb91-13"><a href="the-forecasters-toolbox.html#cb91-13"></a><span class="co">#&gt; 5 GOOG   NAIVE(Close)   509 N(759, 626)  759. [709.8404, 807.9196]95</span></span>
<span id="cb91-14"><a href="the-forecasters-toolbox.html#cb91-14"></a><span class="co">#&gt; 6 GOOG   NAIVE(Close)   510 N(759, 751)  759. [705.1598, 812.6002]95</span></span>
<span id="cb91-15"><a href="the-forecasters-toolbox.html#cb91-15"></a><span class="co">#&gt; # ... with 4 more rows</span></span></code></pre></div>
<p>The <code>hilo()</code> function converts the forecast distributions into intervals. By default, 80% and 95% prediction intervals are returned, here I ask only for a 95% interval via the <code>level</code> argument.</p>
</div>
<div id="prediction-intervals-from-bootstrapped-residuals" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Prediction intervals from bootstrapped residuals</h3>
<p>Assuming future errors will be similar to past errors, we can replace <span class="math inline">\(e_{T+1}, e_{T+2}, \dots\)</span> by sampling from the collection of errors we have seen in the past (i.e., the residuals). Thus we could get “future” <span class="math inline">\(y_{T+1}, y_{T+2}, \dots\)</span> by <span class="math inline">\(\hat{y}_{T+1} + e_{T+1}, \hat{y}_{T+2} + e_{T+2}, \dots\)</span>.</p>
<p>Since sampling could generate different sets of future residuals, we thus get different paths of <span class="math inline">\(y_{T+1}, y_{T+2}, \dots\)</span>. And we can then derive the <span class="math inline">\(1 - \alpha\)</span> prediction interval simply by calculating a correspoing percentile based on each <span class="math inline">\(\hat{y}_{T+1}, \hat{y}_{T+2}, \dots\)</span> and numerous simulated path.</p>
<p><code>generate()</code> lets us see some possible futures:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="the-forecasters-toolbox.html#cb92-1"></a>google_fit &lt;-<span class="st"> </span>google_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb92-2"><a href="the-forecasters-toolbox.html#cb92-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">NAIVE</span>(Close))</span>
<span id="cb92-3"><a href="the-forecasters-toolbox.html#cb92-3"></a></span>
<span id="cb92-4"><a href="the-forecasters-toolbox.html#cb92-4"></a>sim &lt;-<span class="st"> </span>google_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb92-5"><a href="the-forecasters-toolbox.html#cb92-5"></a><span class="st">  </span><span class="kw">generate</span>(<span class="dt">h =</span> <span class="dv">30</span>, <span class="dt">times =</span> <span class="dv">5</span>, <span class="dt">bootstrap =</span> <span class="ot">TRUE</span>) </span>
<span id="cb92-6"><a href="the-forecasters-toolbox.html#cb92-6"></a></span>
<span id="cb92-7"><a href="the-forecasters-toolbox.html#cb92-7"></a>sim</span>
<span id="cb92-8"><a href="the-forecasters-toolbox.html#cb92-8"></a><span class="co">#&gt; # A tsibble: 150 x 5 [1]</span></span>
<span id="cb92-9"><a href="the-forecasters-toolbox.html#cb92-9"></a><span class="co">#&gt; # Key:       Symbol, .model, .rep [5]</span></span>
<span id="cb92-10"><a href="the-forecasters-toolbox.html#cb92-10"></a><span class="co">#&gt;   Symbol .model         day .rep   .sim</span></span>
<span id="cb92-11"><a href="the-forecasters-toolbox.html#cb92-11"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb92-12"><a href="the-forecasters-toolbox.html#cb92-12"></a><span class="co">#&gt; 1 GOOG   NAIVE(Close)   505 1      724.</span></span>
<span id="cb92-13"><a href="the-forecasters-toolbox.html#cb92-13"></a><span class="co">#&gt; 2 GOOG   NAIVE(Close)   506 1      722.</span></span>
<span id="cb92-14"><a href="the-forecasters-toolbox.html#cb92-14"></a><span class="co">#&gt; 3 GOOG   NAIVE(Close)   507 1      700.</span></span>
<span id="cb92-15"><a href="the-forecasters-toolbox.html#cb92-15"></a><span class="co">#&gt; 4 GOOG   NAIVE(Close)   508 1      696.</span></span>
<span id="cb92-16"><a href="the-forecasters-toolbox.html#cb92-16"></a><span class="co">#&gt; 5 GOOG   NAIVE(Close)   509 1      696.</span></span>
<span id="cb92-17"><a href="the-forecasters-toolbox.html#cb92-17"></a><span class="co">#&gt; 6 GOOG   NAIVE(Close)   510 1      698.</span></span>
<span id="cb92-18"><a href="the-forecasters-toolbox.html#cb92-18"></a><span class="co">#&gt; # ... with 144 more rows</span></span></code></pre></div>
<p>Here we have generated five possible sample paths for the next 30 trading days. The <code>.rep</code> variable provides a new key for the tsibble. The plot below shows the five sample paths along with the historical data.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="the-forecasters-toolbox.html#cb93-1"></a><span class="kw">ggplot</span>(google_<span class="dv">2015</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-2"><a href="the-forecasters-toolbox.html#cb93-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(day, Close)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-3"><a href="the-forecasters-toolbox.html#cb93-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(day, .sim, <span class="dt">color =</span> <span class="kw">factor</span>(.rep)), <span class="dt">data =</span> sim) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-4"><a href="the-forecasters-toolbox.html#cb93-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Google closing stock price&quot;</span>) <span class="op">+</span></span>
<span id="cb93-5"><a href="the-forecasters-toolbox.html#cb93-5"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">col =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>This is all built into the <code>forecast()</code> function so we do not need to call generate() directly:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="the-forecasters-toolbox.html#cb94-1"></a>google_bootstrap_fc &lt;-<span class="st"> </span>google_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">30</span>, <span class="dt">bootstrap =</span> <span class="ot">TRUE</span>)</span>
<span id="cb94-2"><a href="the-forecasters-toolbox.html#cb94-2"></a>google_bootstrap_fc</span>
<span id="cb94-3"><a href="the-forecasters-toolbox.html#cb94-3"></a><span class="co">#&gt; # A fable: 30 x 5 [1]</span></span>
<span id="cb94-4"><a href="the-forecasters-toolbox.html#cb94-4"></a><span class="co">#&gt; # Key:     Symbol, .model [1]</span></span>
<span id="cb94-5"><a href="the-forecasters-toolbox.html#cb94-5"></a><span class="co">#&gt;   Symbol .model         day        Close .mean</span></span>
<span id="cb94-6"><a href="the-forecasters-toolbox.html#cb94-6"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;       &lt;dist&gt; &lt;dbl&gt;</span></span>
<span id="cb94-7"><a href="the-forecasters-toolbox.html#cb94-7"></a><span class="co">#&gt; 1 GOOG   NAIVE(Close)   505 sample[5000]  759.</span></span>
<span id="cb94-8"><a href="the-forecasters-toolbox.html#cb94-8"></a><span class="co">#&gt; 2 GOOG   NAIVE(Close)   506 sample[5000]  759.</span></span>
<span id="cb94-9"><a href="the-forecasters-toolbox.html#cb94-9"></a><span class="co">#&gt; 3 GOOG   NAIVE(Close)   507 sample[5000]  759.</span></span>
<span id="cb94-10"><a href="the-forecasters-toolbox.html#cb94-10"></a><span class="co">#&gt; 4 GOOG   NAIVE(Close)   508 sample[5000]  759.</span></span>
<span id="cb94-11"><a href="the-forecasters-toolbox.html#cb94-11"></a><span class="co">#&gt; 5 GOOG   NAIVE(Close)   509 sample[5000]  759.</span></span>
<span id="cb94-12"><a href="the-forecasters-toolbox.html#cb94-12"></a><span class="co">#&gt; 6 GOOG   NAIVE(Close)   510 sample[5000]  759.</span></span>
<span id="cb94-13"><a href="the-forecasters-toolbox.html#cb94-13"></a><span class="co">#&gt; # ... with 24 more rows</span></span></code></pre></div>
<p>Notice that the forecast distribution is now represented as a simulation with <strong>5000 sample paths</strong>. Because there is no normality assumption, the prediction intervals are not symmetric.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="the-forecasters-toolbox.html#cb95-1"></a>google_bootstrap_fc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb95-2"><a href="the-forecasters-toolbox.html#cb95-2"></a><span class="st">  </span><span class="kw">autoplot</span>(google_<span class="dv">2015</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb95-3"><a href="the-forecasters-toolbox.html#cb95-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bootstrapped prediction interval&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="evaluating-model-accuracy" class="section level2">
<h2><span class="header-section-number">5.6</span> Evaluating model accuracy</h2>
<div id="forecast-errors" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Forecast errors</h3>
<p><span class="math display">\[
e_{T+h} = y_{T+h} - \hat{y}_{T+h | T}
\]</span></p>
<p>where <span class="math inline">\({y_1\, \dots, y_T}\)</span> is the traing set and <span class="math inline">\({y_{T+1}, y_{T+2}\dots}\)</span> the testing set.</p>
</div>
<div id="scale-dependent-errors" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Scale dependent errors</h3>
<p>The two most commonly used scale-dependent measures are based on the absolute errors or squared errors:</p>
<p><span class="math display">\[
\begin{align}
Mean \,absolute \,error: MAE &amp;= mean(|e_t|) \\
Root \,square \,mean \,error: RMSE &amp;= \sqrt{mean(e_t^2)} \\
\end{align}
\]</span></p>
</div>
<div id="percentage-errors" class="section level3">
<h3><span class="header-section-number">5.6.3</span> Percentage errors</h3>
<p>The percentage error is given by <span class="math inline">\(p_t = 100e_t/y_t\)</span>. Percentage errors have the advantage of being <strong>unit-free</strong>, and so are frequently used to compare forecast performances between data sets. The most commonly used measure is:</p>
<p><span class="math display">\[
Mean \,absolute \,error: MAE = mean(|p_t|)
\]</span>
Measures based on percentage errors have the disadvantage of being infinite or undefined if <span class="math inline">\(y_t = 0\)</span> for any <span class="math inline">\(t\)</span> in the period of interest, and having extreme values if any <span class="math inline">\(y_t\)</span> is close to zero. <strong>Another problem with percentage errors that is often overlooked is that they assume the unit of measurement has a meaningful zero</strong>. For example, a percentage error makes no sense when measuring the accuracy of temperature forecasts on either the Fahrenheit or Celsius scales, because temperature has an arbitrary zero point. They also have the disadvantage that they put a heavier penalty on negative errors than on positive errors.</p>
<p>This observation led to the use of the so-called “symmetric” MAPE (sMAPE) which was used in the M3 forecasting competition. It is defined by</p>
<p><span class="math display">\[
sMAPE = mean(200|y_t - \hat{y}_t| / (y_t + \hat{y}_t))
\]</span></p>
<p>However, if <span class="math inline">\(y_t\)</span> is close to zero, <span class="math inline">\(\hat{y}_t\)</span> is also likely to be close to zero. Thus, the measure still involves division by a number close to zero, making the calculation unstable. Also, the value of sMAPE can be negative, so it is not really a measure of “absolute percentage errors” at all.</p>
<p>Hyndman &amp; Koehler <span class="citation">(<a href="references.html#ref-hyndman2006another" role="doc-biblioref">2006</a>)</span> recommend that the sMAPE not be used. It is included here only because it is widely used, although it is not used in this book.</p>
</div>
<div id="scaled-errors" class="section level3">
<h3><span class="header-section-number">5.6.4</span> Scaled errors</h3>
<p>Scaled errors were proposed by Hyndman &amp; Koehler as an alternative to using percentage errors when comparing forecast accuracy across series with different units. They proposed scaling the errors based on the <em>training</em> MAE from a simple forecast method.</p>
<p>For a non-seasonal time series, a useful way to define a scaled error uses naive forecasts:</p>
<p><span class="math display">\[
q_j = \frac{e_j}{\frac{1}{T-1}\sum_{t = 2}^{T}{|y_t - y_{t-1}|}}
\]</span></p>
<p>Because the numerator and denominator both involve values on the scale of the original data, <span class="math inline">\(q_j\)</span> is independent of the scale of the data. A scaled error is less than one if it arises from a better forecast than the average naive forecast computed on the training data. Conversely, it is greater than one if the forecast is worse than the average naive forecast computed on the training data.</p>
<p>For seasonal time series, a scaled error can be defined using seasonal naive forecasts:</p>
<p><span class="math display">\[
q_j = \frac{e_j}{\frac{1}{T-m}\sum_{t = m+1}^{T}{|y_t - y_{t-m}|}}
\]</span></p>
<p>The <em>mean absolute scaled error</em> is simply</p>
<p><span class="math display">\[
MASE = mean(|q_j|)
\]</span></p>
</div>
<div id="examples-beer-production" class="section level3">
<h3><span class="header-section-number">5.6.5</span> Examples: beer production</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="the-forecasters-toolbox.html#cb96-1"></a>recent_production &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">year</span>(Quarter) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1992</span>)</span>
<span id="cb96-2"><a href="the-forecasters-toolbox.html#cb96-2"></a>beer_train &lt;-<span class="st"> </span>recent_production <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">year</span>(Quarter) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2007</span>)</span>
<span id="cb96-3"><a href="the-forecasters-toolbox.html#cb96-3"></a></span>
<span id="cb96-4"><a href="the-forecasters-toolbox.html#cb96-4"></a>beer_fit &lt;-<span class="st"> </span>beer_train <span class="op">%&gt;%</span></span>
<span id="cb96-5"><a href="the-forecasters-toolbox.html#cb96-5"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb96-6"><a href="the-forecasters-toolbox.html#cb96-6"></a>    <span class="dt">Mean =</span> <span class="kw">MEAN</span>(Beer),</span>
<span id="cb96-7"><a href="the-forecasters-toolbox.html#cb96-7"></a>    <span class="st">`</span><span class="dt">Naïve</span><span class="st">`</span> =<span class="st"> </span><span class="kw">NAIVE</span>(Beer),</span>
<span id="cb96-8"><a href="the-forecasters-toolbox.html#cb96-8"></a>    <span class="st">`</span><span class="dt">Seasonal naïve</span><span class="st">`</span> =<span class="st"> </span><span class="kw">SNAIVE</span>(Beer),</span>
<span id="cb96-9"><a href="the-forecasters-toolbox.html#cb96-9"></a>    <span class="dt">Drift =</span> <span class="kw">RW</span>(Beer <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())</span>
<span id="cb96-10"><a href="the-forecasters-toolbox.html#cb96-10"></a>  )</span>
<span id="cb96-11"><a href="the-forecasters-toolbox.html#cb96-11"></a></span>
<span id="cb96-12"><a href="the-forecasters-toolbox.html#cb96-12"></a>beer_fc &lt;-<span class="st"> </span>beer_fit <span class="op">%&gt;%</span></span>
<span id="cb96-13"><a href="the-forecasters-toolbox.html#cb96-13"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">10</span>)</span>
<span id="cb96-14"><a href="the-forecasters-toolbox.html#cb96-14"></a></span>
<span id="cb96-15"><a href="the-forecasters-toolbox.html#cb96-15"></a>beer_fc <span class="op">%&gt;%</span></span>
<span id="cb96-16"><a href="the-forecasters-toolbox.html#cb96-16"></a><span class="st">  </span><span class="kw">autoplot</span>(<span class="kw">filter</span>(aus_production, <span class="kw">year</span>(Quarter) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1992</span>), <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb96-17"><a href="the-forecasters-toolbox.html#cb96-17"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Megalitres&quot;</span>) <span class="op">+</span></span>
<span id="cb96-18"><a href="the-forecasters-toolbox.html#cb96-18"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Forecasts for quarterly beer production&quot;</span>) <span class="op">+</span></span>
<span id="cb96-19"><a href="the-forecasters-toolbox.html#cb96-19"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Models&quot;</span>))</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="the-forecasters-toolbox.html#cb97-1"></a><span class="kw">accuracy</span>(beer_fc, recent_production)</span>
<span id="cb97-2"><a href="the-forecasters-toolbox.html#cb97-2"></a><span class="co">#&gt; # A tibble: 4 x 9</span></span>
<span id="cb97-3"><a href="the-forecasters-toolbox.html#cb97-3"></a><span class="co">#&gt;   .model         .type    ME  RMSE   MAE    MPE  MAPE  MASE    ACF1</span></span>
<span id="cb97-4"><a href="the-forecasters-toolbox.html#cb97-4"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb97-5"><a href="the-forecasters-toolbox.html#cb97-5"></a><span class="co">#&gt; 1 Drift          Test  -54.0  64.9  58.9 -13.6  14.6  4.12  -0.0741</span></span>
<span id="cb97-6"><a href="the-forecasters-toolbox.html#cb97-6"></a><span class="co">#&gt; 2 Mean           Test  -13.8  38.4  34.8  -3.97  8.28 2.44  -0.0691</span></span>
<span id="cb97-7"><a href="the-forecasters-toolbox.html#cb97-7"></a><span class="co">#&gt; 3 Naïve          Test  -51.4  62.7  57.4 -13.0  14.2  4.01  -0.0691</span></span>
<span id="cb97-8"><a href="the-forecasters-toolbox.html#cb97-8"></a><span class="co">#&gt; 4 Seasonal naïve Test    5.2  14.3  13.4   1.15  3.17 0.937  0.132</span></span></code></pre></div>
<p>It is obvious from the graph that the seasonal naïve method is best for these data, although it can still be improved, as we will discover later. Sometimes, different accuracy measures will lead to different results as to which forecast method is best. However, in this case, all of the results point to the seasonal naïve method as the best of these three methods for this data set.</p>
<p>To take a non-seasonal example, consider the Google stock price. The following graph shows the closing stock prices from 2015, along with forecasts for January 2016 obtained from three different methods.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="the-forecasters-toolbox.html#cb98-1"></a>google_fit &lt;-<span class="st"> </span>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb98-2"><a href="the-forecasters-toolbox.html#cb98-2"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb98-3"><a href="the-forecasters-toolbox.html#cb98-3"></a>    <span class="dt">Mean =</span> <span class="kw">MEAN</span>(Close),</span>
<span id="cb98-4"><a href="the-forecasters-toolbox.html#cb98-4"></a>    <span class="st">`</span><span class="dt">Naïve</span><span class="st">`</span> =<span class="st"> </span><span class="kw">NAIVE</span>(Close),</span>
<span id="cb98-5"><a href="the-forecasters-toolbox.html#cb98-5"></a>    <span class="dt">Drift =</span> <span class="kw">RW</span>(Close <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())</span>
<span id="cb98-6"><a href="the-forecasters-toolbox.html#cb98-6"></a>  )</span>
<span id="cb98-7"><a href="the-forecasters-toolbox.html#cb98-7"></a></span>
<span id="cb98-8"><a href="the-forecasters-toolbox.html#cb98-8"></a>google_jan_<span class="dv">2016</span> &lt;-<span class="st"> </span>google_stock <span class="op">%&gt;%</span></span>
<span id="cb98-9"><a href="the-forecasters-toolbox.html#cb98-9"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">yearmonth</span>(Date) <span class="op">==</span><span class="st"> </span><span class="kw">yearmonth</span>(<span class="st">&quot;2016 Jan&quot;</span>))</span>
<span id="cb98-10"><a href="the-forecasters-toolbox.html#cb98-10"></a></span>
<span id="cb98-11"><a href="the-forecasters-toolbox.html#cb98-11"></a>google_fc &lt;-<span class="st"> </span>google_fit <span class="op">%&gt;%</span></span>
<span id="cb98-12"><a href="the-forecasters-toolbox.html#cb98-12"></a><span class="st">  </span><span class="kw">forecast</span>(google_jan_<span class="dv">2016</span>)</span>
<span id="cb98-13"><a href="the-forecasters-toolbox.html#cb98-13"></a></span>
<span id="cb98-14"><a href="the-forecasters-toolbox.html#cb98-14"></a>google_fc <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb98-15"><a href="the-forecasters-toolbox.html#cb98-15"></a><span class="st">  </span><span class="kw">autoplot</span>(<span class="kw">rbind</span>(google_<span class="dv">2015</span>, google_jan_<span class="dv">2016</span>), <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb98-16"><a href="the-forecasters-toolbox.html#cb98-16"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Google stock price (daily ending 6 Dec 13)&quot;</span>) <span class="op">+</span></span>
<span id="cb98-17"><a href="the-forecasters-toolbox.html#cb98-17"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Forecast&quot;</span>))</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;" />
Check model accuracy</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="the-forecasters-toolbox.html#cb99-1"></a><span class="kw">accuracy</span>(google_fc, google_stock)</span>
<span id="cb99-2"><a href="the-forecasters-toolbox.html#cb99-2"></a><span class="co">#&gt; # A tibble: 3 x 10</span></span>
<span id="cb99-3"><a href="the-forecasters-toolbox.html#cb99-3"></a><span class="co">#&gt;   .model Symbol .type    ME  RMSE   MAE   MPE  MAPE  MASE  ACF1</span></span>
<span id="cb99-4"><a href="the-forecasters-toolbox.html#cb99-4"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb99-5"><a href="the-forecasters-toolbox.html#cb99-5"></a><span class="co">#&gt; 1 Drift  GOOG   Test  -49.8  53.1  49.8 -6.99  6.99  7.84 0.604</span></span>
<span id="cb99-6"><a href="the-forecasters-toolbox.html#cb99-6"></a><span class="co">#&gt; 2 Mean   GOOG   Test  117.  118.  117.  16.2  16.2  18.4  0.496</span></span>
<span id="cb99-7"><a href="the-forecasters-toolbox.html#cb99-7"></a><span class="co">#&gt; 3 Naïve  GOOG   Test  -40.4  43.4  40.4 -5.67  5.67  6.36 0.496</span></span></code></pre></div>
<p>Here, the best method is the naïve method (regardless of which accuracy measure is used).</p>
</div>
</div>
<div id="time-series-cross-validation" class="section level2">
<h2><span class="header-section-number">5.7</span> Time series cross-validation</h2>
<blockquote>
<p>A more sophisticated version of training/test sets is time series cross-validation. In this procedure, there are a series of test sets, each consisting of a single observation. The corresponding training set consists only of observations that occurred prior to the observation that forms the test set. Thus, no future observations can be used in constructing the forecast. Since it is not possible to obtain a reliable forecast based on a small training set, the earliest observations are not considered as test sets.</p>
</blockquote>
<p><img src="images/cv.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The forecast accuracy is computed by averaging over the test sets.</p>
<p>With time series forecasting, one-step forecasts may not be as relevant as multi-step forecasts. In this case, the cross-validation procedure based on a rolling forecasting origin can be modified to allow multi-step errors to be used. Suppose that we are interested in models that produce good 4-step-ahead forecasts. Then the corresponding diagram is shown below.</p>
<p><img src="images/cv_multi.png" width="100%" style="display: block; margin: auto;" /></p>
<p><code>stretch_tsibble()</code> generates multiple folds as we specified: (may subject to change, I havn’t found a corresponding function in the <strong>slider</strong> package, perhaps <code>vfold_cv</code> from <strong>rsample</strong> in the future?)</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="the-forecasters-toolbox.html#cb100-1"></a><span class="co"># demonstrate `stretch_tsibble()` on a small subset</span></span>
<span id="cb100-2"><a href="the-forecasters-toolbox.html#cb100-2"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb100-3"><a href="the-forecasters-toolbox.html#cb100-3"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb100-4"><a href="the-forecasters-toolbox.html#cb100-4"></a><span class="st">  </span><span class="kw">stretch_tsibble</span>(<span class="dt">.init =</span> <span class="dv">3</span>, <span class="dt">.step =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># initial window size = 3, incremental step = 1</span></span>
<span id="cb100-5"><a href="the-forecasters-toolbox.html#cb100-5"></a><span class="st">  </span><span class="kw">as_tibble</span>()</span>
<span id="cb100-6"><a href="the-forecasters-toolbox.html#cb100-6"></a><span class="co">#&gt; # A tibble: 25 x 10</span></span>
<span id="cb100-7"><a href="the-forecasters-toolbox.html#cb100-7"></a><span class="co">#&gt;   Symbol Date        Open  High   Low Close Adj_Close  Volume   day   .id</span></span>
<span id="cb100-8"><a href="the-forecasters-toolbox.html#cb100-8"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb100-9"><a href="the-forecasters-toolbox.html#cb100-9"></a><span class="co">#&gt; 1 GOOG   2015-01-02  526.  528.  521.  522.      522. 1447600   253     1</span></span>
<span id="cb100-10"><a href="the-forecasters-toolbox.html#cb100-10"></a><span class="co">#&gt; 2 GOOG   2015-01-05  520.  521.  510.  511.      511. 2059800   254     1</span></span>
<span id="cb100-11"><a href="the-forecasters-toolbox.html#cb100-11"></a><span class="co">#&gt; 3 GOOG   2015-01-06  512.  513.  498.  499.      499. 2899900   255     1</span></span>
<span id="cb100-12"><a href="the-forecasters-toolbox.html#cb100-12"></a><span class="co">#&gt; 4 GOOG   2015-01-02  526.  528.  521.  522.      522. 1447600   253     2</span></span>
<span id="cb100-13"><a href="the-forecasters-toolbox.html#cb100-13"></a><span class="co">#&gt; 5 GOOG   2015-01-05  520.  521.  510.  511.      511. 2059800   254     2</span></span>
<span id="cb100-14"><a href="the-forecasters-toolbox.html#cb100-14"></a><span class="co">#&gt; 6 GOOG   2015-01-06  512.  513.  498.  499.      499. 2899900   255     2</span></span>
<span id="cb100-15"><a href="the-forecasters-toolbox.html#cb100-15"></a><span class="co">#&gt; # ... with 19 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="the-forecasters-toolbox.html#cb101-1"></a>google_<span class="dv">2015</span>_cv &lt;-<span class="st"> </span>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb101-2"><a href="the-forecasters-toolbox.html#cb101-2"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">n</span>()<span class="op">-</span><span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb101-3"><a href="the-forecasters-toolbox.html#cb101-3"></a><span class="st">  </span><span class="kw">stretch_tsibble</span>(<span class="dt">.init =</span> <span class="dv">3</span>, <span class="dt">.step =</span> <span class="dv">1</span>)</span>
<span id="cb101-4"><a href="the-forecasters-toolbox.html#cb101-4"></a></span>
<span id="cb101-5"><a href="the-forecasters-toolbox.html#cb101-5"></a>google_cv_fc &lt;-<span class="st"> </span>google_<span class="dv">2015</span>_cv <span class="op">%&gt;%</span></span>
<span id="cb101-6"><a href="the-forecasters-toolbox.html#cb101-6"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">RW</span>(Close <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())) <span class="op">%&gt;%</span></span>
<span id="cb101-7"><a href="the-forecasters-toolbox.html#cb101-7"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">1</span>)</span>
<span id="cb101-8"><a href="the-forecasters-toolbox.html#cb101-8"></a></span>
<span id="cb101-9"><a href="the-forecasters-toolbox.html#cb101-9"></a><span class="co"># for one step forecast, no need to specify &quot;by&quot; in `accuracy()`</span></span>
<span id="cb101-10"><a href="the-forecasters-toolbox.html#cb101-10"></a>google_cv_fc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">accuracy</span>(google_<span class="dv">2015</span>)</span>
<span id="cb101-11"><a href="the-forecasters-toolbox.html#cb101-11"></a><span class="co">#&gt; # A tibble: 1 x 10</span></span>
<span id="cb101-12"><a href="the-forecasters-toolbox.html#cb101-12"></a><span class="co">#&gt;   .model              Symbol .type    ME  RMSE   MAE   MPE  MAPE  MASE   ACF1</span></span>
<span id="cb101-13"><a href="the-forecasters-toolbox.html#cb101-13"></a><span class="co">#&gt;   &lt;chr&gt;               &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb101-14"><a href="the-forecasters-toolbox.html#cb101-14"></a><span class="co">#&gt; 1 RW(Close ~ drift()) GOOG   Test  0.726  11.3  7.26 0.112  1.19  1.02 0.0985</span></span>
<span id="cb101-15"><a href="the-forecasters-toolbox.html#cb101-15"></a></span>
<span id="cb101-16"><a href="the-forecasters-toolbox.html#cb101-16"></a><span class="co"># residual accuracy</span></span>
<span id="cb101-17"><a href="the-forecasters-toolbox.html#cb101-17"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">RW</span>(Close <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">accuracy</span>()</span>
<span id="cb101-18"><a href="the-forecasters-toolbox.html#cb101-18"></a><span class="co">#&gt; # A tibble: 1 x 10</span></span>
<span id="cb101-19"><a href="the-forecasters-toolbox.html#cb101-19"></a><span class="co">#&gt;   Symbol .model          .type         ME  RMSE   MAE     MPE  MAPE  MASE   ACF1</span></span>
<span id="cb101-20"><a href="the-forecasters-toolbox.html#cb101-20"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb101-21"><a href="the-forecasters-toolbox.html#cb101-21"></a><span class="co">#&gt; 1 GOOG   RW(Close ~ dri~ Train~ -2.97e-14  11.1  7.16 -0.0267  1.18  1.00 0.0976</span></span></code></pre></div>
<p>As expected, the accuracy measures from the residuals are smaller, as the corresponding “forecasts” are based on a model fitted to the entire data set, rather than being true forecasts.</p>
<div id="example-forecast-horizon-accuracy-with-cross-validation" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Example: Forecast horizon accuracy with cross-validation</h3>
<p>The code below evaluates the forecasting performance of 1- to 8-step-ahead drift forecasts. The plot shows that the forecast error increases as the forecast horizon increases, as we would expect.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="the-forecasters-toolbox.html#cb102-1"></a>google_<span class="dv">2015</span>_tr &lt;-<span class="st"> </span>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb102-2"><a href="the-forecasters-toolbox.html#cb102-2"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>(<span class="kw">n</span>() <span class="op">-</span><span class="st"> </span><span class="dv">8</span>)) <span class="op">%&gt;%</span></span>
<span id="cb102-3"><a href="the-forecasters-toolbox.html#cb102-3"></a><span class="st">  </span><span class="kw">stretch_tsibble</span>(<span class="dt">.init =</span> <span class="dv">3</span>, <span class="dt">.step =</span> <span class="dv">1</span>)</span>
<span id="cb102-4"><a href="the-forecasters-toolbox.html#cb102-4"></a></span>
<span id="cb102-5"><a href="the-forecasters-toolbox.html#cb102-5"></a>fc &lt;-<span class="st"> </span>google_<span class="dv">2015</span>_tr <span class="op">%&gt;%</span></span>
<span id="cb102-6"><a href="the-forecasters-toolbox.html#cb102-6"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">RW</span>(Close <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())) <span class="op">%&gt;%</span></span>
<span id="cb102-7"><a href="the-forecasters-toolbox.html#cb102-7"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">8</span>) <span class="op">%&gt;%</span></span>
<span id="cb102-8"><a href="the-forecasters-toolbox.html#cb102-8"></a><span class="st">  </span><span class="kw">group_by</span>(.id) <span class="op">%&gt;%</span></span>
<span id="cb102-9"><a href="the-forecasters-toolbox.html#cb102-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">h =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span></span>
<span id="cb102-10"><a href="the-forecasters-toolbox.html#cb102-10"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="the-forecasters-toolbox.html#cb103-1"></a><span class="co"># by indicates accuracy should be averaged over same &quot;h&quot;</span></span>
<span id="cb103-2"><a href="the-forecasters-toolbox.html#cb103-2"></a>fc <span class="op">%&gt;%</span></span>
<span id="cb103-3"><a href="the-forecasters-toolbox.html#cb103-3"></a><span class="st">  </span><span class="kw">accuracy</span>(google_<span class="dv">2015</span>, <span class="dt">by =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb103-4"><a href="the-forecasters-toolbox.html#cb103-4"></a><span class="co">#&gt; # A tibble: 8 x 9</span></span>
<span id="cb103-5"><a href="the-forecasters-toolbox.html#cb103-5"></a><span class="co">#&gt;       h .type    ME  RMSE   MAE   MPE  MAPE  MASE   ACF1</span></span>
<span id="cb103-6"><a href="the-forecasters-toolbox.html#cb103-6"></a><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb103-7"><a href="the-forecasters-toolbox.html#cb103-7"></a><span class="co">#&gt; 1     1 Test  0.729  11.3  7.26 0.113  1.20  1.02 0.0961</span></span>
<span id="cb103-8"><a href="the-forecasters-toolbox.html#cb103-8"></a><span class="co">#&gt; 2     2 Test  1.47   16.9 11.0  0.223  1.83  1.54 0.515 </span></span>
<span id="cb103-9"><a href="the-forecasters-toolbox.html#cb103-9"></a><span class="co">#&gt; 3     3 Test  2.21   20.8 14.0  0.334  2.34  1.97 0.671 </span></span>
<span id="cb103-10"><a href="the-forecasters-toolbox.html#cb103-10"></a><span class="co">#&gt; 4     4 Test  2.96   23.9 16.0  0.451  2.66  2.26 0.749 </span></span>
<span id="cb103-11"><a href="the-forecasters-toolbox.html#cb103-11"></a><span class="co">#&gt; 5     5 Test  3.79   26.5 17.7  0.580  2.95  2.51 0.791 </span></span>
<span id="cb103-12"><a href="the-forecasters-toolbox.html#cb103-12"></a><span class="co">#&gt; 6     6 Test  4.66   28.8 19.4  0.713  3.22  2.74 0.826 </span></span>
<span id="cb103-13"><a href="the-forecasters-toolbox.html#cb103-13"></a><span class="co">#&gt; # ... with 2 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="the-forecasters-toolbox.html#cb104-1"></a>fc <span class="op">%&gt;%</span></span>
<span id="cb104-2"><a href="the-forecasters-toolbox.html#cb104-2"></a><span class="st">  </span><span class="kw">accuracy</span>(google_<span class="dv">2015</span>, <span class="dt">by =</span> <span class="st">&quot;h&quot;</span>) <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb104-3"><a href="the-forecasters-toolbox.html#cb104-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> h, <span class="dt">y =</span> RMSE)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb104-4"><a href="the-forecasters-toolbox.html#cb104-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-41-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="forecasting-using-transformations" class="section level2">
<h2><span class="header-section-number">5.8</span> Forecasting using transformations</h2>
<p>Box cox transformation is mentioned at <a href="time-series-decomposition.html#box-cox">3.1.4</a>. When forecasting from a model with transformations, we first produce forecasts of the transformed data. Then, we need to reverse the transformation (or <em>back-transform</em>) to obtain forecasts on the original scale. The reverse Box-Cox transformation is given by</p>
<p><span class="math display">\[\begin{equation}
y_t =  
\begin{cases}
\exp{(w_t)} &amp; \text{if} \;\lambda = 0 \\
(\lambda w_t + 1)^{1/\lambda} &amp; \text{otherwise}
\end{cases}
\end{equation}\]</span></p>
<div id="prediction-intervals-with-transformations" class="section level3">
<h3><span class="header-section-number">5.8.1</span> Prediction intervals with transformations</h3>
<p>If a transformation has been used, then the prediction interval is first computed on the transformed scale, then the end points are back-transformed to give a prediction interval on the original scale. This approach preserves the probability coverage of the prediction interval, although it will no longer be symmetric around the point forecast.</p>
<p>The back-transformation of prediction intervals is done automatically for <strong>fable</strong> models, provided that you have used a transformation in the model formula.</p>
<p>Transformations sometimes make little difference to the point forecasts but have a large effect on prediction intervals.</p>
</div>
<div id="forecasting-with-constraints" class="section level3">
<h3><span class="header-section-number">5.8.2</span> Forecasting with constraints</h3>
<p>One common use of transformations is to ensure the forecasts remain on the appropriate scale. For example, log transformations constrain the forecasts to stay positive (because the back transformation is <span class="math inline">\(\exp(w_t)\)</span>).</p>
<p>Another useful transformation is the <strong>scaled logit</strong>, which can be used to ensure that the forecasts are kept within a specific interval. A scaled logit that ensures the forecasted values are between <span class="math inline">\(a\)</span>
and <span class="math inline">\(b\)</span> (where <span class="math inline">\(a &lt; b\)</span>) is given by:</p>
<p><span class="math display">\[
w_t = f(y_t) = \log{\frac{y_t -a}{b - y_t}}
\]</span></p>
<p>Inverting this transformation gives the appropriate back-transformation of:</p>
<p><span class="math display">\[
y_t = \frac{a + be^{w_t}}{1 + e^{w_t}} = \frac{(b - a)e^{w_t}}{1 + e^{w_t}} + a
\]</span></p>
<p>To use this transformation when modelling, we can create a new transformation with the <code>new_transformation()</code> function, which is essentially a <strong>function factory</strong>. This allows us to define two functions that accept the same parameters, where the observations are provided as the first argument. The first the argument of <code>new_transformation()</code>, <code>transformation</code> shoule be a function taht is used to transform the data, the second <code>inverse</code> is used to back-transform forecasts:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="the-forecasters-toolbox.html#cb105-1"></a>scaled_logit &lt;-<span class="st"> </span><span class="kw">new_transformation</span>(</span>
<span id="cb105-2"><a href="the-forecasters-toolbox.html#cb105-2"></a>  <span class="dt">transformation =</span> <span class="cf">function</span>(x, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>) {</span>
<span id="cb105-3"><a href="the-forecasters-toolbox.html#cb105-3"></a>    <span class="kw">log</span>(x <span class="op">-</span><span class="st"> </span>lower) <span class="op">/</span><span class="st"> </span>(upper <span class="op">-</span><span class="st"> </span>x)</span>
<span id="cb105-4"><a href="the-forecasters-toolbox.html#cb105-4"></a>  },</span>
<span id="cb105-5"><a href="the-forecasters-toolbox.html#cb105-5"></a>  <span class="dt">inverse =</span> <span class="cf">function</span>(x, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>) {</span>
<span id="cb105-6"><a href="the-forecasters-toolbox.html#cb105-6"></a>    (upper <span class="op">-</span><span class="st"> </span>lower) <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(x)) <span class="op">+</span><span class="st"> </span>lower</span>
<span id="cb105-7"><a href="the-forecasters-toolbox.html#cb105-7"></a>  }</span>
<span id="cb105-8"><a href="the-forecasters-toolbox.html#cb105-8"></a>)</span></code></pre></div>
<p>Take the beer data for example, suppose we want to constrain the forecast production of beer into a <span class="math inline">\((300, 400)\)</span> interval:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="the-forecasters-toolbox.html#cb106-1"></a>beer_production &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-2"><a href="the-forecasters-toolbox.html#cb106-2"></a><span class="st">  </span><span class="kw">filter_index</span>(<span class="st">&quot;1992 Q1&quot;</span> <span class="op">~</span><span class="st"> &quot;2006 Q4&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-3"><a href="the-forecasters-toolbox.html#cb106-3"></a><span class="st">  </span><span class="kw">select</span>(Quarter, Beer)</span>
<span id="cb106-4"><a href="the-forecasters-toolbox.html#cb106-4"></a></span>
<span id="cb106-5"><a href="the-forecasters-toolbox.html#cb106-5"></a></span>
<span id="cb106-6"><a href="the-forecasters-toolbox.html#cb106-6"></a>beer_production <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-7"><a href="the-forecasters-toolbox.html#cb106-7"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">SNAIVE</span>(<span class="kw">scaled_logit</span>(Beer, <span class="dv">300</span>, <span class="dv">400</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-8"><a href="the-forecasters-toolbox.html#cb106-8"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-9"><a href="the-forecasters-toolbox.html#cb106-9"></a><span class="st">  </span><span class="kw">autoplot</span>(beer_production, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb106-10"><a href="the-forecasters-toolbox.html#cb106-10"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Scaled logit transformation&quot;</span>)</span>
<span id="cb106-11"><a href="the-forecasters-toolbox.html#cb106-11"></a></span>
<span id="cb106-12"><a href="the-forecasters-toolbox.html#cb106-12"></a>beer_production <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-13"><a href="the-forecasters-toolbox.html#cb106-13"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">SNAIVE</span>(Beer)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-14"><a href="the-forecasters-toolbox.html#cb106-14"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-15"><a href="the-forecasters-toolbox.html#cb106-15"></a><span class="st">  </span><span class="kw">autoplot</span>(beer_production, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb106-16"><a href="the-forecasters-toolbox.html#cb106-16"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;No transformation&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-43-1.png" width="50%" /><img src="ch5_files/figure-html/unnamed-chunk-43-2.png" width="50%" /></p>
</div>
<div id="bias-adjustments" class="section level3">
<h3><span class="header-section-number">5.8.3</span> Bias adjustments</h3>
<p>One issue with using mathematical transformations such as Box-Cox transformations is that <strong>the back-transformed point forecast will not be the mean of the forecast distribution.</strong> In fact, it will usually be the median of the forecast distribution (assuming that the distribution on the transformed space is symmetric). For many purposes, this is acceptable, but occasionally the mean forecast is required. For example, you may wish to add up sales forecasts from various regions to form a forecast for the whole country. But medians do not add up, whereas means do. (the mean of multiple means is the mean of the whole)</p>
<p>For a Box-Cox transformation, the <strong>back-transformed mean</strong> is given by:</p>
<p><span class="math display" id="eq:bias-adjusted">\[\begin{equation}
y_t =           \tag{5.1}
\begin{cases}
\exp{(w_t)}[1 + \frac{\sigma_h^2}{2}] &amp; \text{if} \; \lambda = 0 \\
(\lambda w_t + 1)^{1/\lambda}[1 + \frac{\sigma_h^2{1 - \lambda}}{2(\lambda w_t + 1)^2}] &amp; \text{otherwise}
\end{cases}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\sigma_h^2\)</span> is the h-step forecast variance on the transformed scale. The larger the forecast variance, the bigger the difference between the mean and the median. Estimation of <span class="math inline">\(\sigma_h^2\)</span> is mentioned in <a href="the-forecasters-toolbox.html#predict-interval">5.5</a></p>
<p>The difference between the simple back-transformed forecast given by Equation <a href="time-series-decomposition.html#eq:box-cox">(3.1)</a> and the mean by equation <a href="the-forecasters-toolbox.html#eq:bias-adjusted">(5.1)</a> is called the <strong>bias</strong>. When we use the mean, rather than the median, we say the point forecasts have been <strong>bias-adjusted</strong>.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="the-forecasters-toolbox.html#cb107-1"></a>eggs &lt;-<span class="st"> </span>fma<span class="op">::</span>eggs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tsibble</span>()</span>
<span id="cb107-2"><a href="the-forecasters-toolbox.html#cb107-2"></a>eggs</span>
<span id="cb107-3"><a href="the-forecasters-toolbox.html#cb107-3"></a><span class="co">#&gt; # A tsibble: 94 x 2 [1Y]</span></span>
<span id="cb107-4"><a href="the-forecasters-toolbox.html#cb107-4"></a><span class="co">#&gt;   index value</span></span>
<span id="cb107-5"><a href="the-forecasters-toolbox.html#cb107-5"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb107-6"><a href="the-forecasters-toolbox.html#cb107-6"></a><span class="co">#&gt; 1  1900  277.</span></span>
<span id="cb107-7"><a href="the-forecasters-toolbox.html#cb107-7"></a><span class="co">#&gt; 2  1901  315.</span></span>
<span id="cb107-8"><a href="the-forecasters-toolbox.html#cb107-8"></a><span class="co">#&gt; 3  1902  315.</span></span>
<span id="cb107-9"><a href="the-forecasters-toolbox.html#cb107-9"></a><span class="co">#&gt; 4  1903  321.</span></span>
<span id="cb107-10"><a href="the-forecasters-toolbox.html#cb107-10"></a><span class="co">#&gt; 5  1904  315.</span></span>
<span id="cb107-11"><a href="the-forecasters-toolbox.html#cb107-11"></a><span class="co">#&gt; 6  1905  318.</span></span>
<span id="cb107-12"><a href="the-forecasters-toolbox.html#cb107-12"></a><span class="co">#&gt; # ... with 88 more rows</span></span>
<span id="cb107-13"><a href="the-forecasters-toolbox.html#cb107-13"></a></span>
<span id="cb107-14"><a href="the-forecasters-toolbox.html#cb107-14"></a>eggs_fit &lt;-<span class="st"> </span>eggs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">RW</span>(<span class="kw">log</span>(value) <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>()))</span>
<span id="cb107-15"><a href="the-forecasters-toolbox.html#cb107-15"></a></span>
<span id="cb107-16"><a href="the-forecasters-toolbox.html#cb107-16"></a>eggs_fc &lt;-<span class="st"> </span>eggs_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb107-17"><a href="the-forecasters-toolbox.html#cb107-17"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">50</span>) </span>
<span id="cb107-18"><a href="the-forecasters-toolbox.html#cb107-18"></a></span>
<span id="cb107-19"><a href="the-forecasters-toolbox.html#cb107-19"></a>eggs_fc_biased &lt;-<span class="st"> </span>eggs_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb107-20"><a href="the-forecasters-toolbox.html#cb107-20"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">50</span>) </span>
<span id="cb107-21"><a href="the-forecasters-toolbox.html#cb107-21"></a></span>
<span id="cb107-22"><a href="the-forecasters-toolbox.html#cb107-22"></a>eggs <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb107-23"><a href="the-forecasters-toolbox.html#cb107-23"></a><span class="st">  </span><span class="kw">autoplot</span>(value) <span class="op">+</span></span>
<span id="cb107-24"><a href="the-forecasters-toolbox.html#cb107-24"></a><span class="st">  </span><span class="kw">autolayer</span>(eggs_fc, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st">   </span></span>
<span id="cb107-25"><a href="the-forecasters-toolbox.html#cb107-25"></a><span class="st">  </span><span class="kw">autolayer</span>(eggs_fc_biased, <span class="dt">level =</span> <span class="ot">NULL</span>, <span class="dt">point_forecast =</span> <span class="kw">list</span>(<span class="dt">.median =</span> median)) </span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The blue line in shows the forecast medians while the red line shows the forecast means. Notice how the skewed forecast distribution pulls up the point forecast when we use the bias adjustment.</p>
<p><strong>Bias adjustments will be applied by default in the <code>fable</code> package</strong>. To produce point forecasts that are not bias adjusted (giving forecast medians rather than means), check the argument <code>point_forecast</code> in <code>forecast()</code>.</p>
</div>
</div>
<div id="forecasting-with-decomposition" class="section level2">
<h2><span class="header-section-number">5.9</span> Forecasting with decomposition</h2>
<p>Times series decomposition (discussed in Chpater <a href="time-series-decomposition.html#time-series-decomposition">3</a>) can be a useful step in producing forecasts.</p>
<p>Assuming an additive decomposition, the decomposed time series can be written as</p>
<p><span class="math display">\[
y_t = \hat{A}_t + \hat{S}_t
\]</span></p>
<p>where <span class="math inline">\(\hat{A}_t = \hat{T}_t + \hat{R}_t\)</span> is the seasonally adjusted component.</p>
<p>To forecast a decomposed time series, we forecast the seasonal component, <span class="math inline">\(\hat{S}_t\)</span>, and the seasonally adjusted component <span class="math inline">\(\hat{A}_t\)</span>, separately. It is usually assumed that the seasonal component is unchanging, or changing extremely slowly, so it is forecast by simply taking the last year of the estimated component. <strong>In other words, a seasonal naïve method is used for the seasonal component.</strong></p>
<p><strong>To forecast the seasonally adjusted component, any non-seasonal forecasting method may be used.</strong> For example, a random walk with drift model, or Holt’s method (discussed in Chapter 8), or a non-seasonal ARIMA model (discussed in Chapter 9), may be used.</p>
<div id="example-employment-in-the-us-retail-sector" class="section level3">
<h3><span class="header-section-number">5.9.1</span> Example: Employment in the US retail sector</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="the-forecasters-toolbox.html#cb108-1"></a>us_retail_employment &lt;-<span class="st"> </span>fpp3<span class="op">::</span>us_employment <span class="op">%&gt;%</span></span>
<span id="cb108-2"><a href="the-forecasters-toolbox.html#cb108-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">year</span>(Month) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1990</span>, Title <span class="op">==</span><span class="st"> &quot;Retail Trade&quot;</span>)</span>
<span id="cb108-3"><a href="the-forecasters-toolbox.html#cb108-3"></a></span>
<span id="cb108-4"><a href="the-forecasters-toolbox.html#cb108-4"></a>retail_employment_dcmp &lt;-<span class="st"> </span>us_retail_employment <span class="op">%&gt;%</span></span>
<span id="cb108-5"><a href="the-forecasters-toolbox.html#cb108-5"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">STL</span>(Employed <span class="op">~</span><span class="st"> </span><span class="kw">trend</span>(<span class="dt">window =</span> <span class="dv">7</span>), <span class="dt">robust =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb108-6"><a href="the-forecasters-toolbox.html#cb108-6"></a><span class="st">  </span><span class="kw">components</span>() <span class="op">%&gt;%</span></span>
<span id="cb108-7"><a href="the-forecasters-toolbox.html#cb108-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>.model)</span>
<span id="cb108-8"><a href="the-forecasters-toolbox.html#cb108-8"></a></span>
<span id="cb108-9"><a href="the-forecasters-toolbox.html#cb108-9"></a>retail_employment_dcmp <span class="op">%&gt;%</span></span>
<span id="cb108-10"><a href="the-forecasters-toolbox.html#cb108-10"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">NAIVE</span>(season_adjust)) <span class="op">%&gt;%</span></span>
<span id="cb108-11"><a href="the-forecasters-toolbox.html#cb108-11"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb108-12"><a href="the-forecasters-toolbox.html#cb108-12"></a><span class="st">  </span><span class="kw">autoplot</span>(retail_employment_dcmp) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;New orders index&quot;</span>) <span class="op">+</span></span>
<span id="cb108-13"><a href="the-forecasters-toolbox.html#cb108-13"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Naive forecasts of seasonally adjusted data&quot;</span>)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-45-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>This shows naïve forecasts of the seasonally adjusted electrical equipment orders data. These are then “reseasonalised” by adding in the seasonal naïve forecasts of the seasonal component.</p>
<p>This is made easy with the <code>decomposition_model()</code> model function, which allows you to compute forecasts via any additive decomposition, using other model functions to forecast each of the decomposition’s components. The first argument of <code>decomposition_model()</code> specifies a decomposition method we want to use, and the rest determines models on resulting components. Seasonal components of the model will be forecasted automatically using <code>SNAIVE()</code> if a different model isn’t specified. The function will also do the reseasonalising for you, <strong>ensuring that the resulting forecasts of the original data are shown</strong> below</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="the-forecasters-toolbox.html#cb109-1"></a>us_retail_employment <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb109-2"><a href="the-forecasters-toolbox.html#cb109-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="dt">stlf =</span> <span class="kw">decomposition_model</span>(</span>
<span id="cb109-3"><a href="the-forecasters-toolbox.html#cb109-3"></a>    <span class="kw">STL</span>(Employed <span class="op">~</span><span class="st"> </span><span class="kw">trend</span>(<span class="dt">window =</span> <span class="dv">7</span>), <span class="dt">robust =</span> <span class="ot">TRUE</span>),</span>
<span id="cb109-4"><a href="the-forecasters-toolbox.html#cb109-4"></a>    <span class="kw">RW</span>(season_adjust <span class="op">~</span><span class="st"> </span><span class="kw">drift</span>())</span>
<span id="cb109-5"><a href="the-forecasters-toolbox.html#cb109-5"></a>  )) <span class="op">%&gt;%</span></span>
<span id="cb109-6"><a href="the-forecasters-toolbox.html#cb109-6"></a><span class="st">  </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb109-7"><a href="the-forecasters-toolbox.html#cb109-7"></a><span class="st">  </span><span class="kw">autoplot</span>(us_retail_employment)</span></code></pre></div>
<p><img src="ch5_files/figure-html/unnamed-chunk-46-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The prediction intervals shown in this graph are constructed in the same way as the point forecasts. That is, the upper and lower limits of the prediction intervals on the seasonally adjusted data are “reseasonalised” by adding in the forecasts of the seasonal component.</p>
<p>As well as the drift method, any other appropriate forecasting method can be used to model the seasonally adjusted component.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series-features.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="judgmental-forecasts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/fpp/edit/master/ch5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
