<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 ARIMA models | Notes for “Forecasting: Principles and Practice, 3rd edition”</title>
  <meta name="description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 ARIMA models | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="github-repo" content="enixam/fpp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 ARIMA models | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  
  <meta name="twitter:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="univariate-stationary-processes.html"/>
<link rel="next" href="dynamic-regression-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for fpp3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a><ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-objects"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a><ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#manipulation"><i class="fa fa-check"></i><b>2.1.1</b> manipulation</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#importing"><i class="fa fa-check"></i><b>2.1.2</b> importing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plots"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#patterns-of-time-series-trend-seasonal-and-cyclic"><i class="fa fa-check"></i><b>2.3</b> Patterns of time series: trend, seasonal and cyclic</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a><ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods-period-in-gg_season"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods: <code>period</code> in <code>gg_season()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a><ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#visualization-between-time-series"><i class="fa fa-check"></i><b>2.6</b> Visualization between time series</a><ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.1</b> scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a><ul>
<li class="chapter" data-level="2.7.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.7.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.7.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.7.2</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#calendar-plots"><i class="fa fa-check"></i><b>2.8</b> Calendar plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a><ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformation-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformation and adjustments</a><ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#box-cox"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformation (Box-Cox)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.2</b> Moving averages</a><ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.2.1</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.2.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-component-with-seasonal-data"><i class="fa fa-check"></i><b>3.2.2</b> Estimating the trend-cycle component with seasonal data</a></li>
<li class="chapter" data-level="3.2.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.2.3</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.3</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#x11-decomposition"><i class="fa fa-check"></i><b>3.4</b> X11 decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seats-decomposition"><i class="fa fa-check"></i><b>3.5</b> SEATS decomposition</a></li>
<li class="chapter" data-level="3.6" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#stl-decomposition"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a><ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.3</b> STL features</a></li>
<li class="chapter" data-level="4.4" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="time-series-features.html"><a href="time-series-features.html#exporing-australian-tourism-data"><i class="fa fa-check"></i><b>4.5</b> Exporing Australian tourism data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a><ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a><ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualize"><i class="fa fa-check"></i><b>5.1.2</b> Visualize</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naive-method"><i class="fa fa-check"></i><b>5.2.2</b> Naive method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naive-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naive method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.5</b> Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.6</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.1</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a><ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#white-noise"><i class="fa fa-check"></i><b>5.4.1</b> White noise</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-the-google-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting the Google daily closing stock price</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#predict-interval"><i class="fa fa-check"></i><b>5.5</b> Prediction intervals</a><ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.1</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.3</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-model-accuracy"><i class="fa fa-check"></i><b>5.6</b> Evaluating model accuracy</a><ul>
<li class="chapter" data-level="5.6.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.6.1</b> Forecast errors</a></li>
<li class="chapter" data-level="5.6.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.6.2</b> Scale dependent errors</a></li>
<li class="chapter" data-level="5.6.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.6.3</b> Percentage errors</a></li>
<li class="chapter" data-level="5.6.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.6.4</b> Scaled errors</a></li>
<li class="chapter" data-level="5.6.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples-beer-production"><i class="fa fa-check"></i><b>5.6.5</b> Examples: beer production</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.7</b> Time series cross-validation</a><ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.7.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.8</b> Forecasting using transformations</a><ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-with-transformations"><i class="fa fa-check"></i><b>5.8.1</b> Prediction intervals with transformations</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-constraints"><i class="fa fa-check"></i><b>5.8.2</b> Forecasting with constraints</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#bias-adjustments"><i class="fa fa-check"></i><b>5.8.3</b> Bias adjustments</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.9</b> Forecasting with decomposition</a><ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>5.9.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a><ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a><ul>
<li class="chapter" data-level="6.3.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#experts-and-anonymity"><i class="fa fa-check"></i><b>6.3.1</b> Experts and anonymity</a></li>
<li class="chapter" data-level="6.3.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#setting-the-forecasting-task-in-a-delphi"><i class="fa fa-check"></i><b>6.3.2</b> Setting the forecasting task in a Delphi</a></li>
<li class="chapter" data-level="6.3.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#iteration"><i class="fa fa-check"></i><b>6.3.3</b> Iteration</a></li>
<li class="chapter" data-level="6.3.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#final-forecasts"><i class="fa fa-check"></i><b>6.3.4</b> Final forecasts</a></li>
<li class="chapter" data-level="6.3.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#limitations-and-variations"><i class="fa fa-check"></i><b>6.3.5</b> Limitations and variations</a></li>
<li class="chapter" data-level="6.3.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-facilitator"><i class="fa fa-check"></i><b>6.3.6</b> The facilitator</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a><ul>
<li class="chapter" data-level="6.6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#sales-force-composite"><i class="fa fa-check"></i><b>6.6.1</b> Sales force composite</a></li>
<li class="chapter" data-level="6.6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#executive-opinion"><i class="fa fa-check"></i><b>6.6.2</b> Executive opinion</a></li>
<li class="chapter" data-level="6.6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#customer-intentions"><i class="fa fa-check"></i><b>6.6.3</b> Customer intentions</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a><ul>
<li class="chapter" data-level="6.7.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#use-adjustments-sparingly"><i class="fa fa-check"></i><b>6.7.1</b> Use adjustments sparingly</a></li>
<li class="chapter" data-level="6.7.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#apply-a-structured-approach"><i class="fa fa-check"></i><b>6.7.2</b> Apply a structured approach</a></li>
<li class="chapter" data-level="6.7.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#example-tourism-forecasting-committee-tfc"><i class="fa fa-check"></i><b>6.7.3</b> Example: Tourism Forecasting Committee (TFC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a><ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a><ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness of fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-a-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating a regression model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.1</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.2</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.3</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-performance-package"><i class="fa fa-check"></i><b>7.3.4</b> The <code>performance</code> package</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.5</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>7.4.3</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
<li class="chapter" data-level="7.4.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#easter"><i class="fa fa-check"></i><b>7.4.7</b> Easter</a></li>
<li class="chapter" data-level="7.4.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fourier-sereis"><i class="fa fa-check"></i><b>7.4.8</b> Fourier sereis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a><ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusst-r-square"><i class="fa fa-check"></i><b>7.5.1</b> Adjusst R square</a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#which-measure-should-we-suse"><i class="fa fa-check"></i><b>7.5.5</b> Which measure should we suse</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-us-consumption"><i class="fa fa-check"></i><b>7.5.6</b> Example: US consumption</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#ex-ante-versus-ex-post-forecasts"><i class="fa fa-check"></i><b>7.6.1</b> Ex-ante versus ex-post forecasts</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-australian-quarterly-beer-production-1"><i class="fa fa-check"></i><b>7.6.2</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.6.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.3</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>7.6.4</b> Prediction intervals</a></li>
<li class="chapter" data-level="7.6.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#building-a-predictive-regression-model"><i class="fa fa-check"></i><b>7.6.5</b> Building a predictive regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#matrix-formulation"><i class="fa fa-check"></i><b>7.7</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.8</b> Nonlinear regression</a><ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.8.1</b> Forecasting with a nonlinear trend</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-boston-marathon-winning-times"><i class="fa fa-check"></i><b>7.8.2</b> Example: Boston marathon winning times</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.9</b> Correlation, causation and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a><ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a><ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>8.1.4</b> Estimation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend-and-seasonality"><i class="fa fa-check"></i><b>8.2</b> Methods with trend and seasonality</a><ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population"><i class="fa fa-check"></i><b>8.2.2</b> Example: Australian population</a></li>
<li class="chapter" data-level="8.2.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.3</b> Damped trend methods</a></li>
<li class="chapter" data-level="8.2.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population-continued"><i class="fa fa-check"></i><b>8.2.4</b> Example: Australian Population (continued)</a></li>
<li class="chapter" data-level="8.2.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-internet-usage"><i class="fa fa-check"></i><b>8.2.5</b> Example: Internet usage</a></li>
<li class="chapter" data-level="8.2.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.2.6</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.2.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.2.7</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.2.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.2.8</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.2.9" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.2.9</b> Holt-Winters’ damped method</a></li>
<li class="chapter" data-level="8.2.10" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-holt-winters-method-with-daily-data"><i class="fa fa-check"></i><b>8.2.10</b> Example: Holt-Winters method with daily data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.3</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.4</b> Innovations state space models for exponential smoothing</a><ul>
<li class="chapter" data-level="8.4.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-simple-exponential-smoothing-with-additive-errors"><i class="fa fa-check"></i><b>8.4.1</b> ETS(A,N,N): simple exponential smoothing with additive errors</a></li>
<li class="chapter" data-level="8.4.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmnn-simple-exponential-smoothing-with-multiplicative-errors"><i class="fa fa-check"></i><b>8.4.2</b> ETS(M,N,N): simple exponential smoothing with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan-holts-linear-method-with-additive-errors"><i class="fa fa-check"></i><b>8.4.3</b> ETS(A,A,N): Holt’s linear method with additive errors</a></li>
<li class="chapter" data-level="8.4.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#ets-man"><i class="fa fa-check"></i><b>8.4.4</b> ETS(M,A,N): Holt’s linear method with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#other-ets-models"><i class="fa fa-check"></i><b>8.4.5</b> Other ETS models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.5</b> Estimation and model selection</a><ul>
<li class="chapter" data-level="8.5.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimating-ets-models"><i class="fa fa-check"></i><b>8.5.1</b> Estimating ETS models</a></li>
<li class="chapter" data-level="8.5.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection-criteria"><i class="fa fa-check"></i><b>8.5.2</b> Model selection criteria</a></li>
<li class="chapter" data-level="8.5.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.5.3</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.6</b> Forecasting with ETS models</a><ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australia-gas-production"><i class="fa fa-check"></i><b>8.6.1</b> Example: Australia gas production</a></li>
<li class="chapter" data-level="8.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>8.6.2</b> Prediction intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html"><i class="fa fa-check"></i><b>9</b> Univariate stationary processes</a><ul>
<li class="chapter" data-level="9.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#stationarity"><i class="fa fa-check"></i><b>9.1</b> Stationarity</a><ul>
<li class="chapter" data-level="9.1.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#ch9-white-noise"><i class="fa fa-check"></i><b>9.1.1</b> White noise</a></li>
<li class="chapter" data-level="9.1.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#tests-for-autocorrelation-and-normality"><i class="fa fa-check"></i><b>9.1.2</b> Tests for autocorrelation and normality</a></li>
<li class="chapter" data-level="9.1.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#the-wold-decomposition"><i class="fa fa-check"></i><b>9.1.3</b> The Wold Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#autoregressive-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a><ul>
<li class="chapter" data-level="9.3.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#stimulating-an-arp-process"><i class="fa fa-check"></i><b>9.3.1</b> Stimulating an AR(p) process</a></li>
<li class="chapter" data-level="9.3.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#decision-of-order-p"><i class="fa fa-check"></i><b>9.3.2</b> Decision of order p</a></li>
<li class="chapter" data-level="9.3.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#random-walk"><i class="fa fa-check"></i><b>9.3.3</b> Random walk</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#simulating-an-maq-process"><i class="fa fa-check"></i><b>9.4.1</b> Simulating an MA(q) process</a></li>
<li class="chapter" data-level="9.4.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#decision-of-order-q"><i class="fa fa-check"></i><b>9.4.2</b> Decision of order q</a></li>
<li class="chapter" data-level="9.4.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#koyck-transformation-and-invertibility"><i class="fa fa-check"></i><b>9.4.3</b> Koyck transformation and Invertibility</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#arma-models"><i class="fa fa-check"></i><b>9.5</b> ARMA models</a><ul>
<li class="chapter" data-level="9.5.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#three-representations-of-an-arma-model"><i class="fa fa-check"></i><b>9.5.1</b> Three representations of an ARMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>10</b> ARIMA models</a><ul>
<li class="chapter" data-level="10.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>10.1</b> Differencing</a><ul>
<li class="chapter" data-level="10.1.1" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>10.1.1</b> Second-order differencing</a></li>
<li class="chapter" data-level="10.1.2" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>10.1.2</b> Seasonal differencing</a></li>
<li class="chapter" data-level="10.1.3" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>10.1.3</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>10.2</b> Non-seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.2.1" data-path="arima-models.html"><a href="arima-models.html#understanding-arima-models"><i class="fa fa-check"></i><b>10.2.1</b> Understanding ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>10.3</b> Estimation and order selection</a><ul>
<li class="chapter" data-level="10.3.1" data-path="arima-models.html"><a href="arima-models.html#mle"><i class="fa fa-check"></i><b>10.3.1</b> MLE</a></li>
<li class="chapter" data-level="10.3.2" data-path="arima-models.html"><a href="arima-models.html#information-criteria"><i class="fa fa-check"></i><b>10.3.2</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="arima-models.html"><a href="arima-models.html#the-arima-function"><i class="fa fa-check"></i><b>10.4</b> The <code>ARIMA()</code> function</a><ul>
<li class="chapter" data-level="10.4.1" data-path="arima-models.html"><a href="arima-models.html#algorithm"><i class="fa fa-check"></i><b>10.4.1</b> Algorithm</a></li>
<li class="chapter" data-level="10.4.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>10.4.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="10.4.3" data-path="arima-models.html"><a href="arima-models.html#example-seasonally-adjusted-electrical-equipment-orders"><i class="fa fa-check"></i><b>10.4.3</b> Example: Seasonally adjusted electrical equipment orders</a></li>
<li class="chapter" data-level="10.4.4" data-path="arima-models.html"><a href="arima-models.html#plotting-the-characteristic-roots"><i class="fa fa-check"></i><b>10.4.4</b> Plotting the characteristic roots</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="arima-models.html"><a href="arima-models.html#forecasting-with-arima-models"><i class="fa fa-check"></i><b>10.5</b> Forecasting with ARIMA models</a><ul>
<li class="chapter" data-level="10.5.1" data-path="arima-models.html"><a href="arima-models.html#point-forecasts"><i class="fa fa-check"></i><b>10.5.1</b> Point forecasts</a></li>
<li class="chapter" data-level="10.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>10.5.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>10.6</b> Seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.6.1" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf"><i class="fa fa-check"></i><b>10.6.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="10.6.2" data-path="arima-models.html"><a href="arima-models.html#example-european-quarterly-retail-trade"><i class="fa fa-check"></i><b>10.6.2</b> Example: European quarterly retail trade</a></li>
<li class="chapter" data-level="10.6.3" data-path="arima-models.html"><a href="arima-models.html#example-corticosteroid-drug-sales-in-australia"><i class="fa fa-check"></i><b>10.6.3</b> Example: Corticosteroid drug sales in Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="arima-models.html"><a href="arima-models.html#ets-and-arima"><i class="fa fa-check"></i><b>10.7</b> ETS and ARIMA</a><ul>
<li class="chapter" data-level="10.7.1" data-path="arima-models.html"><a href="arima-models.html#example-comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>10.7.1</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="10.7.2" data-path="arima-models.html"><a href="arima-models.html#example-comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>10.7.2</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>11</b> Dynamic regression models</a><ul>
<li class="chapter" data-level="11.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>11.1</b> Estimation</a></li>
<li class="chapter" data-level="11.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors"><i class="fa fa-check"></i><b>11.2</b> Regression with ARIMA errors</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>11.2.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting"><i class="fa fa-check"></i><b>11.3</b> Forecasting</a><ul>
<li class="chapter" data-level="11.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>11.3.1</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#deterministic-and-stochastic-trends"><i class="fa fa-check"></i><b>11.4</b> Deterministic and stochastic trends</a><ul>
<li class="chapter" data-level="11.4.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-international-visitors-to-australia"><i class="fa fa-check"></i><b>11.4.1</b> Example: International visitors to Australia</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>11.5</b> Dynamic harmonic regression</a><ul>
<li class="chapter" data-level="11.5.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>11.5.1</b> Example: Australian eating out expenditure</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>11.6</b> Lagged predictors</a><ul>
<li class="chapter" data-level="11.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>11.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for “Forecasting: Principles and Practice, 3rd edition”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="arima-models" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> ARIMA models</h1>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="arima-models.html#cb178-1"></a><span class="kw">library</span>(tsibble)</span>
<span id="cb178-2"><a href="arima-models.html#cb178-2"></a><span class="kw">library</span>(tsibbledata)</span>
<span id="cb178-3"><a href="arima-models.html#cb178-3"></a><span class="kw">library</span>(fable)</span>
<span id="cb178-4"><a href="arima-models.html#cb178-4"></a><span class="kw">library</span>(feasts)</span>
<span id="cb178-5"><a href="arima-models.html#cb178-5"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb178-6"><a href="arima-models.html#cb178-6"></a><span class="kw">library</span>(pins)</span>
<span id="cb178-7"><a href="arima-models.html#cb178-7"></a><span class="kw">library</span>(slider)</span></code></pre></div>
<div id="differencing" class="section level2">
<h2><span class="header-section-number">10.1</span> Differencing</h2>
<p>All processes (AR, MA, ARMA) disscussed in Chapter <a href="univariate-stationary-processes.html#univariate-stationary-processes">9</a> belong to a larger family called <em>linear stationary processes</em>. This means our models would normally be confined to a stataionry data-generating system.</p>
<p>By <strong>differencing</strong>, we compute the differences between consecutive observations, and this has been shown as a easy but effective way to make a non-stationary time series stationary. While transformations such as logarithms can help to stabilise the variance of a time series, differencing can help stabilise the mean of a time series by removing changes in the level of a time series, and therefore eliminating (or reducing) trend and seasonality.</p>
<p>Suppose there is a undelying linear trend behind the observed time series
<span class="math display">\[
y_t = \beta_0 + \beta_1t + \varepsilon_t  
\]</span>
where <span class="math inline">\(\varepsilon_t\)</span> is white noise. The first difference is defined as</p>
<p>$$
\begin{split}
y’<em>t &amp;= y_t - y</em>{t-1} \
&amp;= (_0 + _1t + _t) - [_0 + <em>1(t-1) + </em>{t-1}] \
&amp;= _1 + (<em>t - </em>{t-1})</p>
<p>\end{split}
$$</p>
<p>Note that <span class="math inline">\(y&#39;_t\)</span> satisfies all stationary conditions, <span class="math inline">\(\text{E}(y&#39;_t) =0\)</span>, <span class="math inline">\(\text{Var}(y&#39;_t) = 2\sigma^2\)</span>, <span class="math inline">\(\text{Cov}(y&#39;_t, y&#39;_{t+k}) = 0\)</span>. So it can be modelled as previously discussed.</p>
<p>Another example is a (biased) random walk process <a href="univariate-stationary-processes.html#random-walk">9.3.3</a>, where the first difference is</p>
<p><span class="math display">\[
y&#39;_t = c + \varepsilon_t
\]</span></p>
<div id="second-order-differencing" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Second-order differencing</h3>
<p>Occasionally the differenced data will not appear to be stationary and it may be necessary to difference the data a second time to obtain a stationary series:</p>
<p><span class="math display">\[
\begin{aligned}
y&#39;&#39;_t &amp;= (y_t - y_{t-1}) - (y_{t-1} - y_{t-2}) \\
      &amp;= y_t - 2y_{t-1} +  y_{t-2}
\end{aligned}
\]</span>
In practice, it is almost never necessary to go beyond second-order differences.</p>
</div>
<div id="seasonal-differencing" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Seasonal differencing</h3>
<p>A seasonal difference is the difference between an observation and the previous observation from the same season. So</p>
<p><span class="math display">\[
y&#39;_t = y_t - y_{t-m}
\]</span></p>
<p>If seasonally differenced data appear to be white noise, then an appropriate model for the original data is</p>
<p><span class="math display">\[
y_t = y_{t-m} + \varepsilon_t
\]</span>
Forecasts from this model are equal to the last observation from the relevant season. That is, this model gives seasonal naïve forecasts, introduced in Section <a href="the-forecasters-toolbox.html#some-simple-forecasting-methods">5.2</a>.</p>
<p>And second seasonal difference is</p>
<p><span class="math display">\[
\begin{split}
y&#39;&#39;_t &amp;= y&#39;t - y&#39;_{t-1} \\
      &amp;= (y_t - y_{t-m}) - (y_{t-1} - y_{t-1-m}) \\ 
      &amp;= y_t - y_{t-1} - y_{t-m} + y_{t-1-m}
\end{split}
\]</span></p>
<p>When both seasonal and first differences are applied, it makes no difference which is done first—the result will be the same. However, <strong>if the data have a strong seasonal pattern, it is recommended that seasonal differencing be done first</strong>, because the resulting series will sometimes be stationary and there will be no need for a further first difference. If first differencing is done first, there will still be seasonality present.</p>
<p>Sometimes it is necessary to take both a seasonal difference and a first difference to obtain stationary data, as is shown below. Here, the data are first transformed using logarithms (second panel), then seasonal differences are calculated (third panel). The data still seem somewhat non-stationary, and so a further lot of first differences are computed (bottom panel).</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="arima-models.html#cb179-1"></a>PBS <span class="op">%&gt;%</span></span>
<span id="cb179-2"><a href="arima-models.html#cb179-2"></a><span class="st">  </span><span class="kw">filter</span>(ATC2 <span class="op">==</span><span class="st"> &quot;H02&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb179-3"><a href="arima-models.html#cb179-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Cost =</span> <span class="kw">sum</span>(Cost) <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>) <span class="op">%&gt;%</span></span>
<span id="cb179-4"><a href="arima-models.html#cb179-4"></a><span class="st">  </span><span class="kw">transmute</span>(</span>
<span id="cb179-5"><a href="arima-models.html#cb179-5"></a>     <span class="dt">sales =</span> Cost,</span>
<span id="cb179-6"><a href="arima-models.html#cb179-6"></a>     <span class="dt">sales_log =</span> <span class="kw">log</span>(Cost),</span>
<span id="cb179-7"><a href="arima-models.html#cb179-7"></a>     <span class="dt">seasonal_difference =</span> <span class="kw">log</span>(Cost) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(<span class="dt">lag =</span> <span class="dv">12</span>),</span>
<span id="cb179-8"><a href="arima-models.html#cb179-8"></a>     <span class="dt">double_difference =</span> <span class="kw">log</span>(Cost) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(<span class="dt">lag =</span> <span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(<span class="dt">lag =</span> <span class="dv">1</span>)</span>
<span id="cb179-9"><a href="arima-models.html#cb179-9"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb179-10"><a href="arima-models.html#cb179-10"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>Month, <span class="dt">names_to =</span> <span class="st">&quot;measure&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb179-11"><a href="arima-models.html#cb179-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">measure =</span> <span class="kw">fct_relevel</span>(measure, </span>
<span id="cb179-12"><a href="arima-models.html#cb179-12"></a>                               <span class="kw">c</span>(<span class="st">&quot;sales&quot;</span>, </span>
<span id="cb179-13"><a href="arima-models.html#cb179-13"></a>                                 <span class="st">&quot;sales_log&quot;</span>, </span>
<span id="cb179-14"><a href="arima-models.html#cb179-14"></a>                                 <span class="st">&quot;seasonal_difference&quot;</span>, </span>
<span id="cb179-15"><a href="arima-models.html#cb179-15"></a>                                 <span class="st">&quot;double_difference&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb179-16"><a href="arima-models.html#cb179-16"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb179-17"><a href="arima-models.html#cb179-17"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(Month, value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb179-18"><a href="arima-models.html#cb179-18"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>measure, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb179-19"><a href="arima-models.html#cb179-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Corticosteroid drug sales&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="unit-root-tests" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Unit root tests</h3>
<p>One way to determine more objectively whether differencing is required is to use a <strong>unit root test</strong>. These are statistical hypothesis tests of stationarity that are designed for determining whether differencing is required.</p>
<p>A number of unit root tests are available, which are based on different assumptions and may lead to conflicting answers. Here we use the Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test implemented by <code>urca::ur.kpss()</code>. In this test, the null hypothesis is that the data are stationary, and we look for evidence that the null hypothesis is false. Consequently, small p-values suggest that differencing is required.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="arima-models.html#cb180-1"></a>google_<span class="dv">2015</span> &lt;-<span class="st"> </span>gafa_stock <span class="op">%&gt;%</span></span>
<span id="cb180-2"><a href="arima-models.html#cb180-2"></a><span class="st">  </span><span class="kw">filter</span>(Symbol <span class="op">==</span><span class="st"> &quot;GOOG&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb180-3"><a href="arima-models.html#cb180-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">day =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span></span>
<span id="cb180-4"><a href="arima-models.html#cb180-4"></a><span class="st">  </span><span class="kw">update_tsibble</span>(<span class="dt">index =</span> day, <span class="dt">regular =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb180-5"><a href="arima-models.html#cb180-5"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">year</span>(Date) <span class="op">==</span><span class="st"> </span><span class="dv">2015</span>)</span>
<span id="cb180-6"><a href="arima-models.html#cb180-6"></a></span>
<span id="cb180-7"><a href="arima-models.html#cb180-7"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb180-8"><a href="arima-models.html#cb180-8"></a><span class="st">  </span><span class="kw">features</span>(Close, unitroot_kpss)</span>
<span id="cb180-9"><a href="arima-models.html#cb180-9"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb180-10"><a href="arima-models.html#cb180-10"></a><span class="co">#&gt;   Symbol kpss_stat kpss_pvalue</span></span>
<span id="cb180-11"><a href="arima-models.html#cb180-11"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb180-12"><a href="arima-models.html#cb180-12"></a><span class="co">#&gt; 1 GOOG        3.56        0.01</span></span></code></pre></div>
<p>The test statistic is much bigger than the 1% critical value, indicating that the null hypothesis is rejected. That is, the data are not stationary. We can difference the data, and apply the test again.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="arima-models.html#cb181-1"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span></span>
<span id="cb181-2"><a href="arima-models.html#cb181-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Close =</span> <span class="kw">difference</span>(Close, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb181-3"><a href="arima-models.html#cb181-3"></a><span class="st">  </span><span class="kw">features</span>(Close, unitroot_kpss)</span>
<span id="cb181-4"><a href="arima-models.html#cb181-4"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb181-5"><a href="arima-models.html#cb181-5"></a><span class="co">#&gt;   Symbol kpss_stat kpss_pvalue</span></span>
<span id="cb181-6"><a href="arima-models.html#cb181-6"></a><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span id="cb181-7"><a href="arima-models.html#cb181-7"></a><span class="co">#&gt; 1 GOOG      0.0989         0.1</span></span></code></pre></div>
<p>This time, the test statistic is tiny, and well within the range we would expect for stationary data. So we can conclude that the differenced data are stationary.</p>
<p>This process of using a sequence of KPSS tests to determine the appropriate number of first differences is carried out using the <code>unitroot_ndiffs()</code> feature.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="arima-models.html#cb182-1"></a><span class="co"># 1st difference is needed</span></span>
<span id="cb182-2"><a href="arima-models.html#cb182-2"></a>google_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb182-3"><a href="arima-models.html#cb182-3"></a><span class="st">  </span><span class="kw">features</span>(Close, unitroot_ndiffs)</span>
<span id="cb182-4"><a href="arima-models.html#cb182-4"></a><span class="co">#&gt; # A tibble: 1 x 2</span></span>
<span id="cb182-5"><a href="arima-models.html#cb182-5"></a><span class="co">#&gt;   Symbol ndiffs</span></span>
<span id="cb182-6"><a href="arima-models.html#cb182-6"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt;</span></span>
<span id="cb182-7"><a href="arima-models.html#cb182-7"></a><span class="co">#&gt; 1 GOOG        1</span></span></code></pre></div>
<p>A similar feature for determining whether seasonal differencing is required is <code>unitroot_nsdiffs()</code>, which uses the measure of seasonal strength introduced in Section <a href="time-series-features.html#stl-features">4.3</a>. Recall that the strength of seasonality <span class="math inline">\(F_s\)</span> is defined as</p>
<p><span class="math display">\[
F_S = \max(0\,, 1- \frac{\text{Var}(R_t)}{\text{Var}(S_t + R_t)})
\]</span>
where <span class="math inline">\(R_t\)</span> is the remainder component and <span class="math inline">\(S_t\)</span> the seasonal component. No seasonal differences are suggested if <span class="math inline">\(F_S &lt; 0.64\)</span>, otherwise one seasonal difference is suggested.</p>
<p>We can apply <code>unitroot_nsdiffs()</code> to the monthly total Australian retail turnover.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="arima-models.html#cb183-1"></a>aus_total_retail &lt;-<span class="st"> </span>aus_retail <span class="op">%&gt;%</span></span>
<span id="cb183-2"><a href="arima-models.html#cb183-2"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Turnover =</span> <span class="kw">sum</span>(Turnover))</span>
<span id="cb183-3"><a href="arima-models.html#cb183-3"></a>aus_total_retail <span class="op">%&gt;%</span></span>
<span id="cb183-4"><a href="arima-models.html#cb183-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_turnover =</span> <span class="kw">log</span>(Turnover)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb183-5"><a href="arima-models.html#cb183-5"></a><span class="st">  </span><span class="kw">features</span>(log_turnover, unitroot_nsdiffs)</span>
<span id="cb183-6"><a href="arima-models.html#cb183-6"></a><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span id="cb183-7"><a href="arima-models.html#cb183-7"></a><span class="co">#&gt;   nsdiffs</span></span>
<span id="cb183-8"><a href="arima-models.html#cb183-8"></a><span class="co">#&gt;     &lt;int&gt;</span></span>
<span id="cb183-9"><a href="arima-models.html#cb183-9"></a><span class="co">#&gt; 1       1</span></span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="arima-models.html#cb184-1"></a>aus_total_retail <span class="op">%&gt;%</span></span>
<span id="cb184-2"><a href="arima-models.html#cb184-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_turnover =</span> <span class="kw">log</span>(Turnover) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(<span class="dv">12</span>)) <span class="op">%&gt;%</span></span>
<span id="cb184-3"><a href="arima-models.html#cb184-3"></a><span class="st">  </span><span class="kw">features</span>(log_turnover, unitroot_ndiffs)</span>
<span id="cb184-4"><a href="arima-models.html#cb184-4"></a><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span id="cb184-5"><a href="arima-models.html#cb184-5"></a><span class="co">#&gt;   ndiffs</span></span>
<span id="cb184-6"><a href="arima-models.html#cb184-6"></a><span class="co">#&gt;    &lt;int&gt;</span></span>
<span id="cb184-7"><a href="arima-models.html#cb184-7"></a><span class="co">#&gt; 1      1</span></span></code></pre></div>
<p>Because <code>unitroot_nsdiffs()</code> returns 1 (indicating one seasonal difference is required), we apply the <code>unitroot_ndiffs()</code> function to the seasonally differenced data. These functions suggest we should do both a seasonal difference and a first difference.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="arima-models.html#cb185-1"></a>aus_total_retail <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb185-2"><a href="arima-models.html#cb185-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_turnover =</span> <span class="kw">log</span>(Turnover) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb185-3"><a href="arima-models.html#cb185-3"></a><span class="st">           </span><span class="kw">difference</span>(<span class="dv">12</span>) <span class="op">%&gt;%</span></span>
<span id="cb185-4"><a href="arima-models.html#cb185-4"></a><span class="st">           </span><span class="kw">difference</span>(<span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb185-5"><a href="arima-models.html#cb185-5"></a><span class="st">  </span><span class="kw">autoplot</span>(log_turnover)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="non-seasonal-arima-models" class="section level2">
<h2><span class="header-section-number">10.2</span> Non-seasonal ARIMA models</h2>
<p>If we combine differencing with autoregression and a moving average model, we obtain a non-seasonal ARIMA model. ARIMA is an acronym for <strong>A</strong>uto<strong>R</strong>egressive <strong>I</strong>ntegrated <strong>M</strong>oving <strong>A</strong>verage (in this context, “integration” is the reverse of differencing). The full model can be written as</p>
<p><span class="math display" id="eq:arima">\[\begin{equation}
\tag{10.1}
y&#39;_t =c + \phi_1y_{t-1} + \cdots + \phi_py_{t-p} + \theta_1\varepsilon_{t-1} + \cdots \theta_q\varepsilon_{t-q} + \varepsilon_t  
\end{equation}\]</span></p>
<p>We call this an ARIMA(p, d, q) model, where
<span class="math display">\[
\begin{aligned}
p &amp;= \text{order of the autoregressive part} \\
d &amp;= \text{degree of first differencing involved} \\
q &amp;= \text{order of the moving average part}
\end{aligned}
\]</span></p>
<p>The same stationarity and invertibility conditions that are used for autoregressive and moving average models also apply to an ARIMA model.</p>
<p>Many of the models we have already discussed are special cases of the ARIMA model</p>
<p><img src="images/arima_special.png" width="100%" style="display: block; margin: auto;" />
Once we start combining components in this way to form more complicated models, it is much easier to work with the backshift notation. For example, Equation <a href="arima-models.html#eq:arima">(10.1)</a> can be written in backshift notation as</p>
<p><span class="math display">\[
(1 - \phi_1B - \cdots - \phi_pB^p)(1 - B)^dy_t = c + (1 + \theta_1B + \cdots + \theta_1B^q)\varepsilon_t
\]</span></p>
<div id="understanding-arima-models" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Understanding ARIMA models</h3>
<p>The constant <span class="math inline">\(c\)</span> has an important effect on the long-term forecasts obtained from these models.</p>
<ul>
<li><p>If <span class="math inline">\(c = 0\)</span> and <span class="math inline">\(d = 0\)</span> , the long-term forecasts will go to zero.</p></li>
<li><p>If <span class="math inline">\(c = 0\)</span> and <span class="math inline">\(d = 1\)</span>, the long-term forecasts will go to a non-zero constant.</p></li>
<li><p>If <span class="math inline">\(c = 0\)</span> and <span class="math inline">\(d = 2\)</span>, the long-term forecasts will follow a straight line.</p></li>
<li><p>If <span class="math inline">\(c \not= 0\)</span> and <span class="math inline">\(d = 0\)</span>, the long-term forecasts will go to the mean of the data.</p></li>
<li><p>If <span class="math inline">\(c \not= 0\)</span> and <span class="math inline">\(d = 1\)</span> , the long-term forecasts will follow a straight line.</p></li>
<li><p>If <span class="math inline">\(c \not= 0\)</span> and <span class="math inline">\(d = 2\)</span>, the long-term forecasts will follow a quadratic trend.</p></li>
</ul>
<p>The value of <span class="math inline">\(d\)</span> also has an effect on the prediction intervals — the higher the value of <span class="math inline">\(d\)</span>, the more rapidly the prediction intervals increase in size. For <span class="math inline">\(d = 0\)</span>, the long-term forecast standard deviation will go to the standard deviation of the historical data, so the prediction intervals will all be essentially the same.</p>
<p>In the case of <code>us_change_fit</code>, <span class="math inline">\(c \not= 0\)</span> and <span class="math inline">\(d = 0\)</span>, long-term forecasts go to the mean of the data.</p>
<p>The value of <span class="math inline">\(p\)</span> is important if the data show cycles. To obtain cyclic forecasts, it is necessary to have <span class="math inline">\(p \ge 2\)</span>, along with some additional conditions on the parameters. For an AR(2) model, cyclic behaviour occurs if <span class="math inline">\(\phi_1^2 + 4\phi_2&lt;0\)</span>. In that case, the average period of the cycles is</p>
<p><span class="math display">\[
\frac{2\pi}{\arccos[-\phi_1(1 - \phi_2) / 4\phi_2]}
\]</span></p>
</div>
</div>
<div id="estimation-and-order-selection" class="section level2">
<h2><span class="header-section-number">10.3</span> Estimation and order selection</h2>
<p>Recall how ACF and PACF plot would help us pick an appropriate AR(p) or MA(q) model.
<img src="images/AR_MA_decision.png" width="100%" style="display: block; margin: auto;" /></p>
<p>However, for ARIMA models, <strong>ACF and PACF plots are only helpful when one of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> is zero</strong>. If <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> are both positive, then the plots do not help in finding suitable values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. (Think of an ARMA(p, q) process, neither its autocorrelation nor its partial autocorrelation function breaks off)</p>
<p>The data may follow an ARIMA(p, d, 0) model if the ACF and PACF plots of the differenced data show the following patterns:</p>
<ul>
<li><p>the ACF is exponentially decaying or sinusoidal;</p></li>
<li><p>there is a significant spike at lag p in the PACF, but none beyond lag p</p></li>
</ul>
<p>The <code>us_change</code> data may follow an ARIMA(0, d, q) model if the ACF and PACF plots of the differenced data show the following patterns:</p>
<ul>
<li><p>the PACF is exponentially decaying or sinusoidal;</p></li>
<li><p>there is a significant spike at lag q in the ACF, but none beyond lag q.</p></li>
</ul>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="arima-models.html#cb186-1"></a>us_change &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://otexts.com/fpp3/extrafiles/us_change.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb186-2"><a href="arima-models.html#cb186-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">time =</span> <span class="kw">yearquarter</span>(Time)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb186-3"><a href="arima-models.html#cb186-3"></a><span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> time)  </span>
<span id="cb186-4"><a href="arima-models.html#cb186-4"></a></span>
<span id="cb186-5"><a href="arima-models.html#cb186-5"></a>us_change <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(Consumption) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span>
<span id="cb186-6"><a href="arima-models.html#cb186-6"></a>us_change <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(Consumption) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-12-1.png" width="50%" /><img src="ch9_files/figure-html/unnamed-chunk-12-2.png" width="50%" /></p>
<p>The pattern in the first three spikes is what we would expect from an ARIMA(3, 0, 0), as the PACF tends to decrease. So in this case, the ACF and PACF lead us to think an ARIMA(3, 0, 0) model might be appropriate.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="arima-models.html#cb187-1"></a>us_change_fit2 &lt;-<span class="st"> </span>us_change <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb187-2"><a href="arima-models.html#cb187-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(Consumption <span class="op">~</span><span class="st"> </span><span class="kw">PDQ</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>)))</span>
<span id="cb187-3"><a href="arima-models.html#cb187-3"></a></span>
<span id="cb187-4"><a href="arima-models.html#cb187-4"></a>us_change_fit2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb187-5"><a href="arima-models.html#cb187-5"></a><span class="co">#&gt; Series: Consumption </span></span>
<span id="cb187-6"><a href="arima-models.html#cb187-6"></a><span class="co">#&gt; Model: ARIMA(3,0,0) w/ mean </span></span>
<span id="cb187-7"><a href="arima-models.html#cb187-7"></a><span class="co">#&gt; </span></span>
<span id="cb187-8"><a href="arima-models.html#cb187-8"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb187-9"><a href="arima-models.html#cb187-9"></a><span class="co">#&gt;          ar1     ar2     ar3  constant</span></span>
<span id="cb187-10"><a href="arima-models.html#cb187-10"></a><span class="co">#&gt;       0.2274  0.1604  0.2027    0.3050</span></span>
<span id="cb187-11"><a href="arima-models.html#cb187-11"></a><span class="co">#&gt; s.e.  0.0713  0.0723  0.0712    0.0421</span></span>
<span id="cb187-12"><a href="arima-models.html#cb187-12"></a><span class="co">#&gt; </span></span>
<span id="cb187-13"><a href="arima-models.html#cb187-13"></a><span class="co">#&gt; sigma^2 estimated as 0.3494:  log likelihood=-165.17</span></span>
<span id="cb187-14"><a href="arima-models.html#cb187-14"></a><span class="co">#&gt; AIC=340.34   AICc=340.67   BIC=356.5</span></span></code></pre></div>
<p>This model is actually slightly better than the model identified by <code>ARIMA()</code> (with an AICc value of 340.67 compared to 342.08). The <code>ARIMA()</code> function did not find this model because it does not consider all possible models in its search. Use <code>stepwise = FALSE</code> and <code>approximation = FALSE</code> to expand search region</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="arima-models.html#cb188-1"></a>us_change_fit3 &lt;-<span class="st"> </span>us_change <span class="op">%&gt;%</span></span>
<span id="cb188-2"><a href="arima-models.html#cb188-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(Consumption <span class="op">~</span><span class="st"> </span><span class="kw">PDQ</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb188-3"><a href="arima-models.html#cb188-3"></a>              <span class="dt">stepwise =</span> <span class="ot">FALSE</span>, </span>
<span id="cb188-4"><a href="arima-models.html#cb188-4"></a>              <span class="dt">approximation =</span> <span class="ot">FALSE</span>))</span>
<span id="cb188-5"><a href="arima-models.html#cb188-5"></a></span>
<span id="cb188-6"><a href="arima-models.html#cb188-6"></a><span class="kw">report</span>(us_change_fit3)</span>
<span id="cb188-7"><a href="arima-models.html#cb188-7"></a><span class="co">#&gt; Series: Consumption </span></span>
<span id="cb188-8"><a href="arima-models.html#cb188-8"></a><span class="co">#&gt; Model: ARIMA(3,0,0) w/ mean </span></span>
<span id="cb188-9"><a href="arima-models.html#cb188-9"></a><span class="co">#&gt; </span></span>
<span id="cb188-10"><a href="arima-models.html#cb188-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb188-11"><a href="arima-models.html#cb188-11"></a><span class="co">#&gt;          ar1     ar2     ar3  constant</span></span>
<span id="cb188-12"><a href="arima-models.html#cb188-12"></a><span class="co">#&gt;       0.2274  0.1604  0.2027    0.3050</span></span>
<span id="cb188-13"><a href="arima-models.html#cb188-13"></a><span class="co">#&gt; s.e.  0.0713  0.0723  0.0712    0.0421</span></span>
<span id="cb188-14"><a href="arima-models.html#cb188-14"></a><span class="co">#&gt; </span></span>
<span id="cb188-15"><a href="arima-models.html#cb188-15"></a><span class="co">#&gt; sigma^2 estimated as 0.3494:  log likelihood=-165.17</span></span>
<span id="cb188-16"><a href="arima-models.html#cb188-16"></a><span class="co">#&gt; AIC=340.34   AICc=340.67   BIC=356.5</span></span></code></pre></div>
<div id="mle" class="section level3">
<h3><span class="header-section-number">10.3.1</span> MLE</h3>
<p>Once the model order has been identified (i.e., the values of p, d and q), we need to estimate the parameters <span class="math inline">\(c, \phi_1, \dots, \phi_p, \theta_1, \dots, \theta_q\)</span>. When R estimates the ARIMA model, it uses MLE. For ARIMA models, MLE is similar to the least squares estimates that would be obtained by minimising</p>
<p><span class="math display">\[
\sum_{t=1}^{T}{\varepsilon_t^2}
\]</span></p>
</div>
<div id="information-criteria" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Information Criteria</h3>
<p>Akaike’s Information Criterion (AIC), which was useful in selecting predictors for regression, is also useful for determining the order of an ARIMA model. It can be written as</p>
<p><span class="math display">\[
\text{AIC} = -2\log{L} + 2(p + q + k + 1)
\]</span></p>
<p>where <span class="math inline">\(L\)</span> is the likelihood of the data. Note that the last term in parentheses is the number of parameters in the model (including <span class="math inline">\(\sigma^2\)</span>, the variance of the residuals).</p>
<p>For ARIMA models, the corrected AIC can be written as</p>
<p><span class="math display">\[
\text{AIC}_c = AIC + \frac{2(p + q + k + 1)(p + q + k + 2)}{T - p -q -k -2}
\]</span></p>
<p>and the Bayesian Information Criterion can be written as</p>
<p><span class="math display">\[
\text{BIC} = \text{AIC} + (\log{T} - 2)(p + q + k + 1)
\]</span></p>
<p><strong>It is important to note that these information criteria tend not to be good guides to selecting the appropriate order of differencing (<span class="math inline">\(d\)</span>) of a model</strong>, but only for selecting the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. This is because the differencing changes the data on which the likelihood is computed, making the AIC values between models with different orders of differencing not comparable. So we need to use some other approach to choose <span class="math inline">\(d\)</span>, and then we can use the AICc to select <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. <strong>However</strong>, when comparing models using a test set, it does not matter how the forecasts were produced — the comparisons are always valid.</p>
</div>
</div>
<div id="the-arima-function" class="section level2">
<h2><span class="header-section-number">10.4</span> The <code>ARIMA()</code> function</h2>
<p>By default <code>ARIMA(value)</code> creates a automatic specification where the model space are confined to non-seasonal component <span class="math inline">\(p \in \{1, 2, 3, 4, 5\}, d \in \{0, 1, 2\}, q \in \{0, 1, 2, 3, 4, 5\}\)</span> and seasonal component (Section <a href="arima-models.html#seasonal-arima-models">10.6</a>) <span class="math inline">\(P \in \{0, 1, 2\}, D \in \{0, 1\}, Q \in \{0, 1, 2\}\)</span>. We can also use <code>p_init</code> andn <code>q_init</code> to specify the initial value for <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> if a stepwise procedure indroduced in the next section is used.</p>
<p>We can also achieve manual specification of the model space in <code>pdq()</code> and <code>PDQ()</code> where <code>pdq()</code> specifies the non-seasonal part and <code>PDQ()</code> the seasonal part. In the case of a non-seasonal model, it is common to set <code>ARIMA(value ~ PDQ(0, 0, 0))</code>. This eliminates the seasonal part and keeps the default process of searching for a optimal seasonal part. Further, to search the best non-seasonal ARIMA model with <span class="math inline">\(p \in \{1, 2, 3\}\)</span>, <span class="math inline">\(q \in \{0, 1, 2\}\)</span> and <span class="math inline">\(d = 1\)</span>, you could use <code>ARIMA(y ~ pdq(1:3, 1, 0:2) + PDQ(0, 0, 0))</code>.</p>
<p>The default procedure uses some approximations to speed up the search. These approximations can be avoided with the argument <code>approximation = FALSE</code>. It is possible that the minimum AICc model will not be found due to these approximations, or because of the use of a stepwise procedure. A much larger set of models will be searched if the argument <code>stepwise = FALSE</code> is used.</p>
<div id="algorithm" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Algorithm</h3>
<p>The <code>ARIMA()</code> function in R uses a variation of the Hyndman-Khandakar algorithm <span class="citation">(<a href="references.html#ref-JSSv027i03" role="doc-biblioref">2008</a>)</span>. The algorithm combines unit root tests, minimization of <span class="math inline">\(\text{AIC}_c\)</span> and <span class="math inline">\(\text{MLE}\)</span> to obtain a “optimal” ARIMA model. The default behaviour is discussed in minute details at <a href="https://otexts.com/fpp3/arima-r.html" class="uri">https://otexts.com/fpp3/arima-r.html</a>. Here we only cover non-seasonal model, and the procedure for a SARIMA model is quite the same, <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> are ultimately determined by minimizing <span class="math inline">\(\text{AIC}_c\)</span>.</p>
<ol style="list-style-type: decimal">
<li><p>The number of differences <span class="math inline">\(0 \le d \le 2\)</span> is determined using repeated KPSS tests <a href="arima-models.html#unit-root-tests">10.1.3</a>. (For <span class="math inline">\(D\)</span>, use <code>unitroot_nsdiffs()</code>)</p></li>
<li><p>Use a stepwise search (rather than exhaustive) to determine <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> after differencing the time series <span class="math inline">\(d\)</span> times. Four initial models are fitted:<br />
</p></li>
</ol>
<ul>
<li>ARIMA(0, <span class="math inline">\(d\)</span>, 0)<br />
</li>
<li>ARIMA(2, <span class="math inline">\(d\)</span>, 2)<br />
</li>
<li>ARIMA(1, <span class="math inline">\(d\)</span>, 0)<br />
</li>
<li>ARIMA(0, <span class="math inline">\(d\)</span>, 1)</li>
</ul>
<p>A constant is included unless <span class="math inline">\(d = 2\)</span>. If <span class="math inline">\(d \le 1\)</span>, an additional model is also fitted: ARIMA(0, <span class="math inline">\(d\)</span>, 0). The best model (with the smallest <span class="math inline">\(\text{AIC}_c\)</span> value) fitted in the previous step is set to be the “current” model. Then variations on the current model are considered: vary <span class="math inline">\(p\)</span> and/or <span class="math inline">\(q\)</span> from the current model by <span class="math inline">\(\pm1\)</span> and exclude / include the constant term <span class="math inline">\(c\)</span> in the model</p>
<ol start="3" style="list-style-type: decimal">
<li>The best model considered so far (either the current model or one of these variations) becomes the new current model. Then the second step is repeated until no lower AICc can be found.</li>
</ol>
</div>
<div id="modelling-procedure" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Modelling procedure</h3>
<p>A general strategy is recommended when fitting non-seasonanl arima models</p>
<ol style="list-style-type: decimal">
<li><p>Plot the data and identify any unusual observations <a href="https://github.com/business-science/anomalize" class="uri">https://github.com/business-science/anomalize</a></p></li>
<li><p>If necessary, transform the data (such as a Box-Cox transformation(<code>ts %&gt;% features(var, features = guerrero)</code>) or a logrithm transformation) to stabilise the variance.</p></li>
<li><p>If the data are non-stationary, take first differences of the data until the data are stationary.</p></li>
<li><p>Examine the ACF/PACF: Is an <code>ARIMA(p, d, 0)</code> or <code>ARIMA(0, d, q)</code> model appropriate?</p></li>
<li><p>Try your chosen model(s), and use the <span class="math inline">\(\text{AIC}_c\)</span> to search for a better model.</p></li>
<li><p>Check the residuals from your chosen model by plotting the ACF of the residuals, and doing a portmanteau test of the residuals(<a href="univariate-stationary-processes.html#tests-for-autocorrelation-and-normality">9.1.2</a>). If they do not look like white noise, try a modified model.</p></li>
<li><p>Once the residuals look like white noise, calculate forecasts.</p></li>
</ol>
<p>The <code>ARIMA()</code> function takes care of step 3 - 5, so there are still possible needs to transform the data, to diagnose residuals and to give forecasts.</p>
<p><img src="images/arima_process.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="example-seasonally-adjusted-electrical-equipment-orders" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Example: Seasonally adjusted electrical equipment orders</h3>
<p><code>elec_equip</code> is highly seasonal. Instead of creating a seaonal ARIMA model, we tend to use the seasonal adjusted series to build a non-seasonal model here</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="arima-models.html#cb189-1"></a>elec_equip &lt;-<span class="st"> </span><span class="kw">as_tsibble</span>(fpp2<span class="op">::</span>elecequip)</span>
<span id="cb189-2"><a href="arima-models.html#cb189-2"></a></span>
<span id="cb189-3"><a href="arima-models.html#cb189-3"></a>elec_equip <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="arima-models.html#cb190-1"></a></span>
<span id="cb190-2"><a href="arima-models.html#cb190-2"></a>elec_equip <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb190-3"><a href="arima-models.html#cb190-3"></a><span class="st">  </span><span class="kw">ACF</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb190-4"><a href="arima-models.html#cb190-4"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-16-2.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="arima-models.html#cb191-1"></a></span>
<span id="cb191-2"><a href="arima-models.html#cb191-2"></a>elec_equip <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(value, feat_stl)</span>
<span id="cb191-3"><a href="arima-models.html#cb191-3"></a><span class="co">#&gt; # A tibble: 1 x 9</span></span>
<span id="cb191-4"><a href="arima-models.html#cb191-4"></a><span class="co">#&gt;   trend_strength seasonal_streng~ seasonal_peak_y~ seasonal_trough~ spikiness</span></span>
<span id="cb191-5"><a href="arima-models.html#cb191-5"></a><span class="co">#&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb191-6"><a href="arima-models.html#cb191-6"></a><span class="co">#&gt; 1          0.943            0.908                0                8   0.00251</span></span>
<span id="cb191-7"><a href="arima-models.html#cb191-7"></a><span class="co">#&gt; # ... with 4 more variables: linearity &lt;dbl&gt;, curvature &lt;dbl&gt;,</span></span>
<span id="cb191-8"><a href="arima-models.html#cb191-8"></a><span class="co">#&gt; #   stl_e_acf1 &lt;dbl&gt;, stl_e_acf10 &lt;dbl&gt;</span></span></code></pre></div>
<p>Use STL decomposition to obtain the seasonal adjusted data</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="arima-models.html#cb192-1"></a>elec_adjusted &lt;-<span class="st"> </span>elec_equip <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-2"><a href="arima-models.html#cb192-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">STL</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-3"><a href="arima-models.html#cb192-3"></a><span class="st">  </span><span class="kw">components</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-4"><a href="arima-models.html#cb192-4"></a><span class="st">  </span><span class="kw">select</span>(index, season_adjust) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb192-5"><a href="arima-models.html#cb192-5"></a><span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> index)</span>
<span id="cb192-6"><a href="arima-models.html#cb192-6"></a></span>
<span id="cb192-7"><a href="arima-models.html#cb192-7"></a>elec_adjusted <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(season_adjust, feat_stl)</span>
<span id="cb192-8"><a href="arima-models.html#cb192-8"></a><span class="co">#&gt; # A tibble: 1 x 9</span></span>
<span id="cb192-9"><a href="arima-models.html#cb192-9"></a><span class="co">#&gt;   trend_strength seasonal_streng~ seasonal_peak_y~ seasonal_trough~ spikiness</span></span>
<span id="cb192-10"><a href="arima-models.html#cb192-10"></a><span class="co">#&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb192-11"><a href="arima-models.html#cb192-11"></a><span class="co">#&gt; 1          0.944           0.0300                0                6   0.00249</span></span>
<span id="cb192-12"><a href="arima-models.html#cb192-12"></a><span class="co">#&gt; # ... with 4 more variables: linearity &lt;dbl&gt;, curvature &lt;dbl&gt;,</span></span>
<span id="cb192-13"><a href="arima-models.html#cb192-13"></a><span class="co">#&gt; #   stl_e_acf1 &lt;dbl&gt;, stl_e_acf10 &lt;dbl&gt;</span></span></code></pre></div>
<p>Plot the data for detection of outliers and anomalies</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="arima-models.html#cb193-1"></a>elec_adjusted <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Is there a need for transformation ?</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="arima-models.html#cb194-1"></a><span class="co"># close to 1</span></span>
<span id="cb194-2"><a href="arima-models.html#cb194-2"></a>elec_adjusted <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(season_adjust, guerrero)</span>
<span id="cb194-3"><a href="arima-models.html#cb194-3"></a><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span id="cb194-4"><a href="arima-models.html#cb194-4"></a><span class="co">#&gt;   lambda_guerrero</span></span>
<span id="cb194-5"><a href="arima-models.html#cb194-5"></a><span class="co">#&gt;             &lt;dbl&gt;</span></span>
<span id="cb194-6"><a href="arima-models.html#cb194-6"></a><span class="co">#&gt; 1           -1.00</span></span></code></pre></div>
<p>Fit a ARIMA model:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="arima-models.html#cb195-1"></a>elec_fit &lt;-<span class="st"> </span>elec_adjusted <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb195-2"><a href="arima-models.html#cb195-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(season_adjust <span class="op">~</span><span class="st"> </span><span class="kw">PDQ</span>()))</span>
<span id="cb195-3"><a href="arima-models.html#cb195-3"></a></span>
<span id="cb195-4"><a href="arima-models.html#cb195-4"></a><span class="co"># ARIMA(1, 1, 5) without constant </span></span>
<span id="cb195-5"><a href="arima-models.html#cb195-5"></a>elec_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb195-6"><a href="arima-models.html#cb195-6"></a><span class="co">#&gt; Series: season_adjust </span></span>
<span id="cb195-7"><a href="arima-models.html#cb195-7"></a><span class="co">#&gt; Model: ARIMA(1,1,5) </span></span>
<span id="cb195-8"><a href="arima-models.html#cb195-8"></a><span class="co">#&gt; </span></span>
<span id="cb195-9"><a href="arima-models.html#cb195-9"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb195-10"><a href="arima-models.html#cb195-10"></a><span class="co">#&gt;          ar1      ma1     ma2     ma3      ma4     ma5</span></span>
<span id="cb195-11"><a href="arima-models.html#cb195-11"></a><span class="co">#&gt;       0.5672  -0.9543  0.3220  0.2300  -0.2863  0.2745</span></span>
<span id="cb195-12"><a href="arima-models.html#cb195-12"></a><span class="co">#&gt; s.e.  0.1490   0.1493  0.1064  0.0924   0.0913  0.0774</span></span>
<span id="cb195-13"><a href="arima-models.html#cb195-13"></a><span class="co">#&gt; </span></span>
<span id="cb195-14"><a href="arima-models.html#cb195-14"></a><span class="co">#&gt; sigma^2 estimated as 8.348:  log likelihood=-478.48</span></span>
<span id="cb195-15"><a href="arima-models.html#cb195-15"></a><span class="co">#&gt; AIC=970.97   AICc=971.57   BIC=993.84</span></span></code></pre></div>
<p>Visualization and statistical tests on residuals</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="arima-models.html#cb196-1"></a>elec_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb196-2"><a href="arima-models.html#cb196-2"></a><span class="st">  </span><span class="kw">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-21-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="arima-models.html#cb197-1"></a></span>
<span id="cb197-2"><a href="arima-models.html#cb197-2"></a>elec_aug &lt;-<span class="st"> </span>elec_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb197-3"><a href="arima-models.html#cb197-3"></a><span class="st">  </span><span class="kw">augment</span>()</span>
<span id="cb197-4"><a href="arima-models.html#cb197-4"></a></span>
<span id="cb197-5"><a href="arima-models.html#cb197-5"></a>elec_aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb197-6"><a href="arima-models.html#cb197-6"></a><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">8</span>, <span class="dt">dof =</span> <span class="dv">7</span>)</span>
<span id="cb197-7"><a href="arima-models.html#cb197-7"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb197-8"><a href="arima-models.html#cb197-8"></a><span class="co">#&gt;   .model                       lb_stat lb_pvalue</span></span>
<span id="cb197-9"><a href="arima-models.html#cb197-9"></a><span class="co">#&gt;   &lt;chr&gt;                          &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb197-10"><a href="arima-models.html#cb197-10"></a><span class="co">#&gt; 1 ARIMA(season_adjust ~ PDQ())    2.03     0.155</span></span></code></pre></div>
<p>Producing forecasts</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="arima-models.html#cb198-1"></a>elec_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb198-2"><a href="arima-models.html#cb198-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb198-3"><a href="arima-models.html#cb198-3"></a><span class="st">  </span><span class="kw">autoplot</span>(elec_adjusted)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-22-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Note that Section <a href="arima-models.html#understanding-arima-models">10.2.1</a>, we mentioned that the long term forecast of an ARIMA model with no constant and <span class="math inline">\(d = 1\)</span> will go to a constant.</p>
</div>
<div id="plotting-the-characteristic-roots" class="section level3">
<h3><span class="header-section-number">10.4.4</span> Plotting the characteristic roots</h3>
<p>The stationarity conditions for the model are that the p complex roots of <span class="math inline">\(\Phi(B)\)</span> lie outside the unit circle, and the invertibility conditions are that the q complex roots of <span class="math inline">\(\Theta(B)\)</span> lie outside the unit circle. So we can see whether the model is close to invertibility or stationarity by a plot of the roots in relation to the complex unit circle.</p>
<p>It is easier to plot the <strong>inverse</strong> roots instead, as they should all lie within the unit circle. This is easily done in R. For the <span class="math inline">\(\text{ARIMA}(3, 1, 1)\)</span> model fitted to the seasonally adjusted electrical equipment index</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="arima-models.html#cb199-1"></a><span class="kw">gg_arma</span>(elec_fit)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;" />
<strong>The <code>ARIMA()</code> function will never return a model with inverse roots outside the unit circle</strong>. Models automatically selected by the ARIMA() function will not select a model with roots close to the unit circle.</p>
</div>
</div>
<div id="forecasting-with-arima-models" class="section level2">
<h2><span class="header-section-number">10.5</span> Forecasting with ARIMA models</h2>
<div id="point-forecasts" class="section level3">
<h3><span class="header-section-number">10.5.1</span> Point forecasts</h3>
<p><a href="https://otexts.com/fpp3/arima-forecasting.html" class="uri">https://otexts.com/fpp3/arima-forecasting.html</a></p>
</div>
<div id="prediction-intervals" class="section level3">
<h3><span class="header-section-number">10.5.2</span> Prediction intervals</h3>
<p>The calculation of ARIMA prediction intervals is more difficult, and here only a simple case is presented.</p>
<p>The first prediction interval is easy to calculate. If <span class="math inline">\(\hat{\sigma}^2\)</span> is the standard deviation of the residuals, then a 95% prediction interval is given by <span class="math inline">\(\hat{y}_{T + 1|T} \pm 1.96 \hat{\sigma}^2\)</span>. This result is true for all ARIMA models regardless of their parameters and orders.</p>
<p>Multi-step prediction intervals for ARIMA(0, 0, q) models are relatively easy to calculate. We can write the model as</p>
<p><span class="math display">\[
y_t = \varvarepsilon_t + \sum_{i=1}^{q}\theta_i\varepsilon_{t-i}
\]</span></p>
<p>Then, the estimated forecast variance can be written as</p>
<p><span class="math display">\[
\hat{\sigma}_h = \hat{\sigma}^2[1 + \sum_{i = 1}^{h - 1}\hat{\theta}_i^2]
\]</span></p>
<p>and a 95% prediction interval is given by <span class="math inline">\(y_{T+h|T}±1.96 \sqrt{\hat{\sigma}_h^2}\)</span>.</p>
<p>In Section <a href="univariate-stationary-processes.html#koyck-transformation-and-invertibility">9.4.3</a>, we showed that an AR(1) model can be written as an MA(<span class="math inline">\(\infty\)</span>) model. Using this equivalence, the above result for MA(q) models can also be used to obtain prediction intervals for AR(1) models.</p>
<p>The prediction intervals for ARIMA models are based on assumptions that the residuals are uncorrelated and normally distributed. If either of these assumptions does not hold, then the prediction intervals may be incorrect. For this reason, always plot the ACF and histogram of the residuals to check the assumptions before producing prediction intervals.</p>
<p>In general, prediction intervals from ARIMA models increase as the forecast horizon increases. For stationary models (i.e., with <span class="math inline">\(d = 0\)</span>) they will converge, so that prediction intervals for long horizons are all essentially the same. For <span class="math inline">\(d \ge 1\)</span>, the prediction intervals will continue to grow into the future.</p>
<p>As with most prediction interval calculations, ARIMA-based intervals tend to be too narrow. This occurs because only the variation in the errors has been accounted for. There is also variation in the parameter estimates, and in the model order, that has not been included in the calculation. In addition, the calculation assumes that the historical patterns that have been modelled will continue into the forecast period.</p>
</div>
</div>
<div id="seasonal-arima-models" class="section level2">
<h2><span class="header-section-number">10.6</span> Seasonal ARIMA models</h2>
<p>So far, we have restricted our attention to non-seasonal data and non-seasonal ARIMA models. However, ARIMA models are also capable of modelling a wide range of seasonal data.</p>
<p>A seasonal ARIMA model includes additional seasonal terms, written as follows</p>
<p><img src="images/seasonal_arima.png" width="100%" style="display: block; margin: auto;" />
where <span class="math inline">\(m\)</span> is number of observations per year.</p>
<p>The seasonal part of the model consists of terms that are similar to the non-seasonal components of the model, but involve backshifts of the seasonal period. For example, an <span class="math inline">\(\text{ARIMA}(1, 1, 1)(1, 1, 1)_4\)</span> model (without a constant) is for quarterly data (m = 4), and can be written as (Not that a seasonal difference is <strong>not</strong> a m order difference)</p>
<p><span class="math display">\[
(1 - \Phi_1B^4)(1 - \phi_1B)(1 - B^4)(1 - B)y_t = \varepsilon_t(1 - \theta_1B)(1 - \Theta_1B^4)
\]</span></p>
<p>It can be easily shown that a SARIMA model can be converted to an ARMA model. For autoregression terms</p>
<p><span class="math display">\[
ar = (1 - \phi_1B - \cdots - \phi_pB^p)(1 - B)^d \\
sar = (1 - \Phi_1 B^m - \cdots - B^{Pm})(1 - B^m)^D 
\]</span>
Then, the AR polynomial of the inverted ARMA model can be written as</p>
<p><span class="math display">\[
AR = ar \times sar
\]</span></p>
<p>For moving average terms, we have</p>
<p><span class="math display">\[
ma = (1 + \theta_1B + \cdots + \theta_qB^q) \\
sma = (1 + \Theta_1B^m + \cdots + \Theta_1B^{Pm})(1 - B^m)^D 
\]</span></p>
<p>Then, the MA polynomial of the inverted ARMA model can be written as</p>
<p><span class="math display">\[
MA = ma \times sma
\]</span></p>
<p>In this way, we can get the ARMA(u, v) model inverted from the SARIMA model. It can be written as</p>
<p><span class="math display">\[
(1 - \phi_1&#39;B - \cdots - \phi_u&#39;B^u)y_t = (1 - \theta_1&#39;B - \cdots - \theta_v&#39;B^v)\varepsilon_t
\]</span></p>
<p>From Section <a href="univariate-stationary-processes.html#three-representations-of-an-arma-model">9.5.1</a>, we also know that an ARMA model can be converted to AR or MA models under certain circumstances, so that SARIMA models can be further transformed in a similar way.</p>
<div id="acf-and-pacf" class="section level3">
<h3><span class="header-section-number">10.6.1</span> ACF and PACF</h3>
<p>The seasonal part of an AR or MA model will be seen in the seasonal lags of the PACF and ACF. For example, an <span class="math inline">\(\text{ARIMA}(0, 0, 0)(0, 0, 1)_{12}\)</span> model will show:</p>
<ul>
<li><p>a spike at lag 12 in the ACF but no other significant spikes;</p></li>
<li><p>exponential decay in the seasonal lags of the PACF (i.e., at lags 12, 24, 36, …).</p></li>
</ul>
<p>Similarly, an <span class="math inline">\(\text{ARIMA}(0, 0, 0)(1, 0, 0)_{12}\)</span> model will show:</p>
<ul>
<li><p>exponential decay in the seasonal lags of the ACF;</p></li>
<li><p>a single significant spike at lag 12 in the PACF.</p></li>
</ul>
</div>
<div id="example-european-quarterly-retail-trade" class="section level3">
<h3><span class="header-section-number">10.6.2</span> Example: European quarterly retail trade</h3>
<p><code>eu_retail</code>: quarterly European retail trade data from 1996 to 2011</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="arima-models.html#cb200-1"></a>eu_retail &lt;-<span class="st"> </span><span class="kw">as_tsibble</span>(fpp2<span class="op">::</span>euretail)</span>
<span id="cb200-2"><a href="arima-models.html#cb200-2"></a>eu_retail <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(value)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-25-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The data is non-stationary, with a degree of seasonality</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="arima-models.html#cb201-1"></a>eu_retail <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">features</span>(value, feat_stl)</span>
<span id="cb201-2"><a href="arima-models.html#cb201-2"></a><span class="co">#&gt; # A tibble: 1 x 9</span></span>
<span id="cb201-3"><a href="arima-models.html#cb201-3"></a><span class="co">#&gt;   trend_strength seasonal_streng~ seasonal_peak_y~ seasonal_trough~ spikiness</span></span>
<span id="cb201-4"><a href="arima-models.html#cb201-4"></a><span class="co">#&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb201-5"><a href="arima-models.html#cb201-5"></a><span class="co">#&gt; 1          0.998            0.703                0                1   3.77e-7</span></span>
<span id="cb201-6"><a href="arima-models.html#cb201-6"></a><span class="co">#&gt; # ... with 4 more variables: linearity &lt;dbl&gt;, curvature &lt;dbl&gt;,</span></span>
<span id="cb201-7"><a href="arima-models.html#cb201-7"></a><span class="co">#&gt; #   stl_e_acf1 &lt;dbl&gt;, stl_e_acf10 &lt;dbl&gt;</span></span></code></pre></div>
<p>We will first take a seasonal difference. These still appear to be some sort of nonstationarity, so we take an additional first difference</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="arima-models.html#cb202-1"></a>eu_retail <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb202-2"><a href="arima-models.html#cb202-2"></a><span class="st">  </span><span class="kw">gg_tsdisplay</span>(<span class="kw">difference</span>(value, <span class="dv">4</span>), <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="arima-models.html#cb203-1"></a>eu_retail <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb203-2"><a href="arima-models.html#cb203-2"></a><span class="st">  </span><span class="kw">gg_tsdisplay</span>(value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">difference</span>(),</span>
<span id="cb203-3"><a href="arima-models.html#cb203-3"></a>  <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Our aim now is to find an appropriate ARIMA model based on the ACF and PACF plots. The significant spike at lag 1 in the ACF suggests a non-seasonal MA(1) component, and the significant spike at lag 4 in the ACF suggests a seasonal MA(1) component. Consequently, we begin with an <span class="math inline">\(\text{ARIMA}(0, 1, 1)(0, 1, 1)_4\)</span> model, indicating a first and seasonal difference, and non-seasonal and seasonal MA(1) components. By analogous logic applied to the PACF, we could also have started with an <span class="math inline">\(\text{ARIMA}(1,1,0)(1,1,0)_4\)</span> model. (Not that only either <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> is zero can ACF and PACF plots be used to decide orders. <a href="univariate-stationary-processes.html#arma-models">9.5</a>)</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="arima-models.html#cb204-1"></a>eu_retail_fit &lt;-<span class="st"> </span>eu_retail <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb204-2"><a href="arima-models.html#cb204-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">PDQ</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb204-3"><a href="arima-models.html#cb204-3"></a></span>
<span id="cb204-4"><a href="arima-models.html#cb204-4"></a>eu_retail_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb204-5"><a href="arima-models.html#cb204-5"></a><span class="co">#&gt; Series: value </span></span>
<span id="cb204-6"><a href="arima-models.html#cb204-6"></a><span class="co">#&gt; Model: ARIMA(0,1,1)(0,1,1)[4] </span></span>
<span id="cb204-7"><a href="arima-models.html#cb204-7"></a><span class="co">#&gt; </span></span>
<span id="cb204-8"><a href="arima-models.html#cb204-8"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb204-9"><a href="arima-models.html#cb204-9"></a><span class="co">#&gt;          ma1     sma1</span></span>
<span id="cb204-10"><a href="arima-models.html#cb204-10"></a><span class="co">#&gt;       0.2903  -0.6913</span></span>
<span id="cb204-11"><a href="arima-models.html#cb204-11"></a><span class="co">#&gt; s.e.  0.1118   0.1193</span></span>
<span id="cb204-12"><a href="arima-models.html#cb204-12"></a><span class="co">#&gt; </span></span>
<span id="cb204-13"><a href="arima-models.html#cb204-13"></a><span class="co">#&gt; sigma^2 estimated as 0.188:  log likelihood=-34.64</span></span>
<span id="cb204-14"><a href="arima-models.html#cb204-14"></a><span class="co">#&gt; AIC=75.28   AICc=75.72   BIC=81.51</span></span></code></pre></div>
<p>Check residuals</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="arima-models.html#cb205-1"></a>eu_retail_aug &lt;-<span class="st"> </span>eu_retail_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">augment</span>()</span>
<span id="cb205-2"><a href="arima-models.html#cb205-2"></a></span>
<span id="cb205-3"><a href="arima-models.html#cb205-3"></a>eu_retail_aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb205-4"><a href="arima-models.html#cb205-4"></a><span class="st">  </span><span class="kw">ACF</span>(.resid) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb205-5"><a href="arima-models.html#cb205-5"></a><span class="st">  </span><span class="kw">autoplot</span>()</span>
<span id="cb205-6"><a href="arima-models.html#cb205-6"></a></span>
<span id="cb205-7"><a href="arima-models.html#cb205-7"></a>eu_retail_aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb205-8"><a href="arima-models.html#cb205-8"></a><span class="st">  </span><span class="kw">PACF</span>(.resid) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb205-9"><a href="arima-models.html#cb205-9"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-30-1.png" width="50%" /><img src="ch9_files/figure-html/unnamed-chunk-30-2.png" width="50%" /></p>
<p>Both the ACF and PACF show significant spikes at lag 2, and almost significant spikes at lag 3, indicating that some additional non-seasonal terms need to be included in the model. What if we just let <code>ARIMA()</code> pick a model for us?</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="arima-models.html#cb206-1"></a>eu_retail_fit2 &lt;-<span class="st"> </span>eu_retail <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb206-2"><a href="arima-models.html#cb206-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(value))</span>
<span id="cb206-3"><a href="arima-models.html#cb206-3"></a></span>
<span id="cb206-4"><a href="arima-models.html#cb206-4"></a>eu_retail_fit2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb206-5"><a href="arima-models.html#cb206-5"></a><span class="co">#&gt; Series: value </span></span>
<span id="cb206-6"><a href="arima-models.html#cb206-6"></a><span class="co">#&gt; Model: ARIMA(0,1,3)(0,1,1)[4] </span></span>
<span id="cb206-7"><a href="arima-models.html#cb206-7"></a><span class="co">#&gt; </span></span>
<span id="cb206-8"><a href="arima-models.html#cb206-8"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb206-9"><a href="arima-models.html#cb206-9"></a><span class="co">#&gt;          ma1     ma2     ma3     sma1</span></span>
<span id="cb206-10"><a href="arima-models.html#cb206-10"></a><span class="co">#&gt;       0.2630  0.3694  0.4200  -0.6636</span></span>
<span id="cb206-11"><a href="arima-models.html#cb206-11"></a><span class="co">#&gt; s.e.  0.1237  0.1255  0.1294   0.1545</span></span>
<span id="cb206-12"><a href="arima-models.html#cb206-12"></a><span class="co">#&gt; </span></span>
<span id="cb206-13"><a href="arima-models.html#cb206-13"></a><span class="co">#&gt; sigma^2 estimated as 0.156:  log likelihood=-28.63</span></span>
<span id="cb206-14"><a href="arima-models.html#cb206-14"></a><span class="co">#&gt; AIC=67.26   AICc=68.39   BIC=77.65</span></span></code></pre></div>
<p>The automatic picked model is <span class="math inline">\(\text{ARIMA}(0, 1, 3)(0, 1, 1)_4\)</span>, and has lower <span class="math inline">\(\text{AIC}_c\)</span>, 68.39 compared to 75.72. This in some sense explains why previous residuals show some non-seaonal correlation pattern and how it is fixed.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="arima-models.html#cb207-1"></a>eu_retail_fit2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb207-2"><a href="arima-models.html#cb207-2"></a><span class="st">  </span><span class="kw">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-32-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="arima-models.html#cb208-1"></a></span>
<span id="cb208-2"><a href="arima-models.html#cb208-2"></a>eu_retail_fit2 <span class="op">%&gt;%</span></span>
<span id="cb208-3"><a href="arima-models.html#cb208-3"></a><span class="st">  </span><span class="kw">augment</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb208-4"><a href="arima-models.html#cb208-4"></a><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">8</span>, <span class="dt">dof =</span> <span class="dv">5</span>)</span>
<span id="cb208-5"><a href="arima-models.html#cb208-5"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb208-6"><a href="arima-models.html#cb208-6"></a><span class="co">#&gt;   .model       lb_stat lb_pvalue</span></span>
<span id="cb208-7"><a href="arima-models.html#cb208-7"></a><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb208-8"><a href="arima-models.html#cb208-8"></a><span class="co">#&gt; 1 ARIMA(value)   0.511     0.916</span></span></code></pre></div>
<p>Forecasts from the model for the next three years are shown below</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="arima-models.html#cb209-1"></a>eu_retail_fit2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb209-2"><a href="arima-models.html#cb209-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb209-3"><a href="arima-models.html#cb209-3"></a><span class="st">  </span><span class="kw">autoplot</span>(eu_retail)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The forecasts follow the recent trend in the data, because of the double differencing. The large and rapidly increasing prediction intervals show that the retail trade index could start increasing or decreasing at any time — while the point forecasts trend downwards, the prediction intervals allow for the data to trend upwards during the forecast period.</p>
</div>
<div id="example-corticosteroid-drug-sales-in-australia" class="section level3">
<h3><span class="header-section-number">10.6.3</span> Example: Corticosteroid drug sales in Australia</h3>
<p>We will try to forecast monthly corticosteroid drug sales in Australia. There is a small increase in the variance with the level, so we take logarithms to stabilise the variance.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="arima-models.html#cb210-1"></a>h02 &lt;-<span class="st"> </span>tsibbledata<span class="op">::</span>PBS <span class="op">%&gt;%</span></span>
<span id="cb210-2"><a href="arima-models.html#cb210-2"></a><span class="st">  </span><span class="kw">filter</span>(ATC2 <span class="op">==</span><span class="st"> &quot;H02&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb210-3"><a href="arima-models.html#cb210-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">cost =</span> <span class="kw">sum</span>(Cost) <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>)  </span>
<span id="cb210-4"><a href="arima-models.html#cb210-4"></a></span>
<span id="cb210-5"><a href="arima-models.html#cb210-5"></a>h02 <span class="op">%&gt;%</span></span>
<span id="cb210-6"><a href="arima-models.html#cb210-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">cost_log =</span> <span class="kw">log</span>(cost)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb210-7"><a href="arima-models.html#cb210-7"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">c</span>(cost, cost_log), <span class="dt">names_to =</span> <span class="st">&quot;measure&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb210-8"><a href="arima-models.html#cb210-8"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb210-9"><a href="arima-models.html#cb210-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(Month, value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb210-10"><a href="arima-models.html#cb210-10"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>measure, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The data are strongly seasonal and obviously non-stationary, so seasonal differencing will be used. It is unclear that whether another difference should be used at this point, and we decide not to. The last few observations appear to be different (more variable) from the earlier data. This may be due to the fact that data are sometimes revised when earlier sales are reported late.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="arima-models.html#cb211-1"></a>h02 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb211-2"><a href="arima-models.html#cb211-2"></a><span class="st">  </span><span class="kw">gg_tsdisplay</span>(<span class="kw">difference</span>(<span class="kw">log</span>(cost), <span class="dv">12</span>), </span>
<span id="cb211-3"><a href="arima-models.html#cb211-3"></a>               <span class="dt">plot_type=</span><span class="st">&#39;partial&#39;</span>, </span>
<span id="cb211-4"><a href="arima-models.html#cb211-4"></a>               <span class="dt">lag_max =</span> <span class="dv">24</span>) </span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-35-1.png" width="100%" style="display: block; margin: auto;" />
In the plots of the seasonally differenced data, there are spikes in the PACF at lags 12 and 24, but nothing at seasonal lags in the ACF. This may be suggestive of a seasonal AR(2) term. In the non-seasonal lags, there are three significant spikes in the PACF, suggesting a possible AR(3) term. The pattern in the ACF is not indicative of any simple model.</p>
<p>Consequently, this initial analysis suggests that a possible model for these data is an <span class="math inline">\(\text{ARIMA}(3, 0, 0)(2, 1, 0)_12\)</span>. The <span class="math inline">\(\text{AIC}_c\)</span> of such model and some variations are shown:</p>
<p><img src="images/seasonal_arima_2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Of these models, the best is the <span class="math inline">\(ARIMA(3, 0, 1)(0, 1, 2)_12\)</span> model</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="arima-models.html#cb212-1"></a>h02_fit &lt;-<span class="st"> </span>h02 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb212-2"><a href="arima-models.html#cb212-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(<span class="kw">log</span>(cost) <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">pdq</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">PDQ</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))) <span class="co"># without constant</span></span>
<span id="cb212-3"><a href="arima-models.html#cb212-3"></a></span>
<span id="cb212-4"><a href="arima-models.html#cb212-4"></a>h02_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb212-5"><a href="arima-models.html#cb212-5"></a><span class="co">#&gt; Series: cost </span></span>
<span id="cb212-6"><a href="arima-models.html#cb212-6"></a><span class="co">#&gt; Model: ARIMA(3,0,1)(0,1,2)[12] </span></span>
<span id="cb212-7"><a href="arima-models.html#cb212-7"></a><span class="co">#&gt; Transformation: log(.x) </span></span>
<span id="cb212-8"><a href="arima-models.html#cb212-8"></a><span class="co">#&gt; </span></span>
<span id="cb212-9"><a href="arima-models.html#cb212-9"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb212-10"><a href="arima-models.html#cb212-10"></a><span class="co">#&gt;           ar1     ar2     ar3     ma1     sma1     sma2</span></span>
<span id="cb212-11"><a href="arima-models.html#cb212-11"></a><span class="co">#&gt;       -0.1603  0.5481  0.5678  0.3827  -0.5222  -0.1768</span></span>
<span id="cb212-12"><a href="arima-models.html#cb212-12"></a><span class="co">#&gt; s.e.   0.1636  0.0878  0.0942  0.1895   0.0861   0.0872</span></span>
<span id="cb212-13"><a href="arima-models.html#cb212-13"></a><span class="co">#&gt; </span></span>
<span id="cb212-14"><a href="arima-models.html#cb212-14"></a><span class="co">#&gt; sigma^2 estimated as 0.004278:  log likelihood=250.04</span></span>
<span id="cb212-15"><a href="arima-models.html#cb212-15"></a><span class="co">#&gt; AIC=-486.08   AICc=-485.48   BIC=-463.28</span></span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="arima-models.html#cb213-1"></a>h02_aug &lt;-<span class="st"> </span>h02_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">augment</span>()</span>
<span id="cb213-2"><a href="arima-models.html#cb213-2"></a></span>
<span id="cb213-3"><a href="arima-models.html#cb213-3"></a>h02_aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb213-4"><a href="arima-models.html#cb213-4"></a><span class="st">  </span><span class="kw">ACF</span>(.resid, <span class="dt">lag_max =</span> <span class="dv">36</span>) <span class="op">%&gt;%</span></span>
<span id="cb213-5"><a href="arima-models.html#cb213-5"></a><span class="st">  </span><span class="kw">autoplot</span>()</span>
<span id="cb213-6"><a href="arima-models.html#cb213-6"></a></span>
<span id="cb213-7"><a href="arima-models.html#cb213-7"></a>h02_aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb213-8"><a href="arima-models.html#cb213-8"></a><span class="st">  </span><span class="kw">PACF</span>(.resid, <span class="dt">lag_max =</span> <span class="dv">36</span>) <span class="op">%&gt;%</span></span>
<span id="cb213-9"><a href="arima-models.html#cb213-9"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-38-1.png" width="50%" /><img src="ch9_files/figure-html/unnamed-chunk-38-2.png" width="50%" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="arima-models.html#cb214-1"></a>h02_aug <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb214-2"><a href="arima-models.html#cb214-2"></a><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">24</span>, <span class="dt">dof =</span> <span class="dv">7</span>) <span class="co"># h = 2m for seasonal data </span></span>
<span id="cb214-3"><a href="arima-models.html#cb214-3"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb214-4"><a href="arima-models.html#cb214-4"></a><span class="co">#&gt;   .model                                             lb_stat lb_pvalue</span></span>
<span id="cb214-5"><a href="arima-models.html#cb214-5"></a><span class="co">#&gt;   &lt;chr&gt;                                                &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb214-6"><a href="arima-models.html#cb214-6"></a><span class="co">#&gt; 1 ARIMA(log(cost) ~ 0 + pdq(3, 0, 1) + PDQ(0, 1, 2))    23.7     0.129</span></span></code></pre></div>
<p>Produce forecasts</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="arima-models.html#cb215-1"></a>h02_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb215-2"><a href="arima-models.html#cb215-2"></a><span class="st">  </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb215-3"><a href="arima-models.html#cb215-3"></a><span class="st">  </span><span class="kw">autoplot</span>(h02)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-40-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ets-and-arima" class="section level2">
<h2><span class="header-section-number">10.7</span> ETS and ARIMA</h2>
<p>While linear exponential smoothing models are all special cases of ARIMA models, the non-linear exponential smoothing models have no equivalent ARIMA counterparts. On the other hand, there are also many ARIMA models that have no exponential smoothing counterparts. In particular, all ETS models are non-stationary, while some ARIMA models are stationary.</p>
<p>The ETS models with seasonality or non-damped trend or both have two unit roots (i.e., they need two levels of differencing to make them stationary). All other ETS models have one unit root (they need one level of differencing to make them stationary).</p>
<p><img src="images/ets_arima.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The AICc is useful for selecting between models in the same class. For example, we can use it to select an ARIMA model between candidate ARIMA models or an ETS model between candidate ETS models. <strong>However, it cannot be used to compare between ETS and ARIMA models because they are in different model classes</strong>, and the likelihood is computed in different ways. The examples below demonstrate selecting between these classes of models.</p>
<div id="example-comparing-arima-and-ets-on-non-seasonal-data" class="section level3">
<h3><span class="header-section-number">10.7.1</span> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</h3>
<p>We can use time series cross-validation to compare an ARIMA model and an ETS model. Let’s consider the Australian population from the <code>global_economy</code> dataset</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="arima-models.html#cb216-1"></a>aus_economy &lt;-<span class="st"> </span>global_economy <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb216-2"><a href="arima-models.html#cb216-2"></a><span class="st">  </span><span class="kw">filter</span>(Code <span class="op">==</span><span class="st"> &quot;AUS&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb216-3"><a href="arima-models.html#cb216-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Population =</span> Population<span class="op">/</span><span class="fl">1e6</span>)</span>
<span id="cb216-4"><a href="arima-models.html#cb216-4"></a></span>
<span id="cb216-5"><a href="arima-models.html#cb216-5"></a>aus_economy <span class="op">%&gt;%</span></span>
<span id="cb216-6"><a href="arima-models.html#cb216-6"></a><span class="st">  </span><span class="kw">slice</span>(<span class="op">-</span><span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb216-7"><a href="arima-models.html#cb216-7"></a><span class="st">  </span><span class="kw">stretch_tsibble</span>(<span class="dt">.init =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb216-8"><a href="arima-models.html#cb216-8"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb216-9"><a href="arima-models.html#cb216-9"></a>    <span class="kw">ETS</span>(Population),</span>
<span id="cb216-10"><a href="arima-models.html#cb216-10"></a>    <span class="kw">ARIMA</span>(Population)</span>
<span id="cb216-11"><a href="arima-models.html#cb216-11"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb216-12"><a href="arima-models.html#cb216-12"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb216-13"><a href="arima-models.html#cb216-13"></a><span class="st">  </span><span class="kw">accuracy</span>(aus_economy)</span>
<span id="cb216-14"><a href="arima-models.html#cb216-14"></a><span class="co">#&gt; # A tibble: 2 x 10</span></span>
<span id="cb216-15"><a href="arima-models.html#cb216-15"></a><span class="co">#&gt;   .model            Country   .type     ME   RMSE    MAE   MPE  MAPE  MASE  ACF1</span></span>
<span id="cb216-16"><a href="arima-models.html#cb216-16"></a><span class="co">#&gt;   &lt;chr&gt;             &lt;fct&gt;     &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb216-17"><a href="arima-models.html#cb216-17"></a><span class="co">#&gt; 1 ARIMA(Population) Australia Test  0.0420 0.194  0.0789 0.277 0.509 0.317 0.188</span></span>
<span id="cb216-18"><a href="arima-models.html#cb216-18"></a><span class="co">#&gt; 2 ETS(Population)   Australia Test  0.0202 0.0774 0.0543 0.112 0.327 0.218 0.506</span></span></code></pre></div>
<p>In this case the ETS model has higher accuracy on the cross-validated performance measures. Below we generate and plot forecasts for the next 5 years generated from an ETS model.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="arima-models.html#cb217-1"></a>aus_economy <span class="op">%&gt;%</span></span>
<span id="cb217-2"><a href="arima-models.html#cb217-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Population)) <span class="op">%&gt;%</span></span>
<span id="cb217-3"><a href="arima-models.html#cb217-3"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb217-4"><a href="arima-models.html#cb217-4"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_economy)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-43-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="example-comparing-arima-and-ets-on-seasonal-data" class="section level3">
<h3><span class="header-section-number">10.7.2</span> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</h3>
<p>In this case we want to compare seasonal ARIMA and ETS models applied to the quarterly cement production data (from aus_production). This time we separate the original data into testing set and training set. We create a training set from the beginning of 1988 to the end of 2007 and select an ARIMA and an ETS model using the <code>ARIMA()</code> and <code>ETS()</code> functions.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="arima-models.html#cb218-1"></a><span class="co"># Consider the cement data beginning in 1988</span></span>
<span id="cb218-2"><a href="arima-models.html#cb218-2"></a>cement &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span></span>
<span id="cb218-3"><a href="arima-models.html#cb218-3"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">year</span>(Quarter) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1988</span>)</span>
<span id="cb218-4"><a href="arima-models.html#cb218-4"></a></span>
<span id="cb218-5"><a href="arima-models.html#cb218-5"></a><span class="co"># Use 20 years of the data as the training set</span></span>
<span id="cb218-6"><a href="arima-models.html#cb218-6"></a>train &lt;-<span class="st"> </span>cement <span class="op">%&gt;%</span></span>
<span id="cb218-7"><a href="arima-models.html#cb218-7"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">year</span>(Quarter) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2007</span>)</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="arima-models.html#cb219-1"></a>cement_fit_arima &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">ARIMA</span>(Cement))</span>
<span id="cb219-2"><a href="arima-models.html#cb219-2"></a></span>
<span id="cb219-3"><a href="arima-models.html#cb219-3"></a><span class="kw">report</span>(cement_fit_arima)</span>
<span id="cb219-4"><a href="arima-models.html#cb219-4"></a><span class="co">#&gt; Series: Cement </span></span>
<span id="cb219-5"><a href="arima-models.html#cb219-5"></a><span class="co">#&gt; Model: ARIMA(1,0,1)(2,1,1)[4] w/ drift </span></span>
<span id="cb219-6"><a href="arima-models.html#cb219-6"></a><span class="co">#&gt; </span></span>
<span id="cb219-7"><a href="arima-models.html#cb219-7"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb219-8"><a href="arima-models.html#cb219-8"></a><span class="co">#&gt;          ar1      ma1   sar1     sar2     sma1  constant</span></span>
<span id="cb219-9"><a href="arima-models.html#cb219-9"></a><span class="co">#&gt;       0.8886  -0.2366  0.081  -0.2345  -0.8979    5.3884</span></span>
<span id="cb219-10"><a href="arima-models.html#cb219-10"></a><span class="co">#&gt; s.e.  0.0842   0.1334  0.157   0.1392   0.1780    1.4844</span></span>
<span id="cb219-11"><a href="arima-models.html#cb219-11"></a><span class="co">#&gt; </span></span>
<span id="cb219-12"><a href="arima-models.html#cb219-12"></a><span class="co">#&gt; sigma^2 estimated as 11456:  log likelihood=-463.52</span></span>
<span id="cb219-13"><a href="arima-models.html#cb219-13"></a><span class="co">#&gt; AIC=941.03   AICc=942.68   BIC=957.35</span></span></code></pre></div>
<p>Residuals from the ARIMA model appear to be white noise.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="arima-models.html#cb220-1"></a>cement_fit_arima <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-46-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="arima-models.html#cb221-1"></a></span>
<span id="cb221-2"><a href="arima-models.html#cb221-2"></a><span class="kw">augment</span>(cement_fit_arima) <span class="op">%&gt;%</span></span>
<span id="cb221-3"><a href="arima-models.html#cb221-3"></a><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">8</span>, <span class="dt">dof =</span> <span class="dv">7</span>)</span>
<span id="cb221-4"><a href="arima-models.html#cb221-4"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb221-5"><a href="arima-models.html#cb221-5"></a><span class="co">#&gt;   .model        lb_stat lb_pvalue</span></span>
<span id="cb221-6"><a href="arima-models.html#cb221-6"></a><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb221-7"><a href="arima-models.html#cb221-7"></a><span class="co">#&gt; 1 ARIMA(Cement)   0.783     0.376</span></span></code></pre></div>
<p>The output below also shows the ETS model selected and estimated by <code>ETS()</code>. This model also does well in capturing all the dynamics in the data</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="arima-models.html#cb222-1"></a>cement_fit_ets &lt;-<span class="st"> </span>train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">ETS</span>(Cement))</span>
<span id="cb222-2"><a href="arima-models.html#cb222-2"></a><span class="kw">report</span>(cement_fit_ets)</span>
<span id="cb222-3"><a href="arima-models.html#cb222-3"></a><span class="co">#&gt; Series: Cement </span></span>
<span id="cb222-4"><a href="arima-models.html#cb222-4"></a><span class="co">#&gt; Model: ETS(M,N,M) </span></span>
<span id="cb222-5"><a href="arima-models.html#cb222-5"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb222-6"><a href="arima-models.html#cb222-6"></a><span class="co">#&gt;     alpha = 0.7533714 </span></span>
<span id="cb222-7"><a href="arima-models.html#cb222-7"></a><span class="co">#&gt;     gamma = 0.0001000093 </span></span>
<span id="cb222-8"><a href="arima-models.html#cb222-8"></a><span class="co">#&gt; </span></span>
<span id="cb222-9"><a href="arima-models.html#cb222-9"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb222-10"><a href="arima-models.html#cb222-10"></a><span class="co">#&gt;         l       s1       s2       s3        s4</span></span>
<span id="cb222-11"><a href="arima-models.html#cb222-11"></a><span class="co">#&gt;  1694.712 1.031179 1.045209 1.011424 0.9121874</span></span>
<span id="cb222-12"><a href="arima-models.html#cb222-12"></a><span class="co">#&gt; </span></span>
<span id="cb222-13"><a href="arima-models.html#cb222-13"></a><span class="co">#&gt;   sigma^2:  0.0034</span></span>
<span id="cb222-14"><a href="arima-models.html#cb222-14"></a><span class="co">#&gt; </span></span>
<span id="cb222-15"><a href="arima-models.html#cb222-15"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb222-16"><a href="arima-models.html#cb222-16"></a><span class="co">#&gt; 1104.095 1105.650 1120.769</span></span>
<span id="cb222-17"><a href="arima-models.html#cb222-17"></a></span>
<span id="cb222-18"><a href="arima-models.html#cb222-18"></a>cement_fit_ets <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gg_tsresiduals</span>()</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="arima-models.html#cb223-1"></a></span>
<span id="cb223-2"><a href="arima-models.html#cb223-2"></a><span class="kw">augment</span>(cement_fit_ets) <span class="op">%&gt;%</span></span>
<span id="cb223-3"><a href="arima-models.html#cb223-3"></a><span class="st">  </span><span class="kw">features</span>(.resid, ljung_box, <span class="dt">lag =</span> <span class="dv">8</span>, <span class="dt">dof =</span> <span class="dv">6</span>)</span>
<span id="cb223-4"><a href="arima-models.html#cb223-4"></a><span class="co">#&gt; # A tibble: 1 x 3</span></span>
<span id="cb223-5"><a href="arima-models.html#cb223-5"></a><span class="co">#&gt;   .model      lb_stat lb_pvalue</span></span>
<span id="cb223-6"><a href="arima-models.html#cb223-6"></a><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb223-7"><a href="arima-models.html#cb223-7"></a><span class="co">#&gt; 1 ETS(Cement)    5.89    0.0525</span></span></code></pre></div>
<p>The output below evaluates the forecasting performance of the two competing models over the test set. In this case the ARIMA model seems to be the slightly more accurate model based on the test set RMSE, MAPE and MASE.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="arima-models.html#cb224-1"></a><span class="kw">bind_rows</span>(</span>
<span id="cb224-2"><a href="arima-models.html#cb224-2"></a>  cement_fit_arima <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">accuracy</span>(),</span>
<span id="cb224-3"><a href="arima-models.html#cb224-3"></a>  cement_fit_ets <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">accuracy</span>(),</span>
<span id="cb224-4"><a href="arima-models.html#cb224-4"></a>  cement_fit_arima <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;2 years 6 months&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb224-5"><a href="arima-models.html#cb224-5"></a><span class="st">    </span><span class="kw">accuracy</span>(cement),</span>
<span id="cb224-6"><a href="arima-models.html#cb224-6"></a>  cement_fit_ets <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;2 years 6 months&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb224-7"><a href="arima-models.html#cb224-7"></a><span class="st">    </span><span class="kw">accuracy</span>(cement)</span>
<span id="cb224-8"><a href="arima-models.html#cb224-8"></a>)</span>
<span id="cb224-9"><a href="arima-models.html#cb224-9"></a><span class="co">#&gt; # A tibble: 4 x 9</span></span>
<span id="cb224-10"><a href="arima-models.html#cb224-10"></a><span class="co">#&gt;   .model        .type         ME  RMSE   MAE    MPE  MAPE  MASE    ACF1</span></span>
<span id="cb224-11"><a href="arima-models.html#cb224-11"></a><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span id="cb224-12"><a href="arima-models.html#cb224-12"></a><span class="co">#&gt; 1 ARIMA(Cement) Training   -6.21  100.  79.9 -0.670  4.37 0.546 -0.0113</span></span>
<span id="cb224-13"><a href="arima-models.html#cb224-13"></a><span class="co">#&gt; 2 ETS(Cement)   Training   12.8   103.  80.0  0.427  4.41 0.547 -0.0528</span></span>
<span id="cb224-14"><a href="arima-models.html#cb224-14"></a><span class="co">#&gt; 3 ARIMA(Cement) Test     -161.    216. 186.  -7.71   8.68 1.27   0.387 </span></span>
<span id="cb224-15"><a href="arima-models.html#cb224-15"></a><span class="co">#&gt; 4 ETS(Cement)   Test     -171.    222. 191.  -8.07   8.85 1.30   0.579</span></span></code></pre></div>
<p>Notice that the ETS model fits the training data slightly better than the ARIMA model, but that the ARIMA model provides more accurate forecasts on the test set. A good fit to training data is never an indication that the model will forecast well. Below we generate and plot forecasts from an ETS model for the next 3 years.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="arima-models.html#cb225-1"></a><span class="co"># Generate forecasts from an ETS model</span></span>
<span id="cb225-2"><a href="arima-models.html#cb225-2"></a>cement <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb225-3"><a href="arima-models.html#cb225-3"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Cement)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb225-4"><a href="arima-models.html#cb225-4"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;3 years&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb225-5"><a href="arima-models.html#cb225-5"></a><span class="st">  </span><span class="kw">autoplot</span>(cement)</span></code></pre></div>
<p><img src="ch9_files/figure-html/unnamed-chunk-49-1.png" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="univariate-stationary-processes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic-regression-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/fpp/edit/master/ch9.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
