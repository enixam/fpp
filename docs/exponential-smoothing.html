<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Exponential smoothing | Notes for “Forecasting: Principles and Practice, 3rd edition”</title>
  <meta name="description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Exponential smoothing | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  <meta name="github-repo" content="enixam/fpp" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Exponential smoothing | Notes for “Forecasting: Principles and Practice, 3rd edition”" />
  
  <meta name="twitter:description" content="“Reproducing”Forecasting: Principles and Practice, 3rd edition"" />
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series-regression-models.html"/>
<link rel="next" href="univariate-stationary-processes.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for fpp3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="time-series-graphics.html"><a href="time-series-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a><ul>
<li class="chapter" data-level="2.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#tsibble-objects"><i class="fa fa-check"></i><b>2.1</b> <code>tsibble</code> objects</a><ul>
<li class="chapter" data-level="2.1.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#manipulation"><i class="fa fa-check"></i><b>2.1.1</b> manipulation</a></li>
<li class="chapter" data-level="2.1.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#importing"><i class="fa fa-check"></i><b>2.1.2</b> importing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#time-plots"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="time-series-graphics.html"><a href="time-series-graphics.html#patterns-of-time-series-trend-seasonal-and-cyclic"><i class="fa fa-check"></i><b>2.3</b> Patterns of time series: trend, seasonal and cyclic</a></li>
<li class="chapter" data-level="2.4" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-plots"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a><ul>
<li class="chapter" data-level="2.4.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#multiple-seasonal-periods-period-in-gg_season"><i class="fa fa-check"></i><b>2.4.1</b> Multiple seasonal periods: <code>period</code> in <code>gg_season()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="time-series-graphics.html"><a href="time-series-graphics.html#seasonal-subseries-plots"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a><ul>
<li class="chapter" data-level="2.5.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>2.5.1</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="time-series-graphics.html"><a href="time-series-graphics.html#visualization-between-time-series"><i class="fa fa-check"></i><b>2.6</b> Visualization between time series</a><ul>
<li class="chapter" data-level="2.6.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#scatterplot-matrices"><i class="fa fa-check"></i><b>2.6.1</b> scatterplot matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="time-series-graphics.html"><a href="time-series-graphics.html#lag-plots"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a><ul>
<li class="chapter" data-level="2.7.1" data-path="time-series-graphics.html"><a href="time-series-graphics.html#autocorrelation"><i class="fa fa-check"></i><b>2.7.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.7.2" data-path="time-series-graphics.html"><a href="time-series-graphics.html#trend-and-seasonality-in-acf-plots"><i class="fa fa-check"></i><b>2.7.2</b> Trend and seasonality in ACF plots</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="time-series-graphics.html"><a href="time-series-graphics.html#calendar-plots"><i class="fa fa-check"></i><b>2.8</b> Calendar plots</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>3</b> Time series decomposition</a><ul>
<li class="chapter" data-level="3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#transformation-and-adjustments"><i class="fa fa-check"></i><b>3.1</b> Transformation and adjustments</a><ul>
<li class="chapter" data-level="3.1.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#calendar-adjustments"><i class="fa fa-check"></i><b>3.1.1</b> Calendar adjustments</a></li>
<li class="chapter" data-level="3.1.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#population-adjustments"><i class="fa fa-check"></i><b>3.1.2</b> Population adjustments</a></li>
<li class="chapter" data-level="3.1.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#inflation-adjustments"><i class="fa fa-check"></i><b>3.1.3</b> Inflation adjustments</a></li>
<li class="chapter" data-level="3.1.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#box-cox"><i class="fa fa-check"></i><b>3.1.4</b> Mathematical transformation (Box-Cox)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages"><i class="fa fa-check"></i><b>3.2</b> Moving averages</a><ul>
<li class="chapter" data-level="3.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#moving-averages-of-moving-averages"><i class="fa fa-check"></i><b>3.2.1</b> Moving averages of moving averages</a></li>
<li class="chapter" data-level="3.2.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#estimating-the-trend-cycle-component-with-seasonal-data"><i class="fa fa-check"></i><b>3.2.2</b> Estimating the trend-cycle component with seasonal data</a></li>
<li class="chapter" data-level="3.2.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#weighted-moving-averages"><i class="fa fa-check"></i><b>3.2.3</b> Weighted moving averages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decomposition"><i class="fa fa-check"></i><b>3.3</b> Classical decomposition</a></li>
<li class="chapter" data-level="3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#x11-decomposition"><i class="fa fa-check"></i><b>3.4</b> X11 decomposition</a></li>
<li class="chapter" data-level="3.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#seats-decomposition"><i class="fa fa-check"></i><b>3.5</b> SEATS decomposition</a></li>
<li class="chapter" data-level="3.6" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#stl-decomposition"><i class="fa fa-check"></i><b>3.6</b> STL decomposition</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="time-series-features.html"><a href="time-series-features.html"><i class="fa fa-check"></i><b>4</b> Time series features</a><ul>
<li class="chapter" data-level="4.1" data-path="time-series-features.html"><a href="time-series-features.html#simple-statistics"><i class="fa fa-check"></i><b>4.1</b> Simple statistics</a></li>
<li class="chapter" data-level="4.2" data-path="time-series-features.html"><a href="time-series-features.html#acf-features"><i class="fa fa-check"></i><b>4.2</b> ACF features</a></li>
<li class="chapter" data-level="4.3" data-path="time-series-features.html"><a href="time-series-features.html#stl-features"><i class="fa fa-check"></i><b>4.3</b> STL features</a></li>
<li class="chapter" data-level="4.4" data-path="time-series-features.html"><a href="time-series-features.html#other-features"><i class="fa fa-check"></i><b>4.4</b> Other features</a></li>
<li class="chapter" data-level="4.5" data-path="time-series-features.html"><a href="time-series-features.html#exporing-australian-tourism-data"><i class="fa fa-check"></i><b>4.5</b> Exporing Australian tourism data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html"><i class="fa fa-check"></i><b>5</b> The forecaster’s toolbox</a><ul>
<li class="chapter" data-level="5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#a-tidy-forecasting-workflow"><i class="fa fa-check"></i><b>5.1</b> A tidy forecasting workflow</a><ul>
<li class="chapter" data-level="5.1.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#data-preparation-tidy"><i class="fa fa-check"></i><b>5.1.1</b> Data preparation (tidy)</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#visualize"><i class="fa fa-check"></i><b>5.1.2</b> Visualize</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#define-a-model-specify"><i class="fa fa-check"></i><b>5.1.3</b> Define a model (specify)</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#train-the-model-estimate"><i class="fa fa-check"></i><b>5.1.4</b> Train the model (estimate)</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#check-model-performance-evaluate"><i class="fa fa-check"></i><b>5.1.5</b> Check model performance (evaluate)</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#produce-forecasts-forecast"><i class="fa fa-check"></i><b>5.1.6</b> Produce forecasts (forecast)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#some-simple-forecasting-methods"><i class="fa fa-check"></i><b>5.2</b> Some simple forecasting methods</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#mean-method"><i class="fa fa-check"></i><b>5.2.1</b> Mean method</a></li>
<li class="chapter" data-level="5.2.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#naive-method"><i class="fa fa-check"></i><b>5.2.2</b> Naive method</a></li>
<li class="chapter" data-level="5.2.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#seasonal-naive-method"><i class="fa fa-check"></i><b>5.2.3</b> Seasonal naive method</a></li>
<li class="chapter" data-level="5.2.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#drift-method"><i class="fa fa-check"></i><b>5.2.4</b> Drift method</a></li>
<li class="chapter" data-level="5.2.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#australian-quarterly-beer-production"><i class="fa fa-check"></i><b>5.2.5</b> Australian quarterly beer production</a></li>
<li class="chapter" data-level="5.2.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-googles-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.2.6</b> Example: Google’s daily closing stock price</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#fitted-values-and-residuals"><i class="fa fa-check"></i><b>5.3</b> Fitted values and residuals</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residuals"><i class="fa fa-check"></i><b>5.3.1</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#residual-diagnostics"><i class="fa fa-check"></i><b>5.4</b> Residual diagnostics</a><ul>
<li class="chapter" data-level="5.4.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#white-noise"><i class="fa fa-check"></i><b>5.4.1</b> White noise</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecasting-the-google-daily-closing-stock-price"><i class="fa fa-check"></i><b>5.4.2</b> Example: Forecasting the Google daily closing stock price</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#portmanteau-tests-for-autocorrelation"><i class="fa fa-check"></i><b>5.4.3</b> Portmanteau tests for autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#predict-interval"><i class="fa fa-check"></i><b>5.5</b> Prediction intervals</a><ul>
<li class="chapter" data-level="5.5.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#one-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.1</b> One-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#multi-step-prediction-intervals"><i class="fa fa-check"></i><b>5.5.2</b> Multi-step prediction intervals</a></li>
<li class="chapter" data-level="5.5.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-from-bootstrapped-residuals"><i class="fa fa-check"></i><b>5.5.3</b> Prediction intervals from bootstrapped residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#evaluating-model-accuracy"><i class="fa fa-check"></i><b>5.6</b> Evaluating model accuracy</a><ul>
<li class="chapter" data-level="5.6.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecast-errors"><i class="fa fa-check"></i><b>5.6.1</b> Forecast errors</a></li>
<li class="chapter" data-level="5.6.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scale-dependent-errors"><i class="fa fa-check"></i><b>5.6.2</b> Scale dependent errors</a></li>
<li class="chapter" data-level="5.6.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#percentage-errors"><i class="fa fa-check"></i><b>5.6.3</b> Percentage errors</a></li>
<li class="chapter" data-level="5.6.4" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#scaled-errors"><i class="fa fa-check"></i><b>5.6.4</b> Scaled errors</a></li>
<li class="chapter" data-level="5.6.5" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#examples-beer-production"><i class="fa fa-check"></i><b>5.6.5</b> Examples: beer production</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#time-series-cross-validation"><i class="fa fa-check"></i><b>5.7</b> Time series cross-validation</a><ul>
<li class="chapter" data-level="5.7.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-forecast-horizon-accuracy-with-cross-validation"><i class="fa fa-check"></i><b>5.7.1</b> Example: Forecast horizon accuracy with cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-using-transformations"><i class="fa fa-check"></i><b>5.8</b> Forecasting using transformations</a><ul>
<li class="chapter" data-level="5.8.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#prediction-intervals-with-transformations"><i class="fa fa-check"></i><b>5.8.1</b> Prediction intervals with transformations</a></li>
<li class="chapter" data-level="5.8.2" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-constraints"><i class="fa fa-check"></i><b>5.8.2</b> Forecasting with constraints</a></li>
<li class="chapter" data-level="5.8.3" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#bias-adjustments"><i class="fa fa-check"></i><b>5.8.3</b> Bias adjustments</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#forecasting-with-decomposition"><i class="fa fa-check"></i><b>5.9</b> Forecasting with decomposition</a><ul>
<li class="chapter" data-level="5.9.1" data-path="the-forecasters-toolbox.html"><a href="the-forecasters-toolbox.html#example-employment-in-the-us-retail-sector"><i class="fa fa-check"></i><b>5.9.1</b> Example: Employment in the US retail sector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html"><i class="fa fa-check"></i><b>6</b> Judgmental forecasts</a><ul>
<li class="chapter" data-level="6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#beware-of-limitations"><i class="fa fa-check"></i><b>6.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#key-principles"><i class="fa fa-check"></i><b>6.2</b> Key principles</a></li>
<li class="chapter" data-level="6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-delphi-method"><i class="fa fa-check"></i><b>6.3</b> The Delphi method</a><ul>
<li class="chapter" data-level="6.3.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#experts-and-anonymity"><i class="fa fa-check"></i><b>6.3.1</b> Experts and anonymity</a></li>
<li class="chapter" data-level="6.3.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#setting-the-forecasting-task-in-a-delphi"><i class="fa fa-check"></i><b>6.3.2</b> Setting the forecasting task in a Delphi</a></li>
<li class="chapter" data-level="6.3.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#iteration"><i class="fa fa-check"></i><b>6.3.3</b> Iteration</a></li>
<li class="chapter" data-level="6.3.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#final-forecasts"><i class="fa fa-check"></i><b>6.3.4</b> Final forecasts</a></li>
<li class="chapter" data-level="6.3.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#limitations-and-variations"><i class="fa fa-check"></i><b>6.3.5</b> Limitations and variations</a></li>
<li class="chapter" data-level="6.3.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#the-facilitator"><i class="fa fa-check"></i><b>6.3.6</b> The facilitator</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#forecasting-by-analogy"><i class="fa fa-check"></i><b>6.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="6.5" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#scenario-forecasting"><i class="fa fa-check"></i><b>6.5</b> Scenario forecasting</a></li>
<li class="chapter" data-level="6.6" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#new-product-forecasting"><i class="fa fa-check"></i><b>6.6</b> New product forecasting</a><ul>
<li class="chapter" data-level="6.6.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#sales-force-composite"><i class="fa fa-check"></i><b>6.6.1</b> Sales force composite</a></li>
<li class="chapter" data-level="6.6.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#executive-opinion"><i class="fa fa-check"></i><b>6.6.2</b> Executive opinion</a></li>
<li class="chapter" data-level="6.6.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#customer-intentions"><i class="fa fa-check"></i><b>6.6.3</b> Customer intentions</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#judgmental-adjustments"><i class="fa fa-check"></i><b>6.7</b> Judgmental adjustments</a><ul>
<li class="chapter" data-level="6.7.1" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#use-adjustments-sparingly"><i class="fa fa-check"></i><b>6.7.1</b> Use adjustments sparingly</a></li>
<li class="chapter" data-level="6.7.2" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#apply-a-structured-approach"><i class="fa fa-check"></i><b>6.7.2</b> Apply a structured approach</a></li>
<li class="chapter" data-level="6.7.3" data-path="judgmental-forecasts.html"><a href="judgmental-forecasts.html#example-tourism-forecasting-committee-tfc"><i class="fa fa-check"></i><b>6.7.3</b> Example: Tourism Forecasting Committee (TFC)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html"><i class="fa fa-check"></i><b>7</b> Time series regression models</a><ul>
<li class="chapter" data-level="7.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-linear-model"><i class="fa fa-check"></i><b>7.1</b> The linear model</a><ul>
<li class="chapter" data-level="7.1.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="7.1.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#assumptions"><i class="fa fa-check"></i><b>7.1.3</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>7.2</b> Least squares estimation</a><ul>
<li class="chapter" data-level="7.2.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fitted-values"><i class="fa fa-check"></i><b>7.2.1</b> Fitted values</a></li>
<li class="chapter" data-level="7.2.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.2.2</b> Goodness of fit</a></li>
<li class="chapter" data-level="7.2.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#standard-error-of-the-regression"><i class="fa fa-check"></i><b>7.2.3</b> Standard error of the regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#evaluating-a-regression-model"><i class="fa fa-check"></i><b>7.3</b> Evaluating a regression model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-predictors"><i class="fa fa-check"></i><b>7.3.1</b> Residual plots against predictors</a></li>
<li class="chapter" data-level="7.3.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#residual-plots-against-fitted-values"><i class="fa fa-check"></i><b>7.3.2</b> Residual plots against fitted values</a></li>
<li class="chapter" data-level="7.3.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#outliers-and-influential-observations"><i class="fa fa-check"></i><b>7.3.3</b> Outliers and influential observations</a></li>
<li class="chapter" data-level="7.3.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#the-performance-package"><i class="fa fa-check"></i><b>7.3.4</b> The <code>performance</code> package</a></li>
<li class="chapter" data-level="7.3.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#spurious-regression"><i class="fa fa-check"></i><b>7.3.5</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#some-useful-predictors"><i class="fa fa-check"></i><b>7.4</b> Some useful predictors</a><ul>
<li class="chapter" data-level="7.4.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trend"><i class="fa fa-check"></i><b>7.4.1</b> Trend</a></li>
<li class="chapter" data-level="7.4.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#seasonal-dummy-variables"><i class="fa fa-check"></i><b>7.4.2</b> Seasonal dummy variables</a></li>
<li class="chapter" data-level="7.4.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-australian-quarterly-beer-production"><i class="fa fa-check"></i><b>7.4.3</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.4.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#intervention-variables"><i class="fa fa-check"></i><b>7.4.4</b> Intervention variables</a></li>
<li class="chapter" data-level="7.4.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#trading-days"><i class="fa fa-check"></i><b>7.4.5</b> Trading days</a></li>
<li class="chapter" data-level="7.4.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#distributed-lags"><i class="fa fa-check"></i><b>7.4.6</b> Distributed lags</a></li>
<li class="chapter" data-level="7.4.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#easter"><i class="fa fa-check"></i><b>7.4.7</b> Easter</a></li>
<li class="chapter" data-level="7.4.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#fourier-sereis"><i class="fa fa-check"></i><b>7.4.8</b> Fourier sereis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#selecting-predictors"><i class="fa fa-check"></i><b>7.5</b> Selecting predictors</a><ul>
<li class="chapter" data-level="7.5.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#adjusst-r-square"><i class="fa fa-check"></i><b>7.5.1</b> Adjusst R square</a></li>
<li class="chapter" data-level="7.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#cross-validation"><i class="fa fa-check"></i><b>7.5.2</b> Cross validation</a></li>
<li class="chapter" data-level="7.5.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#akaikes-information-criterion"><i class="fa fa-check"></i><b>7.5.3</b> Akaike’s Information Criterion</a></li>
<li class="chapter" data-level="7.5.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#bayesian-information-criterion"><i class="fa fa-check"></i><b>7.5.4</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="7.5.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#which-measure-should-we-suse"><i class="fa fa-check"></i><b>7.5.5</b> Which measure should we suse</a></li>
<li class="chapter" data-level="7.5.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-us-consumption"><i class="fa fa-check"></i><b>7.5.6</b> Example: US consumption</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-regression"><i class="fa fa-check"></i><b>7.6</b> Forecasting with regression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#ex-ante-versus-ex-post-forecasts"><i class="fa fa-check"></i><b>7.6.1</b> Ex-ante versus ex-post forecasts</a></li>
<li class="chapter" data-level="7.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-australian-quarterly-beer-production-1"><i class="fa fa-check"></i><b>7.6.2</b> Example: Australian quarterly beer production</a></li>
<li class="chapter" data-level="7.6.3" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#scenario-based-forecasting"><i class="fa fa-check"></i><b>7.6.3</b> Scenario based forecasting</a></li>
<li class="chapter" data-level="7.6.4" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>7.6.4</b> Prediction intervals</a></li>
<li class="chapter" data-level="7.6.5" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#building-a-predictive-regression-model"><i class="fa fa-check"></i><b>7.6.5</b> Building a predictive regression model</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#matrix-formulation"><i class="fa fa-check"></i><b>7.7</b> Matrix formulation</a></li>
<li class="chapter" data-level="7.8" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#nonlinear-regression"><i class="fa fa-check"></i><b>7.8</b> Nonlinear regression</a><ul>
<li class="chapter" data-level="7.8.1" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#forecasting-with-a-nonlinear-trend"><i class="fa fa-check"></i><b>7.8.1</b> Forecasting with a nonlinear trend</a></li>
<li class="chapter" data-level="7.8.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#example-boston-marathon-winning-times"><i class="fa fa-check"></i><b>7.8.2</b> Example: Boston marathon winning times</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#correlation-causation-and-forecasting"><i class="fa fa-check"></i><b>7.9</b> Correlation, causation and forecasting</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>8</b> Exponential smoothing</a><ul>
<li class="chapter" data-level="8.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>8.1</b> Simple exponential smoothing</a><ul>
<li class="chapter" data-level="8.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#weighted-average-form"><i class="fa fa-check"></i><b>8.1.1</b> Weighted average form</a></li>
<li class="chapter" data-level="8.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#component-form"><i class="fa fa-check"></i><b>8.1.2</b> Component form</a></li>
<li class="chapter" data-level="8.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#flat-forecast"><i class="fa fa-check"></i><b>8.1.3</b> Flat forecast</a></li>
<li class="chapter" data-level="8.1.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>8.1.4</b> Estimation</a></li>
<li class="chapter" data-level="8.1.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>8.1.5</b> Example: Algerian exports</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#methods-with-trend-and-seasonality"><i class="fa fa-check"></i><b>8.2</b> Methods with trend and seasonality</a><ul>
<li class="chapter" data-level="8.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend-method"><i class="fa fa-check"></i><b>8.2.1</b> Holt’s linear trend method</a></li>
<li class="chapter" data-level="8.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population"><i class="fa fa-check"></i><b>8.2.2</b> Example: Australian population</a></li>
<li class="chapter" data-level="8.2.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-methods"><i class="fa fa-check"></i><b>8.2.3</b> Damped trend methods</a></li>
<li class="chapter" data-level="8.2.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population-continued"><i class="fa fa-check"></i><b>8.2.4</b> Example: Australian Population (continued)</a></li>
<li class="chapter" data-level="8.2.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-internet-usage"><i class="fa fa-check"></i><b>8.2.5</b> Example: Internet usage</a></li>
<li class="chapter" data-level="8.2.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>8.2.6</b> Holt-Winters’ additive method</a></li>
<li class="chapter" data-level="8.2.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>8.2.7</b> Holt-Winters’ multiplicative method</a></li>
<li class="chapter" data-level="8.2.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-overnight-trips-in-australia"><i class="fa fa-check"></i><b>8.2.8</b> Example: Domestic overnight trips in Australia</a></li>
<li class="chapter" data-level="8.2.9" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>8.2.9</b> Holt-Winters’ damped method</a></li>
<li class="chapter" data-level="8.2.10" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-holt-winters-method-with-daily-data"><i class="fa fa-check"></i><b>8.2.10</b> Example: Holt-Winters method with daily data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-taxonomy-of-exponential-smoothing-methods"><i class="fa fa-check"></i><b>8.3</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="8.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing"><i class="fa fa-check"></i><b>8.4</b> Innovations state space models for exponential smoothing</a><ul>
<li class="chapter" data-level="8.4.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-simple-exponential-smoothing-with-additive-errors"><i class="fa fa-check"></i><b>8.4.1</b> ETS(A,N,N): simple exponential smoothing with additive errors</a></li>
<li class="chapter" data-level="8.4.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmnn-simple-exponential-smoothing-with-multiplicative-errors"><i class="fa fa-check"></i><b>8.4.2</b> ETS(M,N,N): simple exponential smoothing with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan-holts-linear-method-with-additive-errors"><i class="fa fa-check"></i><b>8.4.3</b> ETS(A,A,N): Holt’s linear method with additive errors</a></li>
<li class="chapter" data-level="8.4.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#ets-man"><i class="fa fa-check"></i><b>8.4.4</b> ETS(M,A,N): Holt’s linear method with multiplicative errors</a></li>
<li class="chapter" data-level="8.4.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#other-ets-models"><i class="fa fa-check"></i><b>8.4.5</b> Other ETS models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>8.5</b> Estimation and model selection</a><ul>
<li class="chapter" data-level="8.5.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimating-ets-models"><i class="fa fa-check"></i><b>8.5.1</b> Estimating ETS models</a></li>
<li class="chapter" data-level="8.5.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection-criteria"><i class="fa fa-check"></i><b>8.5.2</b> Model selection criteria</a></li>
<li class="chapter" data-level="8.5.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-domestic-holiday-tourist-visitor-nights-in-australia"><i class="fa fa-check"></i><b>8.5.3</b> Example: Domestic holiday tourist visitor nights in Australia</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>8.6</b> Forecasting with ETS models</a><ul>
<li class="chapter" data-level="8.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australia-gas-production"><i class="fa fa-check"></i><b>8.6.1</b> Example: Australia gas production</a></li>
<li class="chapter" data-level="8.6.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>8.6.2</b> Prediction intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html"><i class="fa fa-check"></i><b>9</b> Univariate stationary processes</a><ul>
<li class="chapter" data-level="9.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#stationarity"><i class="fa fa-check"></i><b>9.1</b> Stationarity</a><ul>
<li class="chapter" data-level="9.1.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#ch9-white-noise"><i class="fa fa-check"></i><b>9.1.1</b> White noise</a></li>
<li class="chapter" data-level="9.1.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#tests-for-autocorrelation-and-normality"><i class="fa fa-check"></i><b>9.1.2</b> Tests for autocorrelation and normality</a></li>
<li class="chapter" data-level="9.1.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#the-wold-decomposition"><i class="fa fa-check"></i><b>9.1.3</b> The Wold Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#backshift-notation"><i class="fa fa-check"></i><b>9.2</b> Backshift notation</a></li>
<li class="chapter" data-level="9.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#autoregressive-models"><i class="fa fa-check"></i><b>9.3</b> Autoregressive models</a><ul>
<li class="chapter" data-level="9.3.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#stimulating-an-arp-process"><i class="fa fa-check"></i><b>9.3.1</b> Stimulating an AR(p) process</a></li>
<li class="chapter" data-level="9.3.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#decision-of-order-p"><i class="fa fa-check"></i><b>9.3.2</b> Decision of order p</a></li>
<li class="chapter" data-level="9.3.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#random-walk"><i class="fa fa-check"></i><b>9.3.3</b> Random walk</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#moving-average-models"><i class="fa fa-check"></i><b>9.4</b> Moving average models</a><ul>
<li class="chapter" data-level="9.4.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#simulating-an-maq-process"><i class="fa fa-check"></i><b>9.4.1</b> Simulating an MA(q) process</a></li>
<li class="chapter" data-level="9.4.2" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#decision-of-order-q"><i class="fa fa-check"></i><b>9.4.2</b> Decision of order q</a></li>
<li class="chapter" data-level="9.4.3" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#koyck-transformation-and-invertibility"><i class="fa fa-check"></i><b>9.4.3</b> Koyck transformation and Invertibility</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#arma-models"><i class="fa fa-check"></i><b>9.5</b> ARMA models</a><ul>
<li class="chapter" data-level="9.5.1" data-path="univariate-stationary-processes.html"><a href="univariate-stationary-processes.html#three-representations-of-an-arma-model"><i class="fa fa-check"></i><b>9.5.1</b> Three representations of an ARMA model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>10</b> ARIMA models</a><ul>
<li class="chapter" data-level="10.1" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>10.1</b> Differencing</a><ul>
<li class="chapter" data-level="10.1.1" data-path="arima-models.html"><a href="arima-models.html#second-order-differencing"><i class="fa fa-check"></i><b>10.1.1</b> Second-order differencing</a></li>
<li class="chapter" data-level="10.1.2" data-path="arima-models.html"><a href="arima-models.html#seasonal-differencing"><i class="fa fa-check"></i><b>10.1.2</b> Seasonal differencing</a></li>
<li class="chapter" data-level="10.1.3" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>10.1.3</b> Unit root tests</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>10.2</b> Non-seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.2.1" data-path="arima-models.html"><a href="arima-models.html#understanding-arima-models"><i class="fa fa-check"></i><b>10.2.1</b> Understanding ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>10.3</b> Estimation and order selection</a><ul>
<li class="chapter" data-level="10.3.1" data-path="arima-models.html"><a href="arima-models.html#mle"><i class="fa fa-check"></i><b>10.3.1</b> MLE</a></li>
<li class="chapter" data-level="10.3.2" data-path="arima-models.html"><a href="arima-models.html#information-criteria"><i class="fa fa-check"></i><b>10.3.2</b> Information Criteria</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="arima-models.html"><a href="arima-models.html#the-arima-function"><i class="fa fa-check"></i><b>10.4</b> The <code>ARIMA()</code> function</a><ul>
<li class="chapter" data-level="10.4.1" data-path="arima-models.html"><a href="arima-models.html#algorithm"><i class="fa fa-check"></i><b>10.4.1</b> Algorithm</a></li>
<li class="chapter" data-level="10.4.2" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure"><i class="fa fa-check"></i><b>10.4.2</b> Modelling procedure</a></li>
<li class="chapter" data-level="10.4.3" data-path="arima-models.html"><a href="arima-models.html#example-seasonally-adjusted-electrical-equipment-orders"><i class="fa fa-check"></i><b>10.4.3</b> Example: Seasonally adjusted electrical equipment orders</a></li>
<li class="chapter" data-level="10.4.4" data-path="arima-models.html"><a href="arima-models.html#plotting-the-characteristic-roots"><i class="fa fa-check"></i><b>10.4.4</b> Plotting the characteristic roots</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="arima-models.html"><a href="arima-models.html#forecasting-with-arima-models"><i class="fa fa-check"></i><b>10.5</b> Forecasting with ARIMA models</a><ul>
<li class="chapter" data-level="10.5.1" data-path="arima-models.html"><a href="arima-models.html#point-forecasts"><i class="fa fa-check"></i><b>10.5.1</b> Point forecasts</a></li>
<li class="chapter" data-level="10.5.2" data-path="time-series-regression-models.html"><a href="time-series-regression-models.html#prediction-intervals"><i class="fa fa-check"></i><b>10.5.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>10.6</b> Seasonal ARIMA models</a><ul>
<li class="chapter" data-level="10.6.1" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf"><i class="fa fa-check"></i><b>10.6.1</b> ACF and PACF</a></li>
<li class="chapter" data-level="10.6.2" data-path="arima-models.html"><a href="arima-models.html#example-european-quarterly-retail-trade"><i class="fa fa-check"></i><b>10.6.2</b> Example: European quarterly retail trade</a></li>
<li class="chapter" data-level="10.6.3" data-path="arima-models.html"><a href="arima-models.html#example-corticosteroid-drug-sales-in-australia"><i class="fa fa-check"></i><b>10.6.3</b> Example: Corticosteroid drug sales in Australia</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="arima-models.html"><a href="arima-models.html#ets-and-arima"><i class="fa fa-check"></i><b>10.7</b> ETS and ARIMA</a><ul>
<li class="chapter" data-level="10.7.1" data-path="arima-models.html"><a href="arima-models.html#example-comparing-arima-and-ets-on-non-seasonal-data"><i class="fa fa-check"></i><b>10.7.1</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on non-seasonal data</a></li>
<li class="chapter" data-level="10.7.2" data-path="arima-models.html"><a href="arima-models.html#example-comparing-arima-and-ets-on-seasonal-data"><i class="fa fa-check"></i><b>10.7.2</b> Example: Comparing <code>ARIMA()</code> and <code>ETS()</code> on seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html"><i class="fa fa-check"></i><b>11</b> Dynamic regression models</a><ul>
<li class="chapter" data-level="11.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimation"><i class="fa fa-check"></i><b>11.1</b> Estimation</a></li>
<li class="chapter" data-level="11.2" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#regression-with-arima-errors"><i class="fa fa-check"></i><b>11.2</b> Regression with ARIMA errors</a><ul>
<li class="chapter" data-level="11.2.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-us-personal-consumption-and-income"><i class="fa fa-check"></i><b>11.2.1</b> Example: US Personal Consumption and Income</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#forecasting"><i class="fa fa-check"></i><b>11.3</b> Forecasting</a><ul>
<li class="chapter" data-level="11.3.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-forecasting-electricity-demand"><i class="fa fa-check"></i><b>11.3.1</b> Example: Forecasting electricity demand</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#deterministic-and-stochastic-trends"><i class="fa fa-check"></i><b>11.4</b> Deterministic and stochastic trends</a><ul>
<li class="chapter" data-level="11.4.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-international-visitors-to-australia"><i class="fa fa-check"></i><b>11.4.1</b> Example: International visitors to Australia</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#dynamic-harmonic-regression"><i class="fa fa-check"></i><b>11.5</b> Dynamic harmonic regression</a><ul>
<li class="chapter" data-level="11.5.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-australian-eating-out-expenditure"><i class="fa fa-check"></i><b>11.5.1</b> Example: Australian eating out expenditure</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#lagged-predictors"><i class="fa fa-check"></i><b>11.6</b> Lagged predictors</a><ul>
<li class="chapter" data-level="11.6.1" data-path="dynamic-regression-models.html"><a href="dynamic-regression-models.html#example-tv-advertising-and-insurance-quotations"><i class="fa fa-check"></i><b>11.6.1</b> Example: TV advertising and insurance quotations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for “Forecasting: Principles and Practice, 3rd edition”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exponential-smoothing" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Exponential smoothing</h1>
<p>Exponential smoothing was proposed in the late 1950s (<span class="citation">(Brown <a href="references.html#ref-brown1959statistical" role="doc-biblioref">1959</a>; Holt <a href="references.html#ref-holt1957forecasting" role="doc-biblioref">1957</a>; Winters <a href="references.html#ref-winters1960forecasting" role="doc-biblioref">1960</a>)</span>), and has motivated some of the most successful forecasting methods. Forecasts produced using exponential smoothing methods are weighted averages of past observations, with the weights decaying exponentially as the observations get older. In other words, the more recent the observation the higher the associated weight. This framework generates reliable forecasts quickly and for a wide range of time series, which is a great advantage and of major importance to applications in industry.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="exponential-smoothing.html#cb144-1"></a><span class="kw">library</span>(tsibble)</span>
<span id="cb144-2"><a href="exponential-smoothing.html#cb144-2"></a><span class="kw">library</span>(tsibbledata)</span>
<span id="cb144-3"><a href="exponential-smoothing.html#cb144-3"></a><span class="kw">library</span>(feasts)</span>
<span id="cb144-4"><a href="exponential-smoothing.html#cb144-4"></a><span class="kw">library</span>(fable)</span>
<span id="cb144-5"><a href="exponential-smoothing.html#cb144-5"></a><span class="kw">library</span>(lubridate)</span></code></pre></div>
<div id="simple-exponential-smoothing" class="section level2">
<h2><span class="header-section-number">8.1</span> Simple exponential smoothing</h2>
<p>The simplest of the exponentially smoothing methods is naturally called simple exponential smoothing (SES). This method is suitable for forecasting data with <strong>no clear trend or seasonal pattern</strong>.</p>
<p>For example, <code>algeria_economy</code> below do not display any clear trending behaviour or any seasonality. (There is a decline in the last few years, which might suggest a trend. We will consider whether a trended method would be better for this series later in this chapter.)</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="exponential-smoothing.html#cb145-1"></a>algeria_economy &lt;-<span class="st"> </span>tsibbledata<span class="op">::</span>global_economy <span class="op">%&gt;%</span></span>
<span id="cb145-2"><a href="exponential-smoothing.html#cb145-2"></a><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;Algeria&quot;</span>)</span>
<span id="cb145-3"><a href="exponential-smoothing.html#cb145-3"></a>algeria_economy <span class="op">%&gt;%</span></span>
<span id="cb145-4"><a href="exponential-smoothing.html#cb145-4"></a><span class="st">  </span><span class="kw">autoplot</span>(Exports) <span class="op">+</span></span>
<span id="cb145-5"><a href="exponential-smoothing.html#cb145-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Exports (% of GDP)&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>While the naïve method and average method can be considered as two extremes: all weight given to the last observation and equal weight given to all of the observations, we often want something in between. This is the idea behind the exponential smoothing method. Forecasts are calculated using weighted averages, where the weights decrease exponentially as observations come from further in the past — the smallest weights are associated with the oldest observations:</p>
<p><span class="math display" id="eq:simple-smoothing">\[\begin{equation}
\tag{8.1}
\hat{y}_{T+1|T} = \alpha y_T + \alpha(1 - \alpha)y_{T-1} + \alpha(1-\alpha)^2y_{T-2} + \cdots
\end{equation}\]</span></p>
<p>where <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span> is called a <strong>smoothing parameter</strong>, controlly the rate at which the weights decrease.<br />
A larger <span class="math inline">\(\alpha\)</span> means more weight is given to recent observations (large weight first and decrease quickly), and a smaller <span class="math inline">\(\alpha\)</span> means more weight is given to observations from the more distant past (small weight first but decrease slowly).</p>
<p>We present two equivalent forms of simple exponential smoothing, each of which leads to the forecast Equation <a href="exponential-smoothing.html#eq:simple-smoothing">(8.1)</a></p>
<div id="weighted-average-form" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Weighted average form</h3>
<p><span class="math display">\[
\begin{aligned}
\hat{y}_{T+1|T} &amp;= \alpha y_T + (1 - \alpha) \hat{y}_{T|T-1} \\ 
\hat{y}_{T|T-1} &amp;= \alpha y_{T-1} + (1 - \alpha) \hat{y}_{T-1|T-2} \\
\vdots \\
\hat{y}_{4|3}  &amp;= \alpha y_3 + (1 - \alpha) \hat{y}_{3|2} \\ 
\hat{y}_{3|2}  &amp;= \alpha y_2 + (1 - \alpha) \hat{y}_{2|1} \\ 
\hat{y}_{2|1} &amp;= \alpha y_1 + (1-\alpha) l_0 
\end{aligned}
\]</span>
Note we denote <span class="math inline">\(\hat{y}_1\)</span> with <span class="math inline">\(\ell_0\)</span>, which we will have to estimate.</p>
<p>Substituting upwards, we get :</p>
<p><span class="math display">\[
\begin{aligned}
\hat{y}_{2|1} &amp;= \alpha y_1 + (1-\alpha) \ell_0 \\
\hat{y}_{3|2}  &amp;= \alpha y_2 + (1 - \alpha) (\alpha y_1 + (1-\alpha) \ell_0) = \alpha y_2 + \alpha(1 - \alpha)y_1 + (1 - \alpha)^2 \ell_0 \\ 
\hat{y}_{4|3} &amp;= \alpha{y}_3 + (1 - \alpha)(\alpha y_2 + \alpha(1 - \alpha)y_1 + (1 - \alpha)^2 \ell_0) = \alpha{y}_3 + \alpha(1- \alpha)y_2 + \alpha(1 - \alpha)^2y_1 + (1 -\alpha)^3\ell_0 \\
\vdots \\
\hat{y}_{T + 1|T} &amp;= \sum_{j = 0}^{T-1}{\alpha(1 - \alpha)^jy_{T -j}} + (1 - \alpha)^T \ell_0
\end{aligned}
\]</span></p>
<p>When <span class="math inline">\(T\)</span> is large, <span class="math inline">\((1 - \alpha)^T \ell_0\)</span> can be ignored. So the least average form approximate the same forecast Equation <a href="exponential-smoothing.html#eq:simple-smoothing">(8.1)</a>.</p>
</div>
<div id="component-form" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Component form</h3>
<p>An alternative representation is the component form. For simple exponential smoothing, the only component included is the level, <span class="math inline">\(\ell\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Component form representations of exponential smoothing methods comprise a forecast equation and a smoothing equation for each of the components included in the method. For <span class="math inline">\(h = 1, 2, \dots\)</span> (any step of forecast), we have</p>
<p><span class="math display">\[
\begin{aligned}
\text{Forecast equation}  \;\;\;\; \hat{y}_{t+h|t} &amp;= \ell_t \\
\text{Smoothing equation}  \;\;\;\;\;\;\;\; \ell_t &amp;= \alpha y_t + (1 - \alpha) \ell_{t-1} 
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\ell_t\)</span> is the level (or the smoothed value) of the series at time <span class="math inline">\(t\)</span>. Setting <span class="math inline">\(h=1\)</span> gives the fitted values, while setting <span class="math inline">\(t=T\)</span> gives the true forecasts beyond the training data.</p>
<p>The forecast equation shows that the forecast value at time <span class="math inline">\(t+1\)</span> is the level at time t, which is essentialy an weighted average of <span class="math inline">\(y_t, y_{t-1}, \dots, y_1\)</span>.</p>
<p>For now the component form seems nothing but a change of notations, yet it will be in the foreground once we start to add more components and build a formal statistical model.</p>
</div>
<div id="flat-forecast" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Flat forecast</h3>
<p>Simple exponential smoothing has a “flat” forecast function (recall the component form, change <span class="math inline">\(h\)</span> does not affect the equation:</p>
<p><span class="math display">\[
\hat{y}_{T + h | T} = \hat{y}_{T + 1 | T} = \hat{y}_{T + 2 | T} = \dots = \ell_t \;\;\;\;\; h = 1, 2, \dots
\]</span></p>
</div>
<div id="estimation" class="section level3">
<h3><span class="header-section-number">8.1.4</span> Estimation</h3>
<p>The application of every exponential smoothing method requires the smoothing parameters and the initial values to be chosen. In particular, for simple exponential smoothing, we need to select the values of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\ell_0\)</span>. All forecasts can be computed from the data once we know those values. For the methods that follow there is usually more than one smoothing parameter and more than one initial component to be chosen.</p>
<p>In some cases, the smoothing parameters may be chosen in a subjective manner — the forecaster specifies the value of the smoothing parameters based on previous experience. However, a more reliable and objective way to obtain values for the unknown parameters is to estimate them from the observed data. We find the values of the unknown parameters and the initial values that minimise</p>
<p><span class="math display">\[
\text{SSE} = \sum_{t = 1}^T{y_t - \hat{y}_{t |t-1 }} = \sum_{t = 1}^T{e_t^2}
\]</span>
An alternative to estimating the parameters by minimising the sum of squared errors is the maximum likelihood estimation. This method requires the probability distribution on the part of the response variable <span class="math inline">\(y\)</span>, which follows a normal distribution assuming normally distributed errors. This is also discussed in Section <a href="exponential-smoothing.html#estimation-and-model-selection">8.5</a>.</p>
</div>
<div id="example-algerian-exports" class="section level3">
<h3><span class="header-section-number">8.1.5</span> Example: Algerian exports</h3>
<p>In this example, simple exponential smoothing is applied to forecast exports of goods and services from Algeria.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="exponential-smoothing.html#cb146-1"></a><span class="co"># estimate parameters </span></span>
<span id="cb146-2"><a href="exponential-smoothing.html#cb146-2"></a><span class="co"># default estimation: opt_crit = &quot;lik&quot;</span></span>
<span id="cb146-3"><a href="exponential-smoothing.html#cb146-3"></a>algeria_fit &lt;-<span class="st"> </span>algeria_economy <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb146-4"><a href="exponential-smoothing.html#cb146-4"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Exports <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>), <span class="dt">opt_crit =</span> <span class="st">&quot;mse&quot;</span>))</span>
<span id="cb146-5"><a href="exponential-smoothing.html#cb146-5"></a></span>
<span id="cb146-6"><a href="exponential-smoothing.html#cb146-6"></a>algeria_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>()</span>
<span id="cb146-7"><a href="exponential-smoothing.html#cb146-7"></a><span class="co">#&gt; # A tibble: 2 x 4</span></span>
<span id="cb146-8"><a href="exponential-smoothing.html#cb146-8"></a><span class="co">#&gt;   Country .model                                                  term  estimate</span></span>
<span id="cb146-9"><a href="exponential-smoothing.html#cb146-9"></a><span class="co">#&gt;   &lt;fct&gt;   &lt;chr&gt;                                                   &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span id="cb146-10"><a href="exponential-smoothing.html#cb146-10"></a><span class="co">#&gt; 1 Algeria &quot;ETS(Exports ~ error(\&quot;A\&quot;) + trend(\&quot;N\&quot;) + season(\&quot;~ alpha    0.840</span></span>
<span id="cb146-11"><a href="exponential-smoothing.html#cb146-11"></a><span class="co">#&gt; 2 Algeria &quot;ETS(Exports ~ error(\&quot;A\&quot;) + trend(\&quot;N\&quot;) + season(\&quot;~ l       39.5</span></span></code></pre></div>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="exponential-smoothing.html#cb147-1"></a>algeria_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb147-2"><a href="exponential-smoothing.html#cb147-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb147-3"><a href="exponential-smoothing.html#cb147-3"></a><span class="st">  </span><span class="kw">autoplot</span>(algeria_economy, <span class="dt">level =</span> <span class="dv">95</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb147-4"><a href="exponential-smoothing.html#cb147-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">color =</span> <span class="st">&quot;Fitted&quot;</span>), <span class="dt">data =</span> <span class="kw">augment</span>(algeria_fit)) <span class="op">+</span></span>
<span id="cb147-5"><a href="exponential-smoothing.html#cb147-5"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="exponential-smoothing.html#cb148-1"></a>algeria_fit &lt;-<span class="st"> </span>algeria_economy <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb148-2"><a href="exponential-smoothing.html#cb148-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Exports <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>), <span class="dt">opt_crit =</span> <span class="st">&quot;mse&quot;</span>))</span>
<span id="cb148-3"><a href="exponential-smoothing.html#cb148-3"></a></span>
<span id="cb148-4"><a href="exponential-smoothing.html#cb148-4"></a>algeria_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb148-5"><a href="exponential-smoothing.html#cb148-5"></a><span class="co">#&gt; Series: Exports </span></span>
<span id="cb148-6"><a href="exponential-smoothing.html#cb148-6"></a><span class="co">#&gt; Model: ETS(A,N,N) </span></span>
<span id="cb148-7"><a href="exponential-smoothing.html#cb148-7"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb148-8"><a href="exponential-smoothing.html#cb148-8"></a><span class="co">#&gt;     alpha = 0.839812 </span></span>
<span id="cb148-9"><a href="exponential-smoothing.html#cb148-9"></a><span class="co">#&gt; </span></span>
<span id="cb148-10"><a href="exponential-smoothing.html#cb148-10"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb148-11"><a href="exponential-smoothing.html#cb148-11"></a><span class="co">#&gt;         l</span></span>
<span id="cb148-12"><a href="exponential-smoothing.html#cb148-12"></a><span class="co">#&gt;  39.54013</span></span>
<span id="cb148-13"><a href="exponential-smoothing.html#cb148-13"></a><span class="co">#&gt; </span></span>
<span id="cb148-14"><a href="exponential-smoothing.html#cb148-14"></a><span class="co">#&gt;   sigma^2:  35.6301</span></span>
<span id="cb148-15"><a href="exponential-smoothing.html#cb148-15"></a><span class="co">#&gt; </span></span>
<span id="cb148-16"><a href="exponential-smoothing.html#cb148-16"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb148-17"><a href="exponential-smoothing.html#cb148-17"></a><span class="co">#&gt; 446.7154 447.1599 452.8968</span></span></code></pre></div>
<p>This gives parameter estimates <span class="math inline">\(\alpha = 0.84\)</span> and <span class="math inline">\(\ell_0 = 39.5\)</span>, obtained by minimising SSE over periods <span class="math inline">\(t = 1, 2, \dots, 58\)</span>, subject to the restriction that <span class="math inline">\(0 \le \alpha \le 1\)</span>.</p>
<p>The large value of <span class="math inline">\(\alpha\)</span> in this example is reflected in the large adjustment that takes place in the estimated level <span class="math inline">\(\ell_t\)</span> at each time. A smaller value of α would lead to smaller changes over time, and so the series of fitted values would be smoother.</p>
<p><img src="images/algeria_economy.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="exponential-smoothing.html#cb149-1"></a>algeria_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb149-2"><a href="exponential-smoothing.html#cb149-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb149-3"><a href="exponential-smoothing.html#cb149-3"></a><span class="st">  </span><span class="kw">autoplot</span>(algeria_economy, <span class="dt">level =</span> <span class="dv">95</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb149-4"><a href="exponential-smoothing.html#cb149-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">color =</span> <span class="st">&quot;Fitted&quot;</span>), <span class="dt">data =</span> <span class="kw">augment</span>(algeria_fit)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb149-5"><a href="exponential-smoothing.html#cb149-5"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="methods-with-trend-and-seasonality" class="section level2">
<h2><span class="header-section-number">8.2</span> Methods with trend and seasonality</h2>
<div id="holts-linear-trend-method" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Holt’s linear trend method</h3>
<p>Holt <span class="citation">(<a href="references.html#ref-holt1957forecasting" role="doc-biblioref">1957</a>)</span> extended simple exponential smoothing to allow the forecasting of data with a trend. This method involves a forecast equation and two smoothing equations (one for the level and one for the trend):</p>
<p><span class="math display">\[
\begin{aligned}
\text{Forecast equation}  \;\;\; \hat{y}_{t+h|t} &amp;= \ell_t + hb_t \\
\text{Level equation}  \;\;\;\;\;\;\;\; \ell_t &amp;= \alpha y_t + (1 - \alpha) (\ell_{t-1} + b_{t-1}) \\
\text{Trend equation} \;\;\;\;\;\;\;  b_t &amp;= \beta^*(\ell_t - \ell_{t - 1}) + (1 - \beta^*)b_{t-1}
\end{aligned}
\]</span></p>
<p><span class="math inline">\(b_t\)</span> denotes the estimated <strong>slope</strong> of the series at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(\beta^*\)</span> is a smoothing parameter for the trend <span class="math inline">\(0\le \beta^* \le 1\)</span>. For <span class="math inline">\(b_t\)</span> is an essentially weighted average of slope at <span class="math inline">\(t=1, t = 2, \cdots, t = t - 1\)</span>. The following equation shows thta <span class="math inline">\(\beta_0^*(\ell_t - \ell_{t - 1})\)</span> is weight <span class="math inline">\(\beta_0^*\)</span> attatched to the estimated slope at time <span class="math inline">\(t\)</span></p>
<p><span class="math display">\[
\begin{split}
\ell_t - \ell_{t - 1} &amp;= [(\hat{y}_{t+1|t} - b_t) - (\hat{y}_{t|t-1} - b_{t-1})] \\
                      &amp;= \hat{y}_{t+1|t} - \hat{y}_{t|t-1} - (b_t - b_{t-1}) \\ 
                      &amp;= \frac{(\hat{y}_{t+1|t} - \hat{y}_{t|t-1})}{1} + \frac{(b_t - b_{t-1})}{1}
\end{split}
\]</span></p>
<p>In Holt’s linear trend, the level equation here shows that <span class="math inline">\(\ell_t\)</span> is a weighted average of observation <span class="math inline">\(y_t\)</span> and the one-step-ahead training forecast for time <span class="math inline">\(t\)</span>, here given by the level <span class="math inline">\(\ell_t\)</span> at time plus a rise after one observation unit <span class="math inline">\(b_t \times 1\)</span>. The trend equation shows that <span class="math inline">\(b_t\)</span> is a weighted average of the estimated trend at time <span class="math inline">\(t\)</span> based on <span class="math inline">\(\ell_t - \ell_{t-1}\)</span> and <span class="math inline">\(b_{t−1}\)</span>, the previous estimate of the trend.</p>
<p>With the introduction of the trend component, now there are 4 parameters that have to be estimated. Two smoothing parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta^*\)</span> and two initials <span class="math inline">\(\ell_0\)</span>, <span class="math inline">\(b_0\)</span></p>
<p>The forecast function is no longer flat but trending. The <span class="math inline">\(h\)</span>
-step-ahead forecast is equal to the last estimated level plus <span class="math inline">\(h\)</span> times the last estimated trend value. Hence the forecasts are a linear function of <span class="math inline">\(h\)</span>.</p>
</div>
<div id="example-australian-population" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Example: Australian population</h3>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="exponential-smoothing.html#cb150-1"></a>aus_economy &lt;-<span class="st"> </span>global_economy <span class="op">%&gt;%</span></span>
<span id="cb150-2"><a href="exponential-smoothing.html#cb150-2"></a><span class="st">  </span><span class="kw">filter</span>(Code <span class="op">==</span><span class="st"> &quot;AUS&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb150-3"><a href="exponential-smoothing.html#cb150-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Pop =</span> Population <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>)</span>
<span id="cb150-4"><a href="exponential-smoothing.html#cb150-4"></a></span>
<span id="cb150-5"><a href="exponential-smoothing.html#cb150-5"></a>pop_fit &lt;-<span class="st"> </span>aus_economy <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb150-6"><a href="exponential-smoothing.html#cb150-6"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>), <span class="dt">opt_crit =</span> <span class="st">&quot;mse&quot;</span>))</span>
<span id="cb150-7"><a href="exponential-smoothing.html#cb150-7"></a></span>
<span id="cb150-8"><a href="exponential-smoothing.html#cb150-8"></a>pop_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb150-9"><a href="exponential-smoothing.html#cb150-9"></a><span class="co">#&gt; Series: Pop </span></span>
<span id="cb150-10"><a href="exponential-smoothing.html#cb150-10"></a><span class="co">#&gt; Model: ETS(A,A,N) </span></span>
<span id="cb150-11"><a href="exponential-smoothing.html#cb150-11"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb150-12"><a href="exponential-smoothing.html#cb150-12"></a><span class="co">#&gt;     alpha = 0.9998998 </span></span>
<span id="cb150-13"><a href="exponential-smoothing.html#cb150-13"></a><span class="co">#&gt;     beta  = 0.3267372 </span></span>
<span id="cb150-14"><a href="exponential-smoothing.html#cb150-14"></a><span class="co">#&gt; </span></span>
<span id="cb150-15"><a href="exponential-smoothing.html#cb150-15"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb150-16"><a href="exponential-smoothing.html#cb150-16"></a><span class="co">#&gt;         l         b</span></span>
<span id="cb150-17"><a href="exponential-smoothing.html#cb150-17"></a><span class="co">#&gt;  10.05413 0.2225002</span></span>
<span id="cb150-18"><a href="exponential-smoothing.html#cb150-18"></a><span class="co">#&gt; </span></span>
<span id="cb150-19"><a href="exponential-smoothing.html#cb150-19"></a><span class="co">#&gt;   sigma^2:  0.0041</span></span>
<span id="cb150-20"><a href="exponential-smoothing.html#cb150-20"></a><span class="co">#&gt; </span></span>
<span id="cb150-21"><a href="exponential-smoothing.html#cb150-21"></a><span class="co">#&gt;       AIC      AICc       BIC </span></span>
<span id="cb150-22"><a href="exponential-smoothing.html#cb150-22"></a><span class="co">#&gt; -76.98568 -75.83184 -66.68347</span></span></code></pre></div>
<p>The estimated smoothing coefficient for the level is <span class="math inline">\(\alpha = 1\)</span>. The very high value shows that the level changes rapidly in order to capture the highly trended series. The estimated smoothing coefficient for the slope is <span class="math inline">\(\beta^*= \alpha \beta= 1 \times0.33 = 0.33\)</span> (See ETS(A, A, N) in Section <a href="exponential-smoothing.html#innovations-state-space-models-for-exponential-smoothing">8.4</a>).</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="exponential-smoothing.html#cb151-1"></a>pop_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb151-2"><a href="exponential-smoothing.html#cb151-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb151-3"><a href="exponential-smoothing.html#cb151-3"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_economy) <span class="op">+</span><span class="st"> </span></span>
<span id="cb151-4"><a href="exponential-smoothing.html#cb151-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> .fitted, <span class="dt">color =</span> <span class="st">&quot;.fitted&quot;</span>), <span class="dt">data =</span> <span class="kw">augment</span>(pop_fit)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb151-5"><a href="exponential-smoothing.html#cb151-5"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="damped-trend-methods" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Damped trend methods</h3>
<p>The forecasts generated by Holt’s linear method display a constant trend (increasing or decreasing) indefinitely into the future. Empirical evidence indicates that these methods tend to over-forecast, especially for longer forecast horizons. Motivated by this observation, Gardner &amp; McKenzie {-gardner1985forecasting} introduced a parameter that “dampens” the trend to a flat line some time in the future. Methods that include a damped trend have proven to be very successful, and are arguably the most popular individual methods when forecasts are required automatically for many series.</p>
<p>In conjunction with the smoothing parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta^*\)</span> (with values between 0 and 1 as in Holt’s method), this method also includes a damping parameter <span class="math inline">\(0 \lt \phi &lt; 1\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Forecast equation}  \;\;\; \hat{y}_{t+h|t} &amp;= \ell_t + (\phi + \phi^2 + \cdots + \phi^h)b_t \\
\text{Level equation}  \;\;\;\;\;\;\;\; \ell_t &amp;= \alpha y_t + (1 - \alpha) (\ell_{t-1} + \phi b_{t-1})\\
\text{Trend equation} \;\;\;\;\;\;\;  b_t &amp;= \beta^*(\ell_t - \ell_{t - 1}) + (1 - \beta^*)b_{t-1}
\end{aligned}
\]</span></p>
<p>if <span class="math inline">\(\phi = 1\)</span>, the method is identical to Holt’s linear method. For values between 0 and 1, <span class="math inline">\(\phi\)</span> dampens the trend so that it approaches a constant some time in the future. To be precise, short-run forecasts are trended while long-run forecasts are constant.</p>
</div>
<div id="example-australian-population-continued" class="section level3">
<h3><span class="header-section-number">8.2.4</span> Example: Australian Population (continued)</h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="exponential-smoothing.html#cb152-1"></a>aus_economy <span class="op">%&gt;%</span></span>
<span id="cb152-2"><a href="exponential-smoothing.html#cb152-2"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb152-3"><a href="exponential-smoothing.html#cb152-3"></a>    <span class="st">`</span><span class="dt">Holt&#39;s method</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb152-4"><a href="exponential-smoothing.html#cb152-4"></a>    <span class="st">`</span><span class="dt">Damped Holt&#39;s method</span><span class="st">`</span> =<span class="st"> </span><span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>, <span class="dt">phi =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>))</span>
<span id="cb152-5"><a href="exponential-smoothing.html#cb152-5"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb152-6"><a href="exponential-smoothing.html#cb152-6"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">15</span>) <span class="op">%&gt;%</span></span>
<span id="cb152-7"><a href="exponential-smoothing.html#cb152-7"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_economy, <span class="dt">level =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb152-8"><a href="exponential-smoothing.html#cb152-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Forecasts from Holt&#39;s method&quot;</span>,</span>
<span id="cb152-9"><a href="exponential-smoothing.html#cb152-9"></a>       <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Population of Australia (millions)&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb152-10"><a href="exponential-smoothing.html#cb152-10"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">&quot;Forecast&quot;</span>))</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We have set the damping parameter to a relatively low number (<span class="math inline">\(\phi = 0.90\)</span>) to exaggerate the effect of damping for comparison. Usually, we would estimate <span class="math inline">\(\phi\)</span> (simply <code>trend("Ad")</code>) along with the other parameters. We have also used a rather large forecast horizon (<span class="math inline">\(h = 15\)</span>) to highlight the difference between a damped trend and a linear trend.</p>
</div>
<div id="example-internet-usage" class="section level3">
<h3><span class="header-section-number">8.2.5</span> Example: Internet usage</h3>
<p>In this example, we compare the forecasting performance of the three exponential smoothing methods that we have considered so far in forecasting the number of users connected to the internet via a server.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="exponential-smoothing.html#cb153-1"></a>www_usage &lt;-<span class="st"> </span><span class="kw">as_tsibble</span>(WWWusage)</span>
<span id="cb153-2"><a href="exponential-smoothing.html#cb153-2"></a>www_usage <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(value) <span class="op">+</span></span>
<span id="cb153-3"><a href="exponential-smoothing.html#cb153-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Minute&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of users&quot;</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>We will use time series cross-validation to compare the one-step forecast accuracy of the three methods.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="exponential-smoothing.html#cb154-1"></a>www_usage <span class="op">%&gt;%</span></span>
<span id="cb154-2"><a href="exponential-smoothing.html#cb154-2"></a><span class="st">  </span><span class="kw">stretch_tsibble</span>(<span class="dt">.init =</span> <span class="dv">10</span>, <span class="dt">.step =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb154-3"><a href="exponential-smoothing.html#cb154-3"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb154-4"><a href="exponential-smoothing.html#cb154-4"></a>    <span class="dt">SES =</span> <span class="kw">ETS</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb154-5"><a href="exponential-smoothing.html#cb154-5"></a>    <span class="dt">Holt =</span> <span class="kw">ETS</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)),</span>
<span id="cb154-6"><a href="exponential-smoothing.html#cb154-6"></a>    <span class="dt">Damped =</span> <span class="kw">ETS</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>))</span>
<span id="cb154-7"><a href="exponential-smoothing.html#cb154-7"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb154-8"><a href="exponential-smoothing.html#cb154-8"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb154-9"><a href="exponential-smoothing.html#cb154-9"></a><span class="st">  </span><span class="kw">accuracy</span>(www_usage)</span>
<span id="cb154-10"><a href="exponential-smoothing.html#cb154-10"></a><span class="co">#&gt; # A tibble: 3 x 9</span></span>
<span id="cb154-11"><a href="exponential-smoothing.html#cb154-11"></a><span class="co">#&gt;   .model .type     ME  RMSE   MAE   MPE  MAPE  MASE  ACF1</span></span>
<span id="cb154-12"><a href="exponential-smoothing.html#cb154-12"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb154-13"><a href="exponential-smoothing.html#cb154-13"></a><span class="co">#&gt; 1 Damped Test  0.288   3.69  3.00 0.347  2.26 0.663 0.336</span></span>
<span id="cb154-14"><a href="exponential-smoothing.html#cb154-14"></a><span class="co">#&gt; 2 Holt   Test  0.0610  3.87  3.17 0.244  2.38 0.701 0.296</span></span>
<span id="cb154-15"><a href="exponential-smoothing.html#cb154-15"></a><span class="co">#&gt; 3 SES    Test  1.46    6.05  4.81 0.904  3.55 1.06  0.803</span></span></code></pre></div>
<p>Damped Holt’s method is best whether you compare MAE or RMSE values. So we will proceed with using the damped Holt’s method and apply it to the whole data set to get forecasts for future years.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="exponential-smoothing.html#cb155-1"></a>usage_fit &lt;-<span class="st"> </span>www_usage <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb155-2"><a href="exponential-smoothing.html#cb155-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(value <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)))</span>
<span id="cb155-3"><a href="exponential-smoothing.html#cb155-3"></a></span>
<span id="cb155-4"><a href="exponential-smoothing.html#cb155-4"></a>usage_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>()</span>
<span id="cb155-5"><a href="exponential-smoothing.html#cb155-5"></a><span class="co">#&gt; # A tibble: 5 x 3</span></span>
<span id="cb155-6"><a href="exponential-smoothing.html#cb155-6"></a><span class="co">#&gt;   .model                                                      term  estimate</span></span>
<span id="cb155-7"><a href="exponential-smoothing.html#cb155-7"></a><span class="co">#&gt;   &lt;chr&gt;                                                       &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span id="cb155-8"><a href="exponential-smoothing.html#cb155-8"></a><span class="co">#&gt; 1 &quot;ETS(value ~ error(\&quot;A\&quot;) + trend(\&quot;Ad\&quot;) + season(\&quot;N\&quot;))&quot; alpha   1.00  </span></span>
<span id="cb155-9"><a href="exponential-smoothing.html#cb155-9"></a><span class="co">#&gt; 2 &quot;ETS(value ~ error(\&quot;A\&quot;) + trend(\&quot;Ad\&quot;) + season(\&quot;N\&quot;))&quot; beta    0.997 </span></span>
<span id="cb155-10"><a href="exponential-smoothing.html#cb155-10"></a><span class="co">#&gt; 3 &quot;ETS(value ~ error(\&quot;A\&quot;) + trend(\&quot;Ad\&quot;) + season(\&quot;N\&quot;))&quot; phi     0.815 </span></span>
<span id="cb155-11"><a href="exponential-smoothing.html#cb155-11"></a><span class="co">#&gt; 4 &quot;ETS(value ~ error(\&quot;A\&quot;) + trend(\&quot;Ad\&quot;) + season(\&quot;N\&quot;))&quot; l      90.4   </span></span>
<span id="cb155-12"><a href="exponential-smoothing.html#cb155-12"></a><span class="co">#&gt; 5 &quot;ETS(value ~ error(\&quot;A\&quot;) + trend(\&quot;Ad\&quot;) + season(\&quot;N\&quot;))&quot; b      -0.0173</span></span>
<span id="cb155-13"><a href="exponential-smoothing.html#cb155-13"></a>usage_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb155-14"><a href="exponential-smoothing.html#cb155-14"></a><span class="co">#&gt; Series: value </span></span>
<span id="cb155-15"><a href="exponential-smoothing.html#cb155-15"></a><span class="co">#&gt; Model: ETS(A,Ad,N) </span></span>
<span id="cb155-16"><a href="exponential-smoothing.html#cb155-16"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb155-17"><a href="exponential-smoothing.html#cb155-17"></a><span class="co">#&gt;     alpha = 0.9999 </span></span>
<span id="cb155-18"><a href="exponential-smoothing.html#cb155-18"></a><span class="co">#&gt;     beta  = 0.9966439 </span></span>
<span id="cb155-19"><a href="exponential-smoothing.html#cb155-19"></a><span class="co">#&gt;     phi   = 0.814958 </span></span>
<span id="cb155-20"><a href="exponential-smoothing.html#cb155-20"></a><span class="co">#&gt; </span></span>
<span id="cb155-21"><a href="exponential-smoothing.html#cb155-21"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb155-22"><a href="exponential-smoothing.html#cb155-22"></a><span class="co">#&gt;         l           b</span></span>
<span id="cb155-23"><a href="exponential-smoothing.html#cb155-23"></a><span class="co">#&gt;  90.35177 -0.01728234</span></span>
<span id="cb155-24"><a href="exponential-smoothing.html#cb155-24"></a><span class="co">#&gt; </span></span>
<span id="cb155-25"><a href="exponential-smoothing.html#cb155-25"></a><span class="co">#&gt;   sigma^2:  12.2244</span></span>
<span id="cb155-26"><a href="exponential-smoothing.html#cb155-26"></a><span class="co">#&gt; </span></span>
<span id="cb155-27"><a href="exponential-smoothing.html#cb155-27"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb155-28"><a href="exponential-smoothing.html#cb155-28"></a><span class="co">#&gt; 717.7310 718.6342 733.3620</span></span></code></pre></div>
<p>The smoothing parameter for the slope is estimated to be almost one, indicating that the trend changes to mostly reflect the slope between the last two minutes of internet usage. The decline in the last few years is captured by large <span class="math inline">\(\beta^*\)</span>, so that <span class="math inline">\(b_{T+1}, b_{T+2}, \dots, b_{T+10}\)</span> is all negative. <span class="math inline">\(\alpha\)</span> is very close to one, showing that the level reacts strongly to each new observation.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="exponential-smoothing.html#cb156-1"></a>usage_fit <span class="op">%&gt;%</span></span>
<span id="cb156-2"><a href="exponential-smoothing.html#cb156-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></span>
<span id="cb156-3"><a href="exponential-smoothing.html#cb156-3"></a><span class="st">  </span><span class="kw">autoplot</span>(www_usage)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="holt-winters-additive-method" class="section level3">
<h3><span class="header-section-number">8.2.6</span> Holt-Winters’ additive method</h3>
<p>Holt <span class="citation">(<a href="references.html#ref-holt1957forecasting" role="doc-biblioref">1957</a>)</span>and Winters <span class="citation">(<a href="references.html#ref-winters1960forecasting" role="doc-biblioref">1960</a>)</span> extended Holt’s method to capture seasonality. The Holt-Winters seasonal method comprises the forecast equation and three smoothing equations — one for the level <span class="math inline">\(\ell_t\)</span>, one for the trend <span class="math inline">\(b_t\)</span>, and one for the seasonal component <span class="math inline">\(s_t\)</span>, with corresponding smoothing parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta^*\)</span> and <span class="math inline">\(\gamma\)</span>. We use <span class="math inline">\(m\)</span> to denote the frequency of the seasonality, i.e., the number of seasons in a year. For example, for quarterly data <span class="math inline">\(m = 4\)</span>, and for monthly data <span class="math inline">\(m = 12\)</span>.</p>
<p>There are two variations to this method that differ in the nature of the seasonal component. The additive method is preferred when the seasonal variations are roughly constant through the series, while the multiplicative method is preferred when the seasonal variations are changing proportional to the level of the series.</p>
<p><span class="math display">\[
\begin{aligned}
\hat{y}_{t + h | t} &amp;= \ell_t + hb_t + s_{t + h -m(k + 1)} \\
\ell_t &amp;= \alpha(y_t - s_{t - m}) + (1 - \alpha)(\ell_{t - 1} + b_{t - 1}) \\ 
b_t &amp;= \beta^*(\ell_t - \ell_{t - 1}) + (1 - \beta^*)b_{t-1} \\
s_t &amp;= \gamma(y_t - \ell_{t-1} - b_{t - 1}) + (1 - \gamma)s_{t-m} \\
\end{aligned}
\]</span>
where <span class="math inline">\(k\)</span> is the integer part of <span class="math inline">\((h − 1) / m\)</span>, which ensures that the estimates of the seasonal indices used for forecasting come from the final year of the sample. The level equation shows a weighted average between the seasonally adjusted observation (<span class="math inline">\(y_t−s_{t−m}\)</span>) and the non-seasonal forecast (<span class="math inline">\(\ell_{t−1}+b_{t−1}\)</span>) for time t. The trend equation is identical to Holt’s linear method.</p>
<p>The seasonal equation shows a weighted average between the current seasonal index, (<span class="math inline">\(y_t - \ell_{t-1} - b_{t - 1}\)</span>), and the seasonal index of the same season last year (i.e., <span class="math inline">\(m\)</span> time periods ago). This means we have <span class="math inline">\(m\)</span> more inital values to estimate <span class="math inline">\(s_1, s_2, \dots, s_m\)</span> in terms of the seasonal component.</p>
<p>The equation for the seasonal component can be also expressed as</p>
<p><span class="math display">\[
s_t = \gamma^*(y_t - \ell_t) + (1 - \gamma^*)s_{t-m}
\]</span></p>
<p>This is the case when we substitute the level equation for <span class="math inline">\(\ell_t\)</span>:</p>
<p><span class="math display">\[
\begin{split}
s_t &amp;= \gamma^*(y_t - \ell_t) + (1 - \gamma^*)s_{t-m} \\
    &amp;= \gamma^*[y_t - \alpha(y_t - s_{t - m}) - (1 - \alpha)(\ell_{t - 1} + b_{t - 1})] + (1 - \gamma^*)s_{t-m} \\
    &amp;= \gamma^*y_t - \gamma^*y_t\alpha + \gamma^* \alpha s_{t - m} - \gamma^*(1 - \alpha)(\ell_{t - 1} + b_{t - 1}) + (1 - \gamma^*)s_{t-m} \\
    &amp;=  \gamma^*(1 - \alpha)y_t - \gamma^*(1 - \alpha)(\ell_{t - 1} + b_{t - 1}) + \gamma^* \alpha s_{t - m} + [1 + y^*(\alpha - 1)]s_{t-m} \\
    &amp;=  \gamma^*(1 - \alpha)(y_t - \ell_{t-1} - b_{t-1}) + [1 - y^*(1 - \alpha)]s_{t-m}
\end{split}
\]</span></p>
<p>which is identical to the smoothing equation for the seasonal component we specify here, with <span class="math inline">\(\gamma = \gamma^*(1 - \alpha)\)</span>. The usual parameter restriction is <span class="math inline">\(0 \le \gamma^* \le 1\)</span>, which translates to <span class="math inline">\(0 \le \gamma \le 1− \alpha\)</span>.</p>
</div>
<div id="holt-winters-multiplicative-method" class="section level3">
<h3><span class="header-section-number">8.2.7</span> Holt-Winters’ multiplicative method</h3>
<p>The component form for the multiplicative method is:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{y}_{t + h | t} &amp;= (\ell_t + hb_t)s_{t + h -m(k + 1)} \\
\ell_t &amp;= \alpha(y_t / s_{t - m}) + (1 - \alpha)(\ell_{t - 1} + b_{t - 1}) \\ 
b_t &amp;= \beta^*(\ell_t - \ell_{t - 1}) + (1 - \beta^*)b_{t-1} \\
s_t &amp;= \gamma[y_t / (\ell_{t-1} + b_{t - 1})] + (1 - \gamma)s_{t-m} \\
\end{aligned}
\]</span></p>
</div>
<div id="example-domestic-overnight-trips-in-australia" class="section level3">
<h3><span class="header-section-number">8.2.8</span> Example: Domestic overnight trips in Australia</h3>
<p>Here we use cross validation to compare the forecast of additive seasonality with that of multiplicative seasonality.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="exponential-smoothing.html#cb157-1"></a>aus_holidays &lt;-<span class="st"> </span>tourism <span class="op">%&gt;%</span></span>
<span id="cb157-2"><a href="exponential-smoothing.html#cb157-2"></a><span class="st">  </span><span class="kw">filter</span>(Purpose <span class="op">==</span><span class="st"> &quot;Holiday&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb157-3"><a href="exponential-smoothing.html#cb157-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Trips =</span> <span class="kw">sum</span>(Trips))</span>
<span id="cb157-4"><a href="exponential-smoothing.html#cb157-4"></a></span>
<span id="cb157-5"><a href="exponential-smoothing.html#cb157-5"></a>holidays_fit &lt;-<span class="st"> </span>aus_holidays <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb157-6"><a href="exponential-smoothing.html#cb157-6"></a><span class="st">  </span><span class="kw">model</span>(</span>
<span id="cb157-7"><a href="exponential-smoothing.html#cb157-7"></a>    <span class="dt">additive =</span> <span class="kw">ETS</span>(Trips <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>)),</span>
<span id="cb157-8"><a href="exponential-smoothing.html#cb157-8"></a>    <span class="dt">multiplicative =</span> <span class="kw">ETS</span>(Trips <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;M&quot;</span>))</span>
<span id="cb157-9"><a href="exponential-smoothing.html#cb157-9"></a>  ) </span>
<span id="cb157-10"><a href="exponential-smoothing.html#cb157-10"></a></span>
<span id="cb157-11"><a href="exponential-smoothing.html#cb157-11"></a>holidays_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glance</span>()</span>
<span id="cb157-12"><a href="exponential-smoothing.html#cb157-12"></a><span class="co">#&gt; # A tibble: 2 x 9</span></span>
<span id="cb157-13"><a href="exponential-smoothing.html#cb157-13"></a><span class="co">#&gt;   .model          sigma2 log_lik   AIC  AICc   BIC     MSE    AMSE   MAE</span></span>
<span id="cb157-14"><a href="exponential-smoothing.html#cb157-14"></a><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb157-15"><a href="exponential-smoothing.html#cb157-15"></a><span class="co">#&gt; 1 additive       189416.   -657. 1332. 1335. 1354. 170475. 180856.  315.</span></span>
<span id="cb157-16"><a href="exponential-smoothing.html#cb157-16"></a><span class="co">#&gt; 2 multiplicative 187599.   -657. 1331. 1334. 1353. 168839. 179731.  307.</span></span>
<span id="cb157-17"><a href="exponential-smoothing.html#cb157-17"></a>  </span>
<span id="cb157-18"><a href="exponential-smoothing.html#cb157-18"></a>holidays_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb157-19"><a href="exponential-smoothing.html#cb157-19"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;3 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb157-20"><a href="exponential-smoothing.html#cb157-20"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_holidays, <span class="dt">level =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Because both methods have exactly the same number of parameters to estimate, we can compare the training RMSE from both models. In this case, the method with multiplicative seasonality fits the data best. This was to be expected, as the time plot shows that the <strong>seasonal variation in the data increases as the level of the series increases</strong>. This is also reflected in the two sets of forecasts; the forecasts generated by the method with the multiplicative seasonality display larger and increasing seasonal variation as the level of the forecasts increases compared to the forecasts generated by the method with additive seasonality.</p>
</div>
<div id="holt-winters-damped-method" class="section level3">
<h3><span class="header-section-number">8.2.9</span> Holt-Winters’ damped method</h3>
<p>Damping is possible with both additive and multiplicative Holt-Winters’ methods. A method that often provides accurate and robust forecasts for seasonal data is the Holt-Winters method with a damped trend and multiplicative seasonality:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{y}_{t + h | t} &amp;= [\ell_t + (\phi + \phi^2  + \dots + \phi^h)b_t]s_{t + h -m(k + 1)} \\
\ell_t &amp;= \alpha(y_t / s_{t - m}) + (1 - \alpha)(\ell_{t - 1} + \phi b_{t - 1}) \\ 
b_t &amp;= \beta^*(\ell_t - \ell_{t - 1}) + (1 - \beta^*)\phi b_{t-1} \\
s_t &amp;= \gamma[y_t / (\ell_{t-1} + \phi b_{t - 1})] + (1 - \gamma)s_{t-m} \\
\end{aligned}
\]</span></p>
</div>
<div id="example-holt-winters-method-with-daily-data" class="section level3">
<h3><span class="header-section-number">8.2.10</span> Example: Holt-Winters method with daily data</h3>
<p>The Holt-Winters method can also be used for daily type of data, where the seasonal period is <span class="math inline">\(m = 7\)</span>. Here we forecast pedestrian traffic at a busy Melbourne train station in July 2016.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="exponential-smoothing.html#cb158-1"></a>pedestrian_per_day &lt;-<span class="st"> </span>pedestrian <span class="op">%&gt;%</span></span>
<span id="cb158-2"><a href="exponential-smoothing.html#cb158-2"></a><span class="st">  </span><span class="kw">filter</span>(Sensor <span class="op">==</span><span class="st"> &quot;Southern Cross Station&quot;</span>, <span class="kw">yearmonth</span>(Date) <span class="op">==</span><span class="st"> </span><span class="kw">yearmonth</span>(<span class="st">&quot;2016 July&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb158-3"><a href="exponential-smoothing.html#cb158-3"></a><span class="st">  </span><span class="kw">index_by</span>(Date) <span class="op">%&gt;%</span></span>
<span id="cb158-4"><a href="exponential-smoothing.html#cb158-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Count =</span> <span class="kw">sum</span>(Count))</span>
<span id="cb158-5"><a href="exponential-smoothing.html#cb158-5"></a></span>
<span id="cb158-6"><a href="exponential-smoothing.html#cb158-6"></a>pedestrian_fit &lt;-<span class="st"> </span>pedestrian_per_day <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb158-7"><a href="exponential-smoothing.html#cb158-7"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Count <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;M&quot;</span>)))</span>
<span id="cb158-8"><a href="exponential-smoothing.html#cb158-8"></a></span>
<span id="cb158-9"><a href="exponential-smoothing.html#cb158-9"></a>pedestrian_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb158-10"><a href="exponential-smoothing.html#cb158-10"></a><span class="co">#&gt; Series: Count </span></span>
<span id="cb158-11"><a href="exponential-smoothing.html#cb158-11"></a><span class="co">#&gt; Model: ETS(A,Ad,M) </span></span>
<span id="cb158-12"><a href="exponential-smoothing.html#cb158-12"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb158-13"><a href="exponential-smoothing.html#cb158-13"></a><span class="co">#&gt;     alpha = 0.1901066 </span></span>
<span id="cb158-14"><a href="exponential-smoothing.html#cb158-14"></a><span class="co">#&gt;     beta  = 0.002178528 </span></span>
<span id="cb158-15"><a href="exponential-smoothing.html#cb158-15"></a><span class="co">#&gt;     gamma = 0.0009006456 </span></span>
<span id="cb158-16"><a href="exponential-smoothing.html#cb158-16"></a><span class="co">#&gt;     phi   = 0.9729213 </span></span>
<span id="cb158-17"><a href="exponential-smoothing.html#cb158-17"></a><span class="co">#&gt; </span></span>
<span id="cb158-18"><a href="exponential-smoothing.html#cb158-18"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb158-19"><a href="exponential-smoothing.html#cb158-19"></a><span class="co">#&gt;        l        b      s1       s2       s3       s4       s5        s6</span></span>
<span id="cb158-20"><a href="exponential-smoothing.html#cb158-20"></a><span class="co">#&gt;  12372.2 94.66631 1.34518 1.322323 1.320987 1.314923 0.144459 0.2077794</span></span>
<span id="cb158-21"><a href="exponential-smoothing.html#cb158-21"></a><span class="co">#&gt;        s7</span></span>
<span id="cb158-22"><a href="exponential-smoothing.html#cb158-22"></a><span class="co">#&gt;  1.344349</span></span>
<span id="cb158-23"><a href="exponential-smoothing.html#cb158-23"></a><span class="co">#&gt; </span></span>
<span id="cb158-24"><a href="exponential-smoothing.html#cb158-24"></a><span class="co">#&gt;   sigma^2:  184620</span></span>
<span id="cb158-25"><a href="exponential-smoothing.html#cb158-25"></a><span class="co">#&gt; </span></span>
<span id="cb158-26"><a href="exponential-smoothing.html#cb158-26"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb158-27"><a href="exponential-smoothing.html#cb158-27"></a><span class="co">#&gt; 493.1853 514.5971 511.8271</span></span></code></pre></div>
<p>Here we estimate 9 inital values, 1 for level, 1 for slope, and 7 for seasonal index.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="exponential-smoothing.html#cb159-1"></a>pedestrian_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb159-2"><a href="exponential-smoothing.html#cb159-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;2 weeks&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb159-3"><a href="exponential-smoothing.html#cb159-3"></a><span class="st">  </span><span class="kw">autoplot</span>(pedestrian_per_day)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="a-taxonomy-of-exponential-smoothing-methods" class="section level2">
<h2><span class="header-section-number">8.3</span> A taxonomy of exponential smoothing methods</h2>
<p>By considering variations in the combinations of the trend(<span class="math inline">\(N\)</span>, <span class="math inline">\(A\)</span> and <span class="math inline">\(A_d\)</span>) and seasonal components(<span class="math inline">\(N\)</span>, <span class="math inline">\(A\)</span>, and <span class="math inline">\(M\)</span>), nine exponential smoothing methods are possible, listed in below</p>
<p><img src="images/ets_methods.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Multiplicative trend methods are not included as they tend to produce poor forecasts. See <span class="citation">R. Hyndman et al. (<a href="references.html#ref-hyndman2008forecasting" role="doc-biblioref">2008</a>)</span> for a more thorough discussion of all exponential smoothing methods.</p>
<p>The following table gives the recursive formulas for applying the nine exponential smoothing methods. Each cell includes the forecast equation for generating h-step-ahead forecasts, and the smoothing equations for applying the method.</p>
<p><img src="images/ets_formula.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="innovations-state-space-models-for-exponential-smoothing" class="section level2">
<h2><span class="header-section-number">8.4</span> Innovations state space models for exponential smoothing</h2>
<p>Now we study the statistical models that underlie the exponential smoothing methods we have considered so far. All the exponential smoothing methods presented so far are <strong>algorithms</strong> which generate point forecasts, instead of a <strong>statistical model</strong>.</p>
<p>The statistical models in this section generate the same point forecasts, but can also generate prediction (or forecast) intervals. A statistical model is a stochastic (or random) data generating process that can produce an entire forecast distribution.</p>
<p>Each model consists of a measurement equation that describes the observed data, and some state equations that describe how the unobserved components or states (level, trend, seasonal) change over time. Hence, these are referred to as <strong>state space models</strong>.</p>
<p>For each method there exist two models: one with additive errors and one with multiplicative errors. <strong>The point forecasts produced by the models are identical if they use the same smoothing parameter values. They will, however, generate different prediction intervals.</strong></p>
<p>Notations :<br />
<img src="images/ets_models.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="etsann-simple-exponential-smoothing-with-additive-errors" class="section level3">
<h3><span class="header-section-number">8.4.1</span> ETS(A,N,N): simple exponential smoothing with additive errors</h3>
<p>Recall the simple exponential smoothing Equation (component form, 1-step forecast) :</p>
<p><span class="math display">\[
\begin{aligned}
\text{Forecast equation}  \;\;\;\; \hat{y}_{t+1|t} &amp;= \ell_t \\
\text{Smoothing equation}  \;\;\;\;\;\;\;\; \ell_t &amp;= \alpha y_t + (1 - \alpha) \ell_{t-1} 
\end{aligned}
\]</span></p>
<p>Let <span class="math inline">\(e_t = y_{t} -\hat{y}_{t|t-1} = y_{t} - \ell_{t-1}\)</span>, some then substitute <span class="math inline">\(e_t + \ell_{t - 1}\)</span> for <span class="math inline">\(y_{t}\)</span>. We get</p>
<p><span class="math display" id="eq:measurement">\[\begin{equation}
y_t = \ell_{t - 1} + e_t  \tag{8.2}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:state">\[\begin{equation}
\ell_t = \ell_{t-1} + \alpha e_t \tag{8.3}
\end{equation}\]</span></p>
<p>We refer to Equation <a href="exponential-smoothing.html#eq:measurement">(8.2)</a> as the <strong>measurement</strong> (or observation) equation and Equation <a href="exponential-smoothing.html#eq:state">(8.3)</a> as the <strong>stat</strong>e (or transition) equation. These two equations, together with the statistical distribution of the errors, form a fully specified statistical model. Specifically, these constitute an innovations state space model underlying simple exponential smoothing.</p>
<p>The term “<strong>innovations</strong>” comes from the fact that all equations use the same random error process, <span class="math inline">\(\varepsilon_t\)</span>. For the same reason, this formulation is also referred to as a “single source of error” model. There are alternative multiple source of error formulations that is not presented here.</p>
<p>The state equation shows the evolution of the state through time. The influence of the smoothing parameter <span class="math inline">\(\alpha\)</span> is the same as for the methods discussed earlier. For example, <span class="math inline">\(\alpha\)</span> governs the amount of change in successive levels: high values of α allow rapid changes in the level; low values of α lead to smooth changes. If <span class="math inline">\(\alpha = 0\)</span>, the level of the series does not change over time; if <span class="math inline">\(\alpha = 1\)</span>, the model reduces to a random walk model, <span class="math inline">\(y_t = \ell_{t-1} + \varvarepsilon_t = y_{t−1} + \varepsilon_t\)</span>. (See Section <a href="univariate-stationary-processes.html#stationarity">9.1</a> for a discussion of this model.)</p>
</div>
<div id="etsmnn-simple-exponential-smoothing-with-multiplicative-errors" class="section level3">
<h3><span class="header-section-number">8.4.2</span> ETS(M,N,N): simple exponential smoothing with multiplicative errors</h3>
<p>A multiplicative error is defined as:</p>
<p><span class="math display">\[
\varepsilon_t = \frac{y_{t} - \hat{y}_{t|t-1}}{\hat{y}_{t|t-1}}
\]</span>
where <span class="math inline">\(\varepsilon_t \sim N(0, \sigma^2)\)</span>.</p>
<p>From the above equaiton we know <span class="math inline">\(y_t = \ell_{t-1}(1 + \varepsilon_t)\)</span>, so that</p>
<p><span class="math display">\[
\begin{split}
\ell_t &amp;= \alpha y_t + (1 - \alpha) \ell_{t-1}  \\
       &amp;=  \alpha(1 + \varepsilon_t)\ell_{t-1} + (1-\alpha)\ell_{t-1} \\
       &amp;=\ell_{t-1} (1 + \alpha\varepsilon_t)
\end{split}
\]</span></p>
<p>Then we can write the multiplicative form of the state space model as</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= \ell_{t-1} (1 + \varepsilon_t)\\
l_t &amp;= \ell_{t-1}(1 + \alpha\varepsilon_t) 
\end{aligned}
\]</span></p>
</div>
<div id="etsaan-holts-linear-method-with-additive-errors" class="section level3">
<h3><span class="header-section-number">8.4.3</span> ETS(A,A,N): Holt’s linear method with additive errors</h3>
<p>Recall in Holt’s linear trend method, we have:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{y}_{t + h | t} &amp;= \ell_t + hb_t  \\
\ell_t &amp;= \alpha y_t + (1 - \alpha)(\ell_{t - 1} + b_{t - 1}) \\ 
b_t &amp;= \beta^*(\ell_t - \ell_{t - 1}) + (1 - \beta^*)b_{t-1} \\
\end{aligned}
\]</span></p>
<p>In the second equation, we have</p>
<p><span class="math display">\[
\begin{split}
\ell_t &amp;= \alpha (\ell_{t -1} + b_{t-1} + e_t) + (1 - \alpha)(\ell_{t - 1} + b_{t - 1}) \\
       &amp;= \ell_{t-1} + b_{t-1} + \alpha e_t
\end{split}
\]</span></p>
<p>and in the third (from <span class="math inline">\(\ell_t - \ell_{t-1} = b_{t-1} + \alpha e_t\)</span> we just derived)</p>
<p><span class="math display">\[
\begin{split}
b_t &amp;= \beta^*(b_{t-1} + \alpha e_t) + (1 - \beta^*)b_{t-1} \\
    &amp;= b_{t-1} + \alpha \beta^*e_t
\end{split}
\]</span></p>
<p>Finally, assuiming NID errors <span class="math inline">\(\varepsilon_t = e_t \sim (0, \sigma^2)\)</span> and let <span class="math inline">\(\beta = \alpha\beta^*\)</span>, we get</p>
<p><span class="math display">\[
\begin{aligned}
y_{t} &amp;= \ell_{t- 1} + b_{t-1} + \varepsilon_t \\
\ell_t &amp;= \ell_{t-1} + b_{t-1} + \alpha \varepsilon_t \\
b_t  &amp;= b_{t-1} + \beta \varepsilon_t
\end{aligned}
\]</span></p>
</div>
<div id="ets-man" class="section level3">
<h3><span class="header-section-number">8.4.4</span> ETS(M,A,N): Holt’s linear method with multiplicative errors</h3>
<p>Specifying one-step-ahead training errors as relative errors such that</p>
<p><span class="math display">\[
\varepsilon_t = \frac{y_t - (\ell_{t-1} + b_{t-1})}{(\ell_{t-1} + b_{t-1})}
\]</span></p>
<p>and that <span class="math inline">\(y_t = (1 + \varepsilon_t)(\ell_{t-1} + b_{t-1})\)</span>, so</p>
<p><span class="math display">\[
\begin{split}
\ell_t &amp;= \alpha(1 + \varepsilon_t)(\ell_{t-1} + b_{t-1}) + (1 - \alpha)(\ell_{t-1} + b_{t-1}) \\
    &amp;= (1 + \alpha \varepsilon_t) \ell_{t-1} + (1 + \alpha \varepsilon_t)b_{t-1} \\
    &amp;= (\ell_{t-1} + b_{t-1})(1 + \alpha \varepsilon_t)
\end{split}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{split}
b_t &amp;= \beta^*(\ell_t - \ell_{t-1}) + (1 - \beta^*)b_{t-1} \\
    &amp;= \beta^* \ell_t + b_{t-1} - \beta^* (\ell_{t-1} + b_{t-1}) \\
    &amp;= \beta^* (\ell_{t-1} + b_{t-1})(1 + \alpha \varepsilon_t) + b_{t-1} - \beta^* (\ell_{t-1} + b_{t-1}) \\
    &amp;= \alpha\beta^*(\ell_{t-1} + b_{t-1})\varepsilon_t + b_{t-1} \\
    &amp;= b_{t-1}  + \beta(\ell_{t-1} + b_{t-1})\varepsilon_t
\end{split}
\]</span></p>
<p>And our final state space model is:</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= (\ell_{t-1} + b_{t-1})(1 + \varepsilon_t) \\
\ell_t &amp;= (\ell_{t-1} + b_{t-1})(1 + \alpha \varepsilon_t)\\
b_t  &amp;=  b_{t-1}  + \beta(\ell_{t-1} + b_{t-1})\varepsilon_t
\end{aligned}
\]</span></p>
</div>
<div id="other-ets-models" class="section level3">
<h3><span class="header-section-number">8.4.5</span> Other ETS models</h3>
<p>In a similar fashion, we can write an innovations state space model for each of the exponential smoothing methods in the following table</p>
<p><img src="images/taxonomy.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="estimation-and-model-selection" class="section level2">
<h2><span class="header-section-number">8.5</span> Estimation and model selection</h2>
<div id="estimating-ets-models" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Estimating ETS models</h3>
<p>In Section <a href="exponential-smoothing.html#estimation">8.1.4</a> we use <code>opt_crit = "mse"</code> to estimate smoothing parameters and initial values. However, the default method is maximum likelihood estimation. In this section, we will estimate the smoothing parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\phi\)</span>, and the initial states <span class="math inline">\(\ell_0\)</span>, <span class="math inline">\(b_9\)</span>, <span class="math inline">\(s_0\)</span>,<span class="math inline">\(s_1\)</span>, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(s_{m-1}\)</span>, by maximising the likelihood.</p>
<p>The possible values that the smoothing parameters can take are restricted. Traditionally, the parameters have been constrained to lie between 0 and 1 so that the equations can be interpreted as weighted averages. That is, <span class="math inline">\(0 &lt;\alpha,\beta^*,\gamma^*,\phi &lt; 1\)</span>(<span style="color: red;">Why <span class="math inline">\(\gamma^*\)</span> instead of <span class="math inline">\(\gamma\)</span>?, <a href="exponential-smoothing.html#holt-winters-additive-method">8.2.6</a></span>). For the state space models, we have set <span class="math inline">\(\beta = \alpha \beta^∗\)</span> and <span class="math inline">\(\gamma = (1− \alpha)\gamma^*\)</span>. Therefore, the traditional restrictions translate to</p>
<p><span class="math display">\[
\begin{aligned}
1 \lt &amp;\alpha \lt 1 \\
0 \lt &amp;\beta \lt \alpha \\
0 \lt &amp;\gamma \lt 1- \alpha
\end{aligned}
\]</span></p>
<p>In practice, the damping parameter <span class="math inline">\(\phi\)</span> is usually constrained further to prevent numerical difficulties in estimating the model. In R, it is restricted so that <span class="math inline">\(0.8 &lt; \phi &lt; 0.98\)</span>.</p>
<p>Another way to view the parameters is through a consideration of the mathematical properties of the state space models. The parameters are constrained in order to prevent observations in the distant past having a continuing effect on current forecasts. From this standing points, restrictions are usually (but not always) looser. For example, for the ETS(A, N, N) model, the traditional parameter region is <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span> but the admissible region is <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span>. For the ETS(A, A, N) model, the traditional parameter region is <span class="math inline">\(0 &lt; \alpha &lt; 1\)</span> and <span class="math inline">\(0 &lt; \beta &lt;\alpha\)</span> but the admissible region is <span class="math inline">\(0 &lt; \alpha &lt;2\)</span> and <span class="math inline">\(0&lt; \beta &lt; 4−2\alpha\)</span>.</p>
</div>
<div id="model-selection-criteria" class="section level3">
<h3><span class="header-section-number">8.5.2</span> Model selection criteria</h3>
<p><span class="math inline">\(\text{AIC}\)</span>, <span class="math inline">\(\text{AIC}_c\)</span>and <span class="math inline">\(\text{BIC}\)</span>, introduced in Section <a href="time-series-regression-models.html#selecting-predictors">7.5</a>, can be used here to determine which of the ETS models is most appropriate for a given time series.</p>
<p>For ETS models, Akaike’s Information Criterion (AIC) is defined as</p>
<p><span class="math display">\[
\text{AIC} = -2\log{(L)} + 2k 
\]</span></p>
<p>where <span class="math inline">\(L\)</span> is the likelihood of the model and <span class="math inline">\(k\)</span> is the total number of parameters and initial states that have been estimated (including the residual variance).</p>
<p>The AIC corrected for small sample bias (<span class="math inline">\(\text{AIC}_c\)</span>) is defined as</p>
<p><span class="math display">\[
\text{AIC}_c = \text{AIC} + \frac{2k(k + 1)}{T  - k - 1}
\]</span></p>
<p>and the Bayesian Information Criterion (BIC) is</p>
<p><span class="math display">\[
\text{BIC} = \text{AIC} + k[\log{(T)} - 2]
\]</span></p>
<p>Three of the combinations of (Error, Trend, Seasonal) can lead to numerical difficulties. Specifically, the models that can cause such instabilities are multiplicative seasonality and additive error, ETS(A, N, M), ETS(A, A, M), and ETS(A, Ad, M), due to division by values potentially close to zero in the state equations. We normally do not consider these particular combinations when selecting a model.</p>
<p><strong>Models with multiplicative errors are useful when the data are strictly positive</strong>, but are not numerically stable when the data contain zeros or negative values. Therefore, multiplicative error models will not be considered if the time series is not strictly positive. In that case, only the six fully additive models will be applied.</p>
</div>
<div id="example-domestic-holiday-tourist-visitor-nights-in-australia" class="section level3">
<h3><span class="header-section-number">8.5.3</span> Example: Domestic holiday tourist visitor nights in Australia</h3>
<p>If not explicitly set <code>error()</code>, <code>trend()</code> or <code>season()</code>, <code>ETS()</code> use MLE to estimtate the corresponding parameters.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="exponential-smoothing.html#cb160-1"></a>aus_holidays &lt;-<span class="st"> </span>tourism <span class="op">%&gt;%</span></span>
<span id="cb160-2"><a href="exponential-smoothing.html#cb160-2"></a><span class="st">  </span><span class="kw">filter</span>(Purpose <span class="op">==</span><span class="st"> &quot;Holiday&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb160-3"><a href="exponential-smoothing.html#cb160-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Trips =</span> <span class="kw">sum</span>(Trips))  </span>
<span id="cb160-4"><a href="exponential-smoothing.html#cb160-4"></a></span>
<span id="cb160-5"><a href="exponential-smoothing.html#cb160-5"></a>holidays_fit &lt;-<span class="st"> </span>aus_holidays <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb160-6"><a href="exponential-smoothing.html#cb160-6"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Trips))</span>
<span id="cb160-7"><a href="exponential-smoothing.html#cb160-7"></a></span>
<span id="cb160-8"><a href="exponential-smoothing.html#cb160-8"></a>holidays_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb160-9"><a href="exponential-smoothing.html#cb160-9"></a><span class="co">#&gt; Series: Trips </span></span>
<span id="cb160-10"><a href="exponential-smoothing.html#cb160-10"></a><span class="co">#&gt; Model: ETS(M,N,M) </span></span>
<span id="cb160-11"><a href="exponential-smoothing.html#cb160-11"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb160-12"><a href="exponential-smoothing.html#cb160-12"></a><span class="co">#&gt;     alpha = 0.3578226 </span></span>
<span id="cb160-13"><a href="exponential-smoothing.html#cb160-13"></a><span class="co">#&gt;     gamma = 0.0009685565 </span></span>
<span id="cb160-14"><a href="exponential-smoothing.html#cb160-14"></a><span class="co">#&gt; </span></span>
<span id="cb160-15"><a href="exponential-smoothing.html#cb160-15"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb160-16"><a href="exponential-smoothing.html#cb160-16"></a><span class="co">#&gt;         l        s1        s2       s3       s4</span></span>
<span id="cb160-17"><a href="exponential-smoothing.html#cb160-17"></a><span class="co">#&gt;  9666.501 0.9430367 0.9268433 0.968352 1.161768</span></span>
<span id="cb160-18"><a href="exponential-smoothing.html#cb160-18"></a><span class="co">#&gt; </span></span>
<span id="cb160-19"><a href="exponential-smoothing.html#cb160-19"></a><span class="co">#&gt;   sigma^2:  0.0022</span></span>
<span id="cb160-20"><a href="exponential-smoothing.html#cb160-20"></a><span class="co">#&gt; </span></span>
<span id="cb160-21"><a href="exponential-smoothing.html#cb160-21"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb160-22"><a href="exponential-smoothing.html#cb160-22"></a><span class="co">#&gt; 1331.372 1332.928 1348.046</span></span></code></pre></div>
<p>The model selected is ETS(M, N, M) (<code>Trips</code> are strictly positive):</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= \ell_{t-1}s_{t-m}(1 + \varepsilon_t) \\
\ell_t &amp;= \ell_{t-1}(1 + \alpha \varepsilon_ t) \\
s_t &amp;= s_{t-1}(1 + \gamma \varepsilon_t)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="exponential-smoothing.html#cb161-1"></a>holidays_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb161-2"><a href="exponential-smoothing.html#cb161-2"></a><span class="st">  </span><span class="kw">components</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb161-3"><a href="exponential-smoothing.html#cb161-3"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Because this model has multiplicative errors, the residuals are not equivalent to the one-step training errors. The residuals are given by <span class="math inline">\(\hat{\varepsilon}_t\)</span>, while the one-step training errors are defined as <span class="math inline">\(y_t − \hat{y}_{t|t−1}\)</span>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="exponential-smoothing.html#cb162-1"></a><span class="kw">residuals</span>(holidays_fit) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb162-2"><a href="exponential-smoothing.html#cb162-2"></a><span class="st">  </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb162-3"><a href="exponential-smoothing.html#cb162-3"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Innovation errors&quot;</span>)</span>
<span id="cb162-4"><a href="exponential-smoothing.html#cb162-4"></a></span>
<span id="cb162-5"><a href="exponential-smoothing.html#cb162-5"></a><span class="kw">residuals</span>(holidays_fit, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb162-6"><a href="exponential-smoothing.html#cb162-6"></a><span class="st">  </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb162-7"><a href="exponential-smoothing.html#cb162-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Response errors&quot;</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-25-1.png" width="50%" style="display: block; margin: auto;" /><img src="ch8_files/figure-html/unnamed-chunk-25-2.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="forecasting-with-ets-models" class="section level2">
<h2><span class="header-section-number">8.6</span> Forecasting with ETS models</h2>
<p>For model ETS(M, A, N), we have <span class="math inline">\(y_{T+1} = (l_t + b_t)(1 + \varepsilon_t)\)</span>. Therefore <span class="math inline">\(\hat{y}_{T+1} = l_t + b_t\)</span>. Similarly (check Section <a href="exponential-smoothing.html#ets-man">8.4.4</a> for formula of <span class="math inline">\(\ell_{T+1}\)</span> and <span class="math inline">\(b_{T+1}\)</span>)</p>
<p><span class="math display">\[
\begin{split}
y_{T+2} &amp;= (\ell_{T + 1} + b_{T + 1})(1 + \varepsilon_{T+1}) \\
              &amp;= [(\ell_{T} + b_T)(1 + \alpha \varepsilon_t) + b_T  + \beta(\ell_T + b_T)\varepsilon_t] (1 + \varepsilon_{T+1})
\end{split}
\]</span></p>
<p>By setting <span class="math inline">\(\varepsilon_{T+1} = 0\)</span>, we get <span class="math inline">\(y_{T+2} =\ell_T + 2b_T\)</span>, which is the same to Holt’s linear methodin Section <a href="exponential-smoothing.html#holts-linear-trend-method">8.2.1</a>, where innovation state space model is not formally introduced. Thus, the point forecasts obtained from the method and from the two models that underlie the method are identical (assuming that the same parameter values are used).</p>
<p>ETS point forecasts are equal to the <strong>medians</strong> of the forecast distributions. For models with only additive components, the forecast distributions are normal, so the medians and means are equal. For ETS models with multiplicative errors, or with multiplicative seasonality, the point forecasts will not be equal to the means of the forecast distributions.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="exponential-smoothing.html#cb163-1"></a>holidays_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb163-2"><a href="exponential-smoothing.html#cb163-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">8</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb163-3"><a href="exponential-smoothing.html#cb163-3"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_holidays, <span class="dt">level =</span> <span class="dv">95</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="example-australia-gas-production" class="section level3">
<h3><span class="header-section-number">8.6.1</span> Example: Australia gas production</h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="exponential-smoothing.html#cb164-1"></a>gas_fit &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb164-2"><a href="exponential-smoothing.html#cb164-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Gas))</span>
<span id="cb164-3"><a href="exponential-smoothing.html#cb164-3"></a></span>
<span id="cb164-4"><a href="exponential-smoothing.html#cb164-4"></a>gas_fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()  </span>
<span id="cb164-5"><a href="exponential-smoothing.html#cb164-5"></a><span class="co">#&gt; Series: Gas </span></span>
<span id="cb164-6"><a href="exponential-smoothing.html#cb164-6"></a><span class="co">#&gt; Model: ETS(M,A,M) </span></span>
<span id="cb164-7"><a href="exponential-smoothing.html#cb164-7"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb164-8"><a href="exponential-smoothing.html#cb164-8"></a><span class="co">#&gt;     alpha = 0.6528545 </span></span>
<span id="cb164-9"><a href="exponential-smoothing.html#cb164-9"></a><span class="co">#&gt;     beta  = 0.1441675 </span></span>
<span id="cb164-10"><a href="exponential-smoothing.html#cb164-10"></a><span class="co">#&gt;     gamma = 0.09784922 </span></span>
<span id="cb164-11"><a href="exponential-smoothing.html#cb164-11"></a><span class="co">#&gt; </span></span>
<span id="cb164-12"><a href="exponential-smoothing.html#cb164-12"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb164-13"><a href="exponential-smoothing.html#cb164-13"></a><span class="co">#&gt;         l          b        s1       s2       s3        s4</span></span>
<span id="cb164-14"><a href="exponential-smoothing.html#cb164-14"></a><span class="co">#&gt;  5.945592 0.07062881 0.9309236 1.177883 1.074851 0.8163427</span></span>
<span id="cb164-15"><a href="exponential-smoothing.html#cb164-15"></a><span class="co">#&gt; </span></span>
<span id="cb164-16"><a href="exponential-smoothing.html#cb164-16"></a><span class="co">#&gt;   sigma^2:  0.0032</span></span>
<span id="cb164-17"><a href="exponential-smoothing.html#cb164-17"></a><span class="co">#&gt; </span></span>
<span id="cb164-18"><a href="exponential-smoothing.html#cb164-18"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb164-19"><a href="exponential-smoothing.html#cb164-19"></a><span class="co">#&gt; 1680.929 1681.794 1711.389</span></span></code></pre></div>
<p>Why is multiplicative seasonality necessary here?</p>
<p>A model ETS(M, A, M)</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="exponential-smoothing.html#cb165-1"></a>gas_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb165-2"><a href="exponential-smoothing.html#cb165-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="st">&quot;5 years&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb165-3"><a href="exponential-smoothing.html#cb165-3"></a><span class="st">  </span><span class="kw">autoplot</span>(aus_production, <span class="dt">level =</span> <span class="dv">95</span>)</span></code></pre></div>
<p><img src="ch8_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Experiment with making the trend damped, not improving <span class="math inline">\(\text{AIC}_c\)</span></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="exponential-smoothing.html#cb166-1"></a>gas_fit_damped &lt;-<span class="st"> </span>aus_production <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb166-2"><a href="exponential-smoothing.html#cb166-2"></a><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Gas <span class="op">~</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>)))</span>
<span id="cb166-3"><a href="exponential-smoothing.html#cb166-3"></a></span>
<span id="cb166-4"><a href="exponential-smoothing.html#cb166-4"></a>gas_fit_damped <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">report</span>()</span>
<span id="cb166-5"><a href="exponential-smoothing.html#cb166-5"></a><span class="co">#&gt; Series: Gas </span></span>
<span id="cb166-6"><a href="exponential-smoothing.html#cb166-6"></a><span class="co">#&gt; Model: ETS(M,Ad,M) </span></span>
<span id="cb166-7"><a href="exponential-smoothing.html#cb166-7"></a><span class="co">#&gt;   Smoothing parameters:</span></span>
<span id="cb166-8"><a href="exponential-smoothing.html#cb166-8"></a><span class="co">#&gt;     alpha = 0.6489044 </span></span>
<span id="cb166-9"><a href="exponential-smoothing.html#cb166-9"></a><span class="co">#&gt;     beta  = 0.1551275 </span></span>
<span id="cb166-10"><a href="exponential-smoothing.html#cb166-10"></a><span class="co">#&gt;     gamma = 0.09369372 </span></span>
<span id="cb166-11"><a href="exponential-smoothing.html#cb166-11"></a><span class="co">#&gt;     phi   = 0.98 </span></span>
<span id="cb166-12"><a href="exponential-smoothing.html#cb166-12"></a><span class="co">#&gt; </span></span>
<span id="cb166-13"><a href="exponential-smoothing.html#cb166-13"></a><span class="co">#&gt;   Initial states:</span></span>
<span id="cb166-14"><a href="exponential-smoothing.html#cb166-14"></a><span class="co">#&gt;         l          b        s1       s2      s3        s4</span></span>
<span id="cb166-15"><a href="exponential-smoothing.html#cb166-15"></a><span class="co">#&gt;  5.858941 0.09944006 0.9281912 1.177903 1.07678 0.8171255</span></span>
<span id="cb166-16"><a href="exponential-smoothing.html#cb166-16"></a><span class="co">#&gt; </span></span>
<span id="cb166-17"><a href="exponential-smoothing.html#cb166-17"></a><span class="co">#&gt;   sigma^2:  0.0033</span></span>
<span id="cb166-18"><a href="exponential-smoothing.html#cb166-18"></a><span class="co">#&gt; </span></span>
<span id="cb166-19"><a href="exponential-smoothing.html#cb166-19"></a><span class="co">#&gt;      AIC     AICc      BIC </span></span>
<span id="cb166-20"><a href="exponential-smoothing.html#cb166-20"></a><span class="co">#&gt; 1684.028 1685.091 1717.873</span></span></code></pre></div>
</div>
<div id="prediction-intervals" class="section level3">
<h3><span class="header-section-number">8.6.2</span> Prediction intervals</h3>
<p>Since <span class="math inline">\(y_{T + h| T} = \hat{y}_{T+h|h} + \varepsilon_{T+h}\)</span>, and h-step residuals are assumed to be normally distributed and have standard deviation <span class="math inline">\(\hat{\sigma}_h\)</span>, mean 0, we have</p>
<p><span class="math display">\[
y_{T + h| T} \sim N(\hat{y}_{T+h|h},\hat{\sigma}_h^2)
\]</span>
(For the purpose of reviewing, in section <a href="the-forecasters-toolbox.html#predict-interval">5.5</a> we conclude that when forecasting is one step ahead, the standard deviation of the forecast distribution is almost the same as the standard deviation of the residuals. And for multi-step forecast, <span class="math inline">\(\sigma_h\)</span> usually increases with <span class="math inline">\(h\)</span>, and some more complex estimate methods may be required).</p>
<p>For most ETS models, a prediction interval can be written as:</p>
<p><span class="math display">\[
\hat{y}_{T+h|h} \pm c\hat{\sigma}_h
\]</span></p>
<p>where <span class="math inline">\(c\)</span> depends on the coverage probability. For ETS models, formulas for <span class="math inline">\(\sigma_h\)</span> can be complicated; the details are given in Chapter 6 of <a href="https://robjhyndman.com/expsmooth/" class="uri">https://robjhyndman.com/expsmooth/</a>. In the following table we give the formulas for the additive ETS models, which are the simplest.</p>
<p><img src="images/ets_forecast_variance.png" width="100%" style="display: block; margin: auto;" /></p>
<center>
Forecast variance expressions for each additive state space model, where <span class="math inline">\(\sigma_h^2\)</span> is the residual variance of a h-step forecast, <span class="math inline">\(m\)</span> is the seasonal period, and <span class="math inline">\(k\)</span> is the integer part of <span class="math inline">\((h−1)/m\)</span> (i.e., the number of complete years in the forecast period prior to time <span class="math inline">\(T+h\)</span>)
</center>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><span class="math inline">\(\ell\)</span> is just styled <span class="math inline">\(l\)</span>, <code>\ell</code> in latex<a href="exponential-smoothing.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series-regression-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="univariate-stationary-processes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/fpp/edit/master/ch8.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
